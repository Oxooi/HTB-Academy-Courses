
<h1>OpenVAS Scan</h1>
<hr/>
<p>The OpenVAS Greenbone Security Assistant application has various tabs that you can interact with. For this section, we will be digging into the scans. If you navigate to the <code>Scans</code> tab shown below, you will see the scans that have run in the past. You will also be able to see how to create a new task to run a scan. The tasks work off of the scanning configurations that the user sets up.</p>
<div class="card bg-light">
<div class="card-body">
<p class="mb-0"><b>Note:</b> The scans shown in this section have already been pre-run to save you the time of waiting for them to finish. If you re-run the scan, it's best to go through vulnerabilities as they come, instead of waiting for the scan to finish, as they can take 1-2 hours to finish.</p>
</div>
</div>
<p><img alt="Greenbone Security Assistant dashboard showing tasks by severity and status. Four tasks listed: Linux_basic, Linux_basic_authed, Windows_basic, Windows_basic_authed, all with high severity." src="https://academy.hackthebox.com/storage/modules/108/openvas/creatingscan1.png"/></p>
<div class="card bg-light">
<div class="card-body">
<p class="mb-0"><b>Note:</b> For this module, the Windows target will be <code>172.16.16.100</code> and the Linux target will be <code>172.16.16.160</code>.</p>
</div>
</div>
<p><img alt="Greenbone Security Assistant showing 7 scan configurations, including Base, Discovery, and Log4Shell, with details on NVTs and trends." src="https://academy.hackthebox.com/storage/modules/108/openvas/scanconfigs.png"/></p>
<hr/>
<h2>Configuration</h2>
<p>Before setting up any scans, it is best to configure the targets for the scan. If you navigate to the <code>Configurations</code> tab and select <code>Targets</code>, you will see targets that have been already added to the application.</p>
<p><img alt="Greenbone Security Assistant dashboard showing 4 tasks by severity and status. All tasks are high severity, with Windows_basic_authed having the most high results." src="https://academy.hackthebox.com/storage/modules/108/openvas/targets.png"/></p>
<p>To add your own, click the icon highlighted below and add an individual target or a host list. You also can configure other options such as the ports, authentication, and methods of identifying if the host is reachable. For the <code>Alive Test</code>, the <code>Scan Config Default</code> option from OpenVAS leverages the <code>NVT Ping Host</code> in the <code>NVT Family</code>. You can learn about the NVT Family <a href="https://docs.greenbone.net/GSM-Manual/gos-22.04/en/scanning.html#creating-a-target">here</a>.</p>
<p><img alt="Greenbone Security Assistant interface showing 'New Target' configuration with fields for name, hosts, and port list. Options to add or exclude hosts manually or from file." src="https://academy.hackthebox.com/storage/modules/108/openvas/addingtarget.png"/></p>
<p>Typically, an <code>authenticated scan</code> leverages a high privileged user such as <code>root</code> or <code>Administrator</code>. Depending on the permission level for the user, if it's the highest permission level, you'll retrieve the maximum amount of information back from the host in regards to the vulnerabilities present since you would have full access.</p>
<div class="card bg-light">
<div class="card-body">
<p class="mb-0"><b>Note:</b> To run a credentialed scan on the target, use the following credentials: <code>htb-student_adm</code>:<code>HTB_@cademy_student!</code> for Linux, and <code>administrator</code>:<code>Academy_VA_adm1!</code> for Windows. These scans have already been set up in the OpenVAS target to save you time.</p>
</div>
</div>
<p>Once you have added your target, they will appear in the list below:
<img alt="Greenbone Security Assistant showing 4 targets: Linux_authed, Linux_unauth, Windows_authed, Windows_unauth, each with host IPs and port list." src="https://academy.hackthebox.com/storage/modules/108/openvas/targetsview.png"/></p>
<hr/>
<h2>Setting Up a Scan</h2>
<p>Multiple scan configurations leverage OpenVAS Network Vulnerability Test (NVT) Families, which consist of many different categories of vulnerabilities, such as ones for Windows, Linux, Web Applications, etc. You can see a few different types of families shown below:
<img alt="Greenbone Security Assistant dashboard showing 96,250 NVTs by severity, creation time, and family. Lists vulnerabilities like Discourse and Mageia with CVE details and severity ratings." src="https://academy.hackthebox.com/storage/modules/108/openvas/nvt2.png"/></p>
<p>OpenVAS has various scan configurations to choose from for scanning a network. We recommend only leveraging the ones below, as other options could cause system disruptions on a network:</p>
<ul>
<li>
<p><code>Base</code>: This scan configuration is meant to enumerate information about the host's status and operating system information. This scan configuration does not check for vulnerabilities.</p>
</li>
<li>
<p><code>Discovery</code>: This scan configuration is meant to enumerate information about the system. The configuration identifies the host's services, hardware, accessible ports, and software being used on the system. This scan configuration also does not check for vulnerabilities.</p>
</li>
<li>
<p><code>Host Discovery</code>: This scan configuration solely tests whether the host is alive and determines what devices are <code>active</code> on the network. This scan configuration does not check for vulnerabilities as well. <em>OpenVAS leverages ping to identify if the host is alive.</em></p>
</li>
<li>
<p><code>System Discovery</code>: This scan enumerates the target host further than the 'Discovery Scan' and attempts to identify the operating system and hardware associated with the host.</p>
</li>
<li>
<p><code>Full and fast</code>: This configuration is recommended by OpenVAS as the safest option and leverages intelligence to use the best NVT checks for the host(s) based on the accessible ports.</p>
</li>
</ul>
<p>You can create your own scan by navigating to the 'Scans' tab and clicking the wizard icon.
<img alt="Greenbone Security Assistant dashboard showing 4 tasks by severity and status. All tasks are high severity, with Windows_basic_authed having the most high results." src="https://academy.hackthebox.com/storage/modules/108/openvas/creatingscan2.png"/></p>
<p>Once you click the wizard icon, the panel shown below will pop up and allow you to configure your scan.</p>
<p><img alt="Greenbone Security Assistant 'New Task' form with fields for name, comment, scan targets, and schedule. Options for alerts, asset results, and auto-delete reports." src="https://academy.hackthebox.com/storage/modules/108/openvas/Newscan.png"/></p>
<p>We will configure the scan with the options below, which targets <code>172.16.16.160</code> and then run our scan, which can take <code>30-60 minutes</code> to finish.</p>
<p><img alt="Greenbone Security Assistant 'New Task' form with fields for name, comment, scan targets, and schedule. Options for alerts, asset results, and auto-delete reports." src="https://academy.hackthebox.com/storage/modules/108/openvas/linux_basic.png"/></p>
<p><img alt="Target: Linux_unauth. Hosts include 172.16.16.160, max 1 host, simultaneous scanning allowed. Tasks: Linux_Host_Discovery, Linux_basic." src="https://academy.hackthebox.com/storage/modules/108/openvas/linux_unauthedtarget.png"/></p>
