
<h1>Online PIN Brute-Forcing Overview</h1>
<hr/>
<p>One of the ways that we can attempt to retrieve the correct WPS pin for a target network is through online PIN brute-forcing. This can be conducted with a few different tools, but popularly it is done with either Reaver or Bully.</p>
<p><img alt="image" src="https://academy.hackthebox.com/storage/modules/186/BruteForcing/Online/WPS_BRUTE.png"/></p>
<p>Online brute-forcing works by trying all possible digit combinations and sending them to the access point for verification. By doing this, we go through the series of EAP messages for each possible PIN. In the M4 message, the client sends the access point the R-Hash1 and R-Hash2 values, along with the R-S1 nonce values encrypted with AES. During this message, the access point computes the received R-Hash1 and R-Hash2 values to verify if the PIN we sent is correct. If it is, the remaining messages are exchanged. If it is not, we receive a NACK.</p>
<p>In online brute-forcing attacks, we already know some values and generate others. These are as follows:</p>
<ul>
<li>We know the PKe and generate the PKr ourselves. This allows us to generate the proper response for the R-Hash1 and R-Hash2 values.</li>
<li>We generate the R-S1 and R-S2 nonce values ourselves.</li>
<li>We receive the E-Hash1 and E-Hash2 values from the access point during the M3 message.</li>
</ul>
<p>However, during these attacks we do not know:</p>
<ul>
<li>The true PIN (PSK1 and PSK2 values). We guess this through the 11,000 combinations.</li>
<li>The E-S1 and E-S2 nonce values. We receive these from the access point in the M5 and M7 message. Of course, only if we guess the PIN correctly.</li>
<li>The WPA-PSK. This is the resulting success during the M7 message upon guessing the correct PIN.</li>
</ul>
<p>Due to us not knowing either of the 128-bit E-S1 and E-S2 nonce values, and the fact that they are random, we are left guessing the PIN. However, these are not always randomly generated. Depending on the vendor, we might be able to employ the usage of an offline pixie dust attack to retrieve the WPA-PSK.</p>
