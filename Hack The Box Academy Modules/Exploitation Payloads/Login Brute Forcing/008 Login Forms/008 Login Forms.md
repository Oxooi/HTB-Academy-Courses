
<h1>Login Forms</h1>
<p>Beyond the realm of Basic HTTP Authentication, many web applications employ custom login forms as their primary authentication mechanism. These forms, while visually diverse, often share common underlying mechanics that make them targets for brute forcing.</p>
<h2>Understanding Login Forms</h2>
<p>While login forms may appear as simple boxes soliciting your username and password, they represent a complex interplay of client-side and server-side technologies. At their core, login forms are essentially HTML forms embedded within a webpage. These forms typically include input fields (<code>&lt;input&gt;</code>) for capturing the username and password, along with a submit button (<code>&lt;button&gt;</code> or <code>&lt;input type="submit"&gt;</code>) to initiate the authentication process.</p>
<h2>A Basic Login Form Example</h2>
<p>Most login forms follow a similar structure. Here's an example:</p>
<pre><code class="language-html">&lt;form action="/login" method="post"&gt;
  &lt;label for="username"&gt;Username:&lt;/label&gt;
  &lt;input type="text" id="username" name="username"&gt;&lt;br&gt;&lt;br&gt;
  &lt;label for="password"&gt;Password:&lt;/label&gt;
  &lt;input type="password" id="password" name="password"&gt;&lt;br&gt;&lt;br&gt;
  &lt;input type="submit" value="Submit"&gt;
&lt;/form&gt;
</code></pre>
<p>This form, when submitted, sends a POST request to the <code>/login</code> endpoint on the server, including the entered username and password as form data.</p>
<pre><code class="language-http">POST /login HTTP/1.1
Host: www.example.com
Content-Type: application/x-www-form-urlencoded
Content-Length: 29

username=john&amp;password=secret123
</code></pre>
<ul>
<li>The <code>POST</code> method indicates that data is being sent to the server to create or update a resource.</li>
<li>
<code>/login</code> is the URL endpoint handling the login request.</li>
<li>The <code>Content-Type</code> header specifies how the data is encoded in the request body.</li>
<li>The <code>Content-Length</code> header indicates the size of the data being sent.</li>
<li>The request body contains the username and password, encoded as key-value pairs.</li>
</ul>
<p>When a user interacts with a login form, their browser handles the initial processing. The browser captures the entered credentials, often employing JavaScript for client-side validation or input sanitization. Upon submission, the browser constructs an HTTP POST request. This request encapsulates the form data—including the username and password—within its body, often encoded as <code>application/x-www-form-urlencoded</code> or <code>multipart/form-data</code>.</p>
<h2>http-post-form</h2>
<div class="card bg-light">
<div class="card-body">
<p class="mb-0"><b>To follow along, start the target system via the question section at the bottom of the page.</b></p>
</div>
</div>
<p>Hydra's <code>http-post-form</code> service is specifically designed to target login forms. It enables the automation of POST requests, dynamically inserting username and password combinations into the request body. By leveraging Hydra's capabilities, attackers can efficiently test numerous credential combinations against a login form, potentially uncovering valid logins.</p>
<p>The general structure of a Hydra command using <code>http-post-form</code> looks like this:</p>
<pre><code class="language-shell-session">[!bash!]$ hydra [options] target http-post-form "path:params:condition_string"
</code></pre>
<h3>Understanding the Condition String</h3>
<p>In Hydra’s <code>http-post-form</code> module, success and failure conditions are crucial for properly identifying valid and invalid login attempts. Hydra primarily relies on failure conditions (<code>F=...</code>) to determine when a login attempt has failed, but you can also specify a success condition (<code>S=...</code>) to indicate when a login is successful.</p>
<p>The failure condition (<code>F=...</code>) is used to check for a specific string in the server's response that signals a failed login attempt. This is the most common approach because many websites return an error message (like "Invalid username or password") when the login fails. For example, if a login form returns the message "Invalid credentials" on a failed attempt, you can configure Hydra like this:</p>
<pre><code class="language-bash">hydra ... http-post-form "/login:user=^USER^&amp;pass=^PASS^:F=Invalid credentials"
</code></pre>
<p>In this case, Hydra will check each response for the string "Invalid credentials." If it finds this phrase, it will mark the login attempt as a failure and move on to the next username/password pair. This approach is commonly used because failure messages are usually easy to identify.</p>
<p>However, sometimes you may not have a clear failure message but instead have a distinct success condition. For instance, if the application redirects the user after a successful login (using HTTP status code <code>302</code>), or displays specific content (like "Dashboard" or "Welcome"), you can configure Hydra to look for that success condition using <code>S=</code>. Here’s an example where a successful login results in a 302 redirect:</p>
<pre><code class="language-bash">hydra ... http-post-form "/login:user=^USER^&amp;pass=^PASS^:S=302"
</code></pre>
<p>In this case, Hydra will treat any response that returns an HTTP 302 status code as a successful login. Similarly, if a successful login results in content like "Dashboard" appearing on the page, you can configure Hydra to look for that keyword as a success condition:</p>
<pre><code class="language-bash">hydra ... http-post-form "/login:user=^USER^&amp;pass=^PASS^:S=Dashboard"
</code></pre>
<p>Hydra will now register the login as successful if it finds the word "Dashboard" in the server’s response.</p>
<p>Before unleashing Hydra on a login form, it's essential to gather intelligence on its inner workings. This involves pinpointing the exact parameters the form uses to transmit the username and password to the server.</p>
<h3>Manual Inspection</h3>
<p>Upon accessing the <code>IP:PORT</code> in your browser, a basic login form is presented. Using your browser's developer tools (typically by right-clicking and selecting "Inspect" or a similar option), you can view the underlying HTML code for this form. Let's break down its key components:</p>
<pre><code class="language-html">&lt;form method="POST"&gt;
    &lt;h2&gt;Login&lt;/h2&gt;
    &lt;label for="username"&gt;Username:&lt;/label&gt;
    &lt;input type="text" id="username" name="username"&gt;
    &lt;label for="password"&gt;Password:&lt;/label&gt;
    &lt;input type="password" id="password" name="password"&gt;
    &lt;input type="submit" value="Login"&gt;
&lt;/form&gt;
</code></pre>
<p>The HTML reveals a simple login form. Key points for Hydra:</p>
<ul>
<li>
<code>Method</code>: <code>POST</code> - Hydra will need to send POST requests to the server.</li>
<li>Fields:
<ul>
<li>
<code>Username</code>: The input field named <code>username</code> will be targeted.</li>
<li>
<code>Password</code>: The input field named <code>password</code> will be targeted.</li>
</ul>
</li>
</ul>
<p>With these details, you can construct the Hydra command to automate the brute-force attack against this login form.</p>
<h3>Browser Developer Tools</h3>
<p>After inspecting the form, open your browser's Developer Tools (F12) and navigate to the "Network" tab. Submit a sample login attempt with any credentials. This will allow you to see the POST request sent to the server. In the "Network" tab, find the request corresponding to the form submission and check the form data, headers, and the server’s response.</p>
<p><img alt="Login form with invalid credentials error and network panel showing HTTP POST request details." src="https://academy.hackthebox.com/storage/modules/57/devtools.png"/></p>
<p>This information further solidifies the information we will need for Hydra. We now have definitive confirmation of both the target path (<code>/</code>) and the parameter names (<code>username</code> and <code>password</code>).</p>
<h3>Proxy Interception</h3>
<p>For more complex scenarios, intercepting the network traffic with a proxy tool like Burp Suite or OWASP ZAP can be invaluable. Configure your browser to route its traffic through the proxy, then interact with the login form. The proxy will capture the POST request, allowing you to dissect its every component, including the precise login parameters and their values.</p>
<h2>Constructing the params String for Hydra</h2>
<p>After analyzing the login form's structure and behavior, it's time to build the <code>params</code> string, a critical component of Hydra's <code>http-post-form</code> attack module. This string encapsulates the data that will be sent to the server with each login attempt, mimicking a legitimate form submission.</p>
<p>The <code>params</code> string consists of key-value pairs, similar to how data is encoded in a POST request. Each pair represents a field in the login form, with its corresponding value.</p>
<ul>
<li>
<code>Form Parameters</code>: These are the essential fields that hold the username and password. Hydra will dynamically replace placeholders (<code>^USER^</code> and <code>^PASS^</code>) within these parameters with values from your wordlists.</li>
<li>
<code>Additional Fields</code>: If the form includes other hidden fields or tokens (e.g., CSRF tokens), they must also be included in the <code>params</code> string. These can have static values or dynamic placeholders if their values change with each request.</li>
<li>
<code>Success Condition</code>: This defines the criteria Hydra will use to identify a successful login. It can be an HTTP status code (like <code>S=302</code> for a redirect) or the presence or absence of specific text in the server's response (e.g., <code>F=Invalid credentials</code> or <code>S=Welcome</code>).</li>
</ul>
<p>Let's apply this to our scenario. We've discovered:</p>
<ul>
<li>The form submits data to the root path (<code>/</code>).</li>
<li>The username field is named <code>username</code>.</li>
<li>The password field is named <code>password</code>.</li>
<li>An error message "Invalid credentials" is displayed upon failed login.</li>
</ul>
<p>Therefore, our <code>params</code> string would be:</p>
<pre><code class="language-bash">/:username=^USER^&amp;password=^PASS^:F=Invalid credentials
</code></pre>
<ul>
<li>
<code>"/"</code>: The path where the form is submitted.</li>
<li>
<code>username=^USER^&amp;password=^PASS^</code>: The form parameters with placeholders for Hydra.</li>
<li>
<code>F=Invalid credentials</code>: The failure condition – Hydra will consider a login attempt unsuccessful if it sees this string in the response.</li>
</ul>
<p>We will be using <a href="https://github.com/danielmiessler/SecLists/blob/master/Usernames/top-usernames-shortlist.txt">top-usernames-shortlist.txt</a> for the username list, and <a href="https://raw.githubusercontent.com/danielmiessler/SecLists/refs/heads/master/Passwords/Common-Credentials/2023-200_most_used_passwords.txt">2023-200_most_used_passwords.txt</a> for the password list.</p>
<p>This <code>params</code> string is incorporated into the Hydra command as follows. Hydra will systematically substitute <code>^USER^</code> and <code>^PASS^</code> with values from your wordlists, sending POST requests to the target and analyzing the responses for the specified failure condition. If a login attempt doesn't trigger the "Invalid credentials" message, Hydra will flag it as a potential success, revealing the valid credentials.</p>
<pre><code class="language-shell-session"># Download wordlists if needed
[!bash!]$ curl -s -O https://raw.githubusercontent.com/danielmiessler/SecLists/master/Usernames/top-usernames-shortlist.txt
[!bash!]$ curl -s -O https://raw.githubusercontent.com/danielmiessler/SecLists/refs/heads/master/Passwords/Common-Credentials/2023-200_most_used_passwords.txt
# Hydra command
[!bash!]$ hydra -L top-usernames-shortlist.txt -P 2023-200_most_used_passwords.txt -f IP -s 5000 http-post-form "/:username=^USER^&amp;password=^PASS^:F=Invalid credentials"

Hydra v9.5 (c) 2023 by van Hauser/THC &amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2024-09-05 12:51:14
[DATA] max 16 tasks per 1 server, overall 16 tasks, 3400 login tries (l:17/p:200), ~213 tries per task
[DATA] attacking http-post-form://IP:PORT/:username=^USER^&amp;password=^PASS^:F=Invalid credentials
[5000][http-post-form] host: IP   login: ...   password: ...
[STATUS] attack finished for IP (valid pair found)
1 of 1 target successfully completed, 1 valid password found
Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2024-09-05 12:51:28
</code></pre>
<p>Remember that crafting the correct <code>params</code> string is crucial for a successful Hydra attack. Accurate information about the form's structure and behavior is essential for constructing this string effectively. Once Hydra has completed the attack, log into the website using the found credentials, and retrieve the flag.</p>
<div class="mb-5 pwnbox-select-card"></div>
<div id="screen" style="height: 600px; border: 1px solid;">
<div class="screenPlaceholder">
<div class="instanceLoading" style="display: none;">
<h1 class="text-center" style="margin-top: 270px;"><i class="fa fa-circle-notch fa-spin"></i>
</h1>
<div class="text-center">Instance is starting...</div>
</div>
<div class="instanceTerminating" style="display: none;">
<h1 class="text-center" style="margin-top: 270px;"><i class="fa fa-circle-notch fa-spin"></i>
</h1>
<div class="text-center">Terminating instance...</div>
</div>
<div class="row instanceStart max-width-canvas">
<div class="col-4"></div>
<div class="col-4">
<button class="startInstanceBtn btn btn-success text-light btn-lg btn-block" style="margin-top: 270px;">Start Instance
                            </button>
<p class="text-center mt-2 font-size-13 font-secondary">
<span class="text-success spawnsLeft">
<i class="fal fa-infinity"></i>
</span> / 1 spawns left
                            </p>
</div>
<div class="col-4"></div>
</div>
</div>
</div>
<div class="row align-center justify-center my-4">
<div class="col-5 justify-start">
<button class="instance-button fullScreenBtn btn btn-light btn-sm float-left" style="display:none;" target="_blank"><i class="fad fa-expand text-success mr-1"></i>  Full Screen
                    </button>
<button class="instance-button terminateInstanceBtn btn btn-light btn-sm ml-2" style="display:none;"><i class="fad fa-times text-danger"></i>  Terminate
                    </button>
<button class="instance-button resetInstanceBtn btn btn-light btn-sm ml-1" style="display:none;"><i class="fad fa-sync text-warning mr-2"></i>  Reset
                    </button>
<div class="btn-group" role="group">
<button class="instance-button extendInstanceBtn btn btn-light btn-sm ml-1" style="display:none;cursor: default;">Life Left:
                            <span class="lifeLeft"></span>m
                        </button>
<button class="extendInstanceBtn extendInstanceBtnClicker btn btn-light btn-sm" data-title="Extend Life" data-toggle="tooltip" style="display:none;"><i class="fa fa-plus text-success"></i></button>
</div>
</div>
<div class="col-7 justify-end pt-2 pr-2 font-size-small text-right" id="statusText">Waiting to
                    start...
                </div>
</div>
<div class="d-inline-block mb-2 solutionSettings solutionSettingsOffsets" id="solutionsModuleSetting">
<div class="border border-secondary p-2 rounded">
<div class="custom-control custom-switch d-flex">
<input class="custom-control-input" disabled="" id="showSolutionsModuleSetting" type="checkbox"/>
<label class="custom-control-label font-size-14 font-weight-normal text-white" for="showSolutionsModuleSetting">
                                Enable step-by-step solutions for all questions
                            </label>
<span aria-hidden="true" class="cursor-pointer font-size-14 ml-1 mr-1 text-white" data-content="Access to this feature is exclusive to annual subscribers. To acquire an annual subscription, kindly proceed by clicking &lt;a href='/billing'&gt;here&lt;/a&gt;." data-html="true" data-placement="top" data-toggle="popover" data-trigger="click" title="Activate Solutions">
<i class="fa fa-info-circle font-size-12"></i>
</span>
<img alt="sparkles-icon-decoration" class="ml-2 w-auto sparkles-icon" height="20" src="/images/sparkles-solid.svg">
</img></div>
</div>
</div>
<div class="card" id="questionsDiv">
<div class="card-body">
<div class="row">
<div class="col-9">
<h4 class="card-title mt-0 font-size-medium">Questions</h4>
<p class="card-title-desc font-size-large font-size-15">Answer the question(s) below
                                to complete this Section and earn cubes!</p>
<span class="spawnTargetBtn spawn-target-text-clone d-none">Click here to spawn the target
                                system!</span>
<p class="card-title-desc font-size-large font-size-15 mb-0">
    Target(s): <span class="text-success">
<span class="target" style="cursor:pointer;">
<i class="fad fa-circle-notch fa-spin"></i>
<span class="spawnTargetBtn">Fetching status...</span>
</span>
</span>
<button class="resetTargetBtn btn btn-light btn-sm" data-title="Reset Target(s)" data-toggle="tooltip" style="cursor: pointer; display: none;">
<i class="fad fa-sync text-warning"></i>
</button>
<br/>
<div class="d-flex align-items-center targetLifeContainer">
<span class="targetLifeTimeContainer" style="display: none;">
            Life Left: <span class="targetLifeTime font-size-15">0</span> minute(s)
                    </span>
</div>
</p>
</div>
<div class="col-3 text-right float-right">
<button class="btn btn-light bg-color-blue-nav mt-2 w-100 d-flex align-items-center" data-target="#cheatSheetModal" data-toggle="modal">
<div><i class="fad fa-file-alt mr-2"></i></div>
<div class="text-center w-100 ml-1">Cheat Sheet</div>
</button>
</div>
</div>
<div>
<div>
<label class="module-question" for="2673"><span class="badge badge-soft-dark font-size-14 mr-2">+ 2 <i class="fad fa-cube text-success"></i></span> After successfully brute-forcing, and then logging into the target, what is the full flag you find?
                            </label>
<div class="row">
<div class="col-lg-12 mb-4">
<input class="form-control bg-color-blue-nav" color="green" id="answer2673" maxlength="191" placeholder="Submit your answer here..." type="text"/>
</div>
<div class="d-flex justify-content-end w-100 mr-3">
<p class="mb-0 mr-3 mt-1 font-size-14 font-medium text-white" id="questionStreakPointsText-2673">
                                        +10 Streak pts</p>
<div class="mb-4 mr-1 d-flex align-items-center">
<button class="btn btn-primary btn-block btnAnswer" data-question-id="2673" id="btnAnswer2673">
<div class="submit-button-text">
<i class="fad fa-flag-checkered mr-2"></i> Submit
                                            </div>
<div class="submit-button-loader mx-4 d-none">
<i class="fa fa-circle-notch fa-spin"></i>
</div>
</button>
</div>
</div>
</div>
<div class="">
</div>
</div>
</div>
</div>
</div>
