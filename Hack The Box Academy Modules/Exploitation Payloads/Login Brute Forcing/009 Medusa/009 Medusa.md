
<h1>Medusa</h1>
<hr/>
<p>Medusa, a prominent tool in the cybersecurity arsenal, is designed to be a fast, massively parallel, and modular login brute-forcer. Its primary objective is to support a wide array of services that allow remote authentication, enabling penetration testers and security professionals to assess the resilience of login systems against brute-force attacks.</p>
<h2>Installation</h2>
<p>Medusa often comes pre-installed on popular penetration testing distributions. You can verify its presence by running:</p>
<pre><code class="language-shell-session">[!bash!]$ medusa -h
</code></pre>
<p>Installing Medusa on a Linux system is straightforward.</p>
<pre><code class="language-shell-session">[!bash!]$ sudo apt-get -y update
[!bash!]$ sudo apt-get -y install medusa
</code></pre>
<h2>Command Syntax and Parameter Table</h2>
<p>Medusa's command-line interface is straightforward. It allows users to specify hosts, users, passwords, and modules with various options to fine-tune the attack process.</p>
<pre><code class="language-shell-session"> [!bash!]$ medusa [target_options] [credential_options] -M module [module_options]
</code></pre>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Explanation</th>
<th>Usage Example</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>-h HOST</code> or <code>-H FILE</code></td>
<td>Target options: Specify either a single target hostname or IP address (<code>-h</code>) or a file containing a list of targets (<code>-H</code>).</td>
<td><code>medusa -h 192.168.1.10 ...</code> or <code>medusa -H targets.txt ...</code></td>
</tr>
<tr>
<td><code>-u USERNAME</code> or <code>-U FILE</code></td>
<td>Username options: Provide either a single username (<code>-u</code>) or a file containing a list of usernames (<code>-U</code>).</td>
<td><code>medusa -u admin ...</code> or <code>medusa -U usernames.txt ...</code></td>
</tr>
<tr>
<td><code>-p PASSWORD</code> or <code>-P FILE</code></td>
<td>Password options: Specify either a single password (<code>-p</code>) or a file containing a list of passwords (<code>-P</code>).</td>
<td><code>medusa -p password123 ...</code> or <code>medusa -P passwords.txt ...</code></td>
</tr>
<tr>
<td><code>-M MODULE</code></td>
<td>Module: Define the specific module to use for the attack (e.g., <code>ssh</code>, <code>ftp</code>, <code>http</code>).</td>
<td><code>medusa -M ssh ...</code></td>
</tr>
<tr>
<td><code>-m "MODULE_OPTION"</code></td>
<td>Module options: Provide additional parameters required by the chosen module, enclosed in quotes.</td>
<td><code>medusa -M http -m "POST /login.php HTTP/1.1\r\nContent-Length: 30\r\nContent-Type: application/x-www-form-urlencoded\r\n\r\nusername=^USER^&amp;password=^PASS^" ...</code></td>
</tr>
<tr>
<td><code>-t TASKS</code></td>
<td>Tasks: Define the number of parallel login attempts to run, potentially speeding up the attack.</td>
<td><code>medusa -t 4 ...</code></td>
</tr>
<tr>
<td><code>-f</code> or <code>-F</code></td>
<td>Fast mode: Stop the attack after the first successful login is found, either on the current host (<code>-f</code>) or any host (<code>-F</code>).</td>
<td><code>medusa -f ...</code> or <code>medusa -F ...</code></td>
</tr>
<tr>
<td><code>-n PORT</code></td>
<td>Port: Specify a non-default port for the target service.</td>
<td><code>medusa -n 2222 ...</code></td>
</tr>
<tr>
<td><code>-v LEVEL</code></td>
<td>Verbose output: Display detailed information about the attack's progress. The higher the <code>LEVEL</code> (up to 6), the more verbose the output.</td>
<td><code>medusa -v 4 ...</code></td>
</tr>
</tbody>
</table>
<h3>Medusa Modules</h3>
<p>Each module in Medusa is tailored to interact with specific authentication mechanisms, allowing it to send the appropriate requests and interpret responses for successful attacks. Below is a table of commonly used modules:</p>
<table>
<thead>
<tr>
<th>Medusa Module</th>
<th>Service/Protocol</th>
<th>Description</th>
<th>Usage Example</th>
</tr>
</thead>
<tbody>
<tr>
<td>FTP</td>
<td>File Transfer Protocol</td>
<td>Brute-forcing FTP login credentials, used for file transfers over a network.</td>
<td><code>medusa -M ftp -h 192.168.1.100 -u admin -P passwords.txt</code></td>
</tr>
<tr>
<td>HTTP</td>
<td>Hypertext Transfer Protocol</td>
<td>Brute-forcing login forms on web applications over HTTP (GET/POST).</td>
<td><code>medusa -M http -h www.example.com -U users.txt -P passwords.txt -m DIR:/login.php -m FORM:username=^USER^&amp;password=^PASS^</code></td>
</tr>
<tr>
<td>IMAP</td>
<td>Internet Message Access Protocol</td>
<td>Brute-forcing IMAP logins, often used to access email servers.</td>
<td><code>medusa -M imap -h mail.example.com -U users.txt -P passwords.txt</code></td>
</tr>
<tr>
<td>MySQL</td>
<td>MySQL Database</td>
<td>Brute-forcing MySQL database credentials, commonly used for web applications and databases.</td>
<td><code>medusa -M mysql -h 192.168.1.100 -u root -P passwords.txt</code></td>
</tr>
<tr>
<td>POP3</td>
<td>Post Office Protocol 3</td>
<td>Brute-forcing POP3 logins, typically used to retrieve emails from a mail server.</td>
<td><code>medusa -M pop3 -h mail.example.com -U users.txt -P passwords.txt</code></td>
</tr>
<tr>
<td>RDP</td>
<td>Remote Desktop Protocol</td>
<td>Brute-forcing RDP logins, commonly used for remote desktop access to Windows systems.</td>
<td><code>medusa -M rdp -h 192.168.1.100 -u admin -P passwords.txt</code></td>
</tr>
<tr>
<td>SSHv2</td>
<td>Secure Shell (SSH)</td>
<td>Brute-forcing SSH logins, commonly used for secure remote access.</td>
<td><code>medusa -M ssh -h 192.168.1.100 -u root -P passwords.txt</code></td>
</tr>
<tr>
<td>Subversion (SVN)</td>
<td>Version Control System</td>
<td>Brute-forcing Subversion (SVN) repositories for version control.</td>
<td><code>medusa -M svn -h 192.168.1.100 -u admin -P passwords.txt</code></td>
</tr>
<tr>
<td>Telnet</td>
<td>Telnet Protocol</td>
<td>Brute-forcing Telnet services for remote command execution on older systems.</td>
<td><code>medusa -M telnet -h 192.168.1.100 -u admin -P passwords.txt</code></td>
</tr>
<tr>
<td>VNC</td>
<td>Virtual Network Computing</td>
<td>Brute-forcing VNC login credentials for remote desktop access.</td>
<td><code>medusa -M vnc -h 192.168.1.100 -P passwords.txt</code></td>
</tr>
<tr>
<td>Web Form</td>
<td>Brute-forcing Web Login Forms</td>
<td>Brute-forcing login forms on websites using HTTP POST requests.</td>
<td><code>medusa -M web-form -h www.example.com -U users.txt -P passwords.txt -m FORM:"username=^USER^&amp;password=^PASS^:F=Invalid"</code></td>
</tr>
</tbody>
</table>
<h3>Targeting an SSH Server</h3>
<p>Imagine a scenario where you need to test the security of an SSH server at <code>192.168.0.100</code>. You have a list of potential usernames in <code>usernames.txt</code> and common passwords in <code>passwords.txt</code>. To launch a brute-force attack against the SSH service on this server, use the following Medusa command:</p>
<pre><code class="language-shell-session">[!bash!]$ medusa -h 192.168.0.100 -U usernames.txt -P passwords.txt -M ssh 
</code></pre>
<p>This command instructs Medusa to:</p>
<ul>
<li>Target the host at <code>192.168.0.100</code>.</li>
<li>Use the usernames from the <code>usernames.txt</code> file.</li>
<li>Test the passwords listed in the <code>passwords.txt</code> file.</li>
<li>Employ the <code>ssh</code> module for the attack.</li>
</ul>
<p>Medusa will systematically try each username-password combination against the SSH service to attempt to gain unauthorized access.</p>
<h3>Targeting Multiple Web Servers with Basic HTTP Authentication</h3>
<p>Suppose you have a list of web servers that use basic HTTP authentication. These servers' addresses are stored in <code>web_servers.txt</code>, and you also have lists of common usernames and passwords in <code>usernames.txt</code> and <code>passwords.txt</code>, respectively. To test these servers concurrently, execute:</p>
<pre><code class="language-shell-session">[!bash!]$ medusa -H web_servers.txt -U usernames.txt -P passwords.txt -M http -m GET 
</code></pre>
<p>In this case, Medusa will:</p>
<ul>
<li>Iterate through the list of web servers in <code>web_servers.txt</code>.</li>
<li>Use the usernames and passwords provided.</li>
<li>Employ the <code>http</code> module with the <code>GET</code> method to attempt logins.</li>
</ul>
<p>By running multiple threads, Medusa efficiently checks each server for weak credentials.</p>
<h3>Testing for Empty or Default Passwords</h3>
<p>If you want to assess whether any accounts on a specific host (<code>10.0.0.5</code>) have empty or default passwords (where the password matches the username), you can use:</p>
<pre><code class="language-shell-session">[!bash!]$ medusa -h 10.0.0.5 -U usernames.txt -e ns -M service_name
</code></pre>
<p>This command instructs Medusa to:</p>
<ul>
<li>Target the host at <code>10.0.0.5</code>.</li>
<li>Use the usernames from <code>usernames.txt</code>.</li>
<li>Perform additional checks for empty passwords (<code>-e n</code>) and passwords matching the username (<code>-e s</code>).</li>
<li>Use the appropriate service module (replace <code>service_name</code> with the correct module name).</li>
</ul>
<p>Medusa will try each username with an empty password and then with the password matching the username, potentially revealing accounts with weak or default configurations.</p>
